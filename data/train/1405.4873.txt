{
  "article_text": [
    "many astrophysical systems are characterized by highly anisotropic , turbulent or even chaotic motions of their constituents .",
    "the case of energy transport in stellar interiors via convection is a classic example . depending on",
    "a star s mass and age convective instability can be triggered by nuclear burning and may arise in several parts of the stellar interior ( core or shell convection ) .",
    "due to computational limitations the effects of convection on stellar evolution have predominantly been studied via the use of one - dimensional spherically symmetric stellar evolution codes such as kepler @xcite , tycho @xcite the geneva code and more recently the modules for experiments in stellar astrophysics ( mesa ) @xcite .",
    "all of these codes use the standard mixing - length theory ( mlt ) to treat convection based on either the schwarzschild or the ledoux criteria plus parametrized treatments for the effects of semi - convection , convective overshoot and thermohaline mixing ( see , e.g. , @xcite ) .",
    "a topic of current debate is how accurate those parametrized mlt prescriptions are as compared to intrinsically three - dimensional simulations of convection .",
    "significant efforts have been made to simulate stellar convection in multiple dimensions over a timescale short compared to the evolutionary timescale , and to compare the output of such simulations to the parametrized predictions .",
    "@xcite presented multi - dimensional simulations of oxygen shell burning and hydrogen core burning for a 23-@xmath0 core - collapse supernova ( ccsn ) progenitor star .",
    "they found significant differences between the 2d and the 3d treatment and underscored the fact that the convective mixing regions are better predicted using dynamic boundary conditions ( bcs ) rather than local and static mlt criteria .",
    "this dynamical behavior of convective boundaries is found to be a source of gravity waves that can , under certain circumstances , lead to episodic mass - loss in the years preceding the supernova ( sn ) explosion @xcite .",
    "such pre - sn mass loss events can give rise to supernova impostors , as is the case with the pre - explosion outbursts of sn  2009ip @xcite .",
    "similar studies have been done in the case of main - sequence ( ms ) core convection @xcite and vigorous pre - sn convection ( with emphasis on energetic si - shell burning ) in the hours prior to core collapse @xcite , also couch et al .",
    "( 2014 , in preparation ) .",
    "these multi - dimensional studies exhibit pronounced shell asymmetries and dynamical interactions between adjacent convective regions .",
    "such effects can significantly change the structure not only of the pre - sn star but of its circumstellar ( cs ) environment @xcite , and , as a result , can affect the initial conditions for the core - collapse process and subsequent explosion .",
    "indeed , it has recently been shown that the outcome of ccsn simulations can be _ qualitatively _ different for realistic aspherical initial conditions .",
    "@xcite show that imprinting physically - motivated velocity fluctuations in the convective regions of the progenitor star prior to collapse can result in shock revival in 3d ccsn simulations that fail to explode otherwise .",
    "the importance of initializing such velocity perturbations in order to characterize the multi - dimensional nature of pre - sn convection has been pointed out in the past and several formalisms have been proposed , including scalar spherical harmonics and fourier decomposition @xcite that are commensurate with the kolmogorov energy spectrum expected for highly turbulent stellar regions .",
    "fourier modes , however , are poor matches to the spherical boundary conditions relevant to this problem . in addition , other approaches such as the spherical fourier - bessel decomposition have attempted to analyze scalar fields in ccsn convection @xcite in spherical , concentric shells . in this paper",
    "we introduce a mathematical framework for analyzing stochastic stellar velocity fields , the method of decomposition into vector spherical harmonics ( vsh ) , and apply the method to the case of ccsn progenitor convection .",
    "vsh decomposition of multi - dimensional simulation data can be used to extract power spectra that describe the distribution of convective power over the length scales of the system .",
    "vsh power spectra can also be used to produce realizations of velocity fields that capture the non - radial perturbations of the flow due to convection , and therefore provide more realistic initial conditions for multi - dimensional ccsn simulations .",
    "the toolset of vsh has been used in other fields of astrophysics where random velocity distributions are present such as the local stellar velocity field @xcite and stellar pulsations and oscillations .",
    "our paper is organized as follows : in section [ vsh ] we present the basic mathematical formulation of vsh , in section [ sims ] we discuss the numerical evaluation of vsh and relevant consistency tests that illustrate the accuracy of our results and apply the method to the case of a 2d oxygen shell burning simulation . in section [ sims_3d ]",
    "we apply vsh decomposition to a 3d oxygen shell burning simulation and discuss the differences between the corresponding power spectra .",
    "finally , in section [ disc_2 ] we summarize our conclusions and discuss the importance of this technique to setting realistic initial conditions for the ccsn simulations .",
    "much of the vsh formulation described below is based on material in @xcite , @xcite , @xcite and @xcite .",
    "details on the derivation of the vsh modes , their orthonormality relations , proper treatment of boundary conditions as well as dependence on data dimensionality and simulation domain can be found in appendix [ sec : appendix ] .",
    "we seek to characterize velocity fields that we may choose to impose as an initial condition for a stellar simulation in a spherical shell @xmath1 , consisting of the region @xmath2 where @xmath3 is the position vector .",
    "such a field ought to satisfy certain physically - motivated mathematical requirements .",
    "one such requirement is that the framework for specifying the velocity field should allow good control of the divergence of the momentum density field .",
    "consider the continuity equation : @xmath4 where @xmath5 is the momentum density .",
    "if one is to specify a velocity field on top of some nearly - hydrostatic mass configuration @xmath6 , it would be well to control the size of @xmath7 so that the velocity field does not inadvertently create large departures from the near - equilibrium initial state . according to equation  ( [ eq : masscons ] ) , this can be accomplished by ensuring that the divergence of the momentum density , @xmath8 has a controllable magnitude , which we may set to zero ( the `` anelastic '' case ) or to a `` small '' value as suits the case .",
    "a second requirement is that the velocity field imposed on the problem should add no net momentum to the mass configuration .",
    "that is : @xmath9 if this requirement were not satisfied the result would be an initial condition that imparts unwanted kicks to the mass configuration .",
    "these first two requirements are expressed in terms of @xmath10 , rather than directly in terms of the velocity @xmath11 .",
    "this suggests that we model @xmath10 using the set of modes described below , and obtain @xmath11 indirectly by @xmath12 .",
    "this , then , is what we shall do .",
    "a third necessary requirement relates to boundary conditions .",
    "we demand that the radial velocity should go continuously to zero at specified radii .",
    "in particular , when decomposing a momentum field @xmath13 in a spherical shell @xmath2 , we will require that @xmath13 should be purely tangential at @xmath14 and at @xmath15 .",
    "the boundary conditions we require are thus @xmath16 such a velocity field with support confined to a spherical shell is of interest , for example , in the case of a ccsn progenitor , with a nearly quiescent iron core surrounded by a convectively burning silicon / oxygen shell .",
    "a final requirement is that the set of modes used to express the velocity field should be orthonormal and complete .",
    "this requirement allows us to analyze an existing velocity field in terms of a unique spectrum in a meaningful way , and to use a spectrum of modes to generate velocity field realizations unambiguously .",
    "the challenge is therefore to decompose a velocity field that satisfies the above requirements into three vector fields ( one irrotational and two solenoidal component fields ) .",
    "to do so we first recall that the solutions of a self - adjoint partial differential equation ( pde ) form a complete , orthonormal set of functions",
    ". one of the simplest and well - studied such pdes is the scalar helmholtz equation , @xmath17 , wherein the solution @xmath18 may be regarded as an eigenvector of the laplacian operator @xmath19 with eigenvalue @xmath20 .",
    "it is a standard result of sturm - liouville theory that eigenfunctions of self - adjoint operators such as the laplacian satisfying specified boundary conditions may be pressed into service as complete sets of basis functions for the expansion of quite general functions and distributions satisfying the same boundary conditions .",
    "the same principle is applied to the expansion of _ vector _ fields .",
    "that is to say , we seek our basis of vector functions among the solutions of the _ vector helmholtz equation _ @xmath21",
    "these solutions can be constructed using families of solutions of the scalar helmholtz equation with the required boundary conditions , which will confer their orthonormality / completeness properties upon the vector solutions .",
    "we note in passing that we do not ascribe any dynamical significance to equation ( [ eq : vec_helm_eq ] ) .",
    "rather , we are relying on the vector helmholtz equation merely to generate modes with useful boundary conditions for the purpose of analyzing and realizing velocity fields at fixed times .",
    "this is analogous to using plane wave fourier modes  complete , orthonormal solutions of the helmholtz equation in cartesian coordinates  to characterize the instantaneous state of a fluid in a cartesian box .",
    "a general vector field has three degrees of freedom at every point .",
    "these could be characterized by three functions , one for each coordinate component of the field .",
    "while such a decomposition is certainly simple , it does not allow us to address the requirements stated above .",
    "instead , we consider the so - called helmholtz decomposition , which states that any vector field @xmath22 may be decomposed into a sum of an irrotational field @xmath23 and a solenoidal field @xmath24 , @xmath25 , where @xmath26 and @xmath27 for some scalar function @xmath28 and vector function @xmath29 , so that @xmath30 and @xmath31",
    ". in this decomposition , all the divergence of the field @xmath32 is associated with the irrotational component @xmath33 , while all the curl attaches to the solenoidal component @xmath34 . by providing a set of modes for @xmath33 separate from the modes supplied to represent",
    "@xmath34 , the divergence of the vector field @xmath32 can be separated out and ascribed any magnitude , including zero .",
    "starting from an arbitrary solution @xmath18 of the scalar helmholtz equation @xmath35 we construct vector functions @xmath36    the detailed choice of @xmath18 is deferred to appendix [ sec : appendix ] .",
    "obviously , we have @xmath37 and @xmath38 , so @xmath39 is irrotational and @xmath40 and @xmath41 are solenoidal .",
    "it is straightforward to verify that these fields are solutions of the vector helmholtz equation .    in appendix",
    "[ sec : appendix ] we show that the modes satisfying the requirements stated above are given by the following set of equations : @xmath42\\label{eq : a_mode_again}\\\\ \\nonumber\\\\ \\mathbf{b}_{lnm}(\\mathbf{x } ) & = & -\\left[l(l+1)\\right]^{-1/2}\\ , g_{l}^{(n)}\\left(k_{ln}^{(n)}r\\right)\\,\\mathbf{x}\\nonumber\\\\ & \\times&\\nabla y_{lm}(\\mathbf{n})\\label{eq : b_mode_again}\\\\ \\nonumber\\\\ \\mathbf{c}_{lnm,}(\\mathbf{x } ) & = & k_{ln}^{(d)\\,-1}\\left[l(l+1)\\right]^{-1/2}\\nonumber\\\\ & & \\biggl\\{\\frac{l(l+1)}{r^{2}}\\ , y_{lm}(\\mathbf{n})\\ , g_{l}^{(d)}\\left(k_{ln}^{(d)}r\\right)\\,\\mathbf{x}\\nonumber \\\\ & + & \\frac{d}{dr}\\left[rg_{l}^{(d)}\\left(k_{ln}^{(d)}r\\right)\\right]\\nabla y_{lm}(\\mathbf{n})\\biggr\\},\\label{eq : c_mode_again}\\end{aligned}\\ ] ] where @xmath43 and @xmath44 are the eigenvalues and eigenfunctions of the radially - separated helmholz equation , equation  ( [ eq : radial_helmholtz ] ) .",
    "the eigenfunctions @xmath44 are therefore the spherical bessel functions . here",
    ", @xmath45 stands for the dirichlet boundary conditions and @xmath46 for the neumann boundary conditions , @xmath47 , @xmath48 , and the @xmath49 are the usual spherical harmonic functions .    note",
    "that since @xmath50 and @xmath51 are purely tangential vectors , the radial and tangential directions are explicitly separated in equations  ( [ eq : a_mode_again])([eq : c_mode_again ] ) .",
    "the set of modes , @xmath52 , is purely irrotational while the other two ( @xmath53 and @xmath54 ) are purely solenoidal .",
    "a general momentum density vector field , @xmath13 , within a spherical shell ( @xmath55 ) can be uniquely decomposed into the vsh modes @xmath52 , @xmath53 and @xmath54 as follows : @xmath56,\\label{eq : expansion}\\end{aligned}\\ ] ] where @xmath57    while a field @xmath13 can be generally decomposed in this way , not all the information thus generated is physically interesting .",
    "the complex phase is not descriptive of scale structure .",
    "furthermore , in the absence of a preferred direction , the values of components labeled by @xmath58 indices are a happenstance of choice of orientation ",
    "they shuffle among themselves while leaving @xmath59 and @xmath60 invariant under rotations .",
    "therefore , in circumstances where we expect the power distribution among modes to be spherically - symmetric , and where we are only concerned with scale structure , we may focus on describing the scale structure of @xmath13 by computing the three rotationally - invariant spectra @xmath61 if @xmath13 is from a simulation , these spectral integrals may be obtained by straightforward quadrature summations over the domain mesh .",
    "evidently , in these spectral distributions , the @xmath59 index is informative with respect to angular scales , whereas the @xmath60 index is informative with respect to radial scales .    since the @xmath52 are purely irrotational , and therefore affect @xmath62 , whereas the @xmath53 and @xmath54 modes are purely solenoidal , and have no effect on @xmath62 , when analyzing existing momentum fields from nearly - stable stratified flows , one should expect to find that the magnitude of the @xmath63 spectrum is smaller than the magnitudes of the @xmath64 and @xmath65 spectra .",
    "we confirm this expectation using simulations in the next section .",
    "here we discuss the numerical methods that we use to calculate vsh power spectra from the output of multi - dimensional simulations of convective velocity fields .",
    "implementation of the numerics can be run either as a stand - alone code , given momentum density data in spherical coordinates for a convective shell exported by a simulation , or applied within a hydrodynamics code , like _ flash _ , at runtime .",
    "the first thing to consider prior to the calculation of vsh is determination of the radii @xmath66 and @xmath67 that bound the spherical shell @xmath1 , at each time at which the decomposition is to be performed .",
    "these radial boundaries must be set so that the boundary conditions of equation  ( [ eq : mombc ] ) are satisfied as well as possible .",
    "this can be formally done by plotting the spherical average of the radial component of the momentum density , @xmath68 , in the region where convective instability due to shell burning is active .",
    "the boundaries can then be chosen to be the locations where @xmath69 is as close to zero as possible .",
    "note that in reality @xmath69 is not going to be exactly equal to zero because the convective boundaries themselves may be dynamical @xcite .",
    "this inspection will provide the first inputs needed for the calculation of vsh : the inner and the outer convective shell boundaries @xmath70 and @xmath71 .",
    "the next input needed is the shortest physical length @xmath72 to be resolved by the vsh decomposition .",
    "of course , @xmath72 needs to be larger than the finest resolution length of the discrete simulation mesh within the convective shell . by counting nodes of the mode functions",
    ", it is not difficult to show that for a given @xmath72 the maximum number of @xmath60-modes for all three vsh sets is given by the integer part of : @xmath73 and the maximum number of @xmath59-modes by the integer part of : @xmath74 in a specialized case , where @xmath75 is extremely small ( not the case here ) , one could consider a different choice to conform to the extreme bc .",
    "the total number of modes is : @xmath76 where @xmath77 the dimensionality of the simulation .",
    "the dependence on @xmath77 reflects the fact that in 2d with azimuthal symmetry , only the @xmath78 mode is non - zero , whereas in 3d there are @xmath79 modes indexed by @xmath58 for each @xmath59 .    given these inputs all operations necessary to calculate the vsh power spectra can be performed , as described in the previous section .",
    "these operations involve the numerical evaluation of    * the eigenvalues @xmath43 for each combination @xmath80 and each choice of boundary condition @xmath81 ( solutions of equations  [ eq : root_eqn ] and [ eq : nbc_eqn2 ] ) ; * the value of the function @xmath49 , and its gradient , for each combination @xmath82 in every mesh zone in the shell ; * the values of the spherical bessel functions of first and second kind and their derivatives for each combination @xmath80 in every mesh zone in the shell .",
    "the three vsh sets of mode functions for all modes up to @xmath83 and @xmath84 are built up , and spectra of the given momentum field are obtained by summation over the domain mesh .",
    "we have incorporated the operations necessary for the calculation of vsh into _ flash _ and have done performance tests yielding information on the computational expense of calculating vsh power spectra . the typical performance for calculations run on the argonne leadership computational facility ( alcf ) _ mira _ supercomputer ( with 1.6  ghz cores ) is @xmath85  core - hours per mesh zone per vsh mode . for the vsh decomposition of the 3d oxygen - burning shell simulation discussed in ",
    "[ sims_3d ] , the number of mesh zones in the shell is @xmath86  73,701,376 , and the total number of modes is @xmath87  108 . using 512 nodes ( with 16 cores per node ) , the wall - clock time of the computation was 9.64  min , for a total of 1316.1  core hours used .",
    "in this section we apply vsh decomposition to a 2d azimuthally - symmetric simulation of a convective oxygen - burning shell in an evolved solar - metallicity 15-@xmath0 star .",
    "the 15-@xmath0 model was evolved from the zero age main sequence ( zams ) up to the point where a predominantly si / s core is embedded in an o - burning shell , using the stellar evolution code _ mesa _ version 5596 @xcite . at this point",
    "the age of the star was @xmath88  years , and 60% of the oxygen fuel available for fusion was exhausted .",
    "this phase is similar to that chosen by @xcite , who use a different stellar mass , however .",
    "_ mesa _ was run with the mass - loss prescriptions of and , the helm eos @xcite , the schwarzschild criterion for convection and the approx19 nuclear reaction network @xcite .",
    "the final model has 1371 grid points , which yields good resolution of the convective flow in the o - burning shell .",
    "figure [ fig:2d_model_properties ] shows the distribution of the specific nuclear energy generation rate , the convective overturn time - scale , the square of the brunt - vaisala frequency , @xmath89 , and the composition of the final _ mesa _ model . for",
    "an estimate of the convective overturn time - scale we take @xmath90 .",
    "this final model was then mapped to the 2d cylindrical adaptive mesh refinement ( amr ) grid of _ flash _ , version 4.0 .",
    "the simulation was carried out in a cylindrical domain with maximum radial extent equal to @xmath91 cm and maximum / minimum vertical extents @xmath92 cm , which easily contains the entire convective o - burning shell .",
    "the total simulated time was @xmath93800  s with 8 levels of refinement yielding a maximum resolution of @xmath938  km .",
    "the levels of refinement were concentrically nested to yield an effective angular resolution of @xmath94 . within the simulated timescale ,",
    "convection over most of the oxygen - burning shell had undergone @xmath93  1 - 2 convective turnover timescales ( see lower right panel of figure [ fig:2d_model_properties ] ) .",
    "the _ flash _",
    "simulation was run on the texas advanced computing center ( tacc ) _ stampede _ supercomputer .",
    "figure [ fig:2d_model_viz ] shows a snapshot of the @xmath95o mass fraction and the velocity magnitude in the oxygen shell after 430  s of simulation . by inspection of the net kinetic energy evolution of the simulation , we find that the initial mild hydrodynamic transients caused by mapping 1d _ mesa _ profiles to the 2d _ flash _ amr grid have ceased well before this time .",
    "the initial transient manifests as a purely radial pulsation as the spherically - symmetric models settles onto the new grid .",
    "to better illustrate these points , we show the evolution of the total kinetic energy in figure [ fig : tke_evol ] for the 2d and the 3d shell o - burning simulation we study in this work .",
    "the initial transient causes a peak in the kinetic energy just before 100  s in both 2d and 3d . by the end of the simulations ,",
    "the radial pulses have left the domain and the kinetic energy is dominated by convective motions in the burning shells that have approximately saturated in strength .    as a preliminary step to performing a vsh decomposition of the data , we determine the radial boundaries of the 2d o - burning shell that best satisfy the boundary conditions discussed in  [ vsh ] .",
    "to do so , we assign zones to radial bins , and average the @xmath96 ( where @xmath97 ) in each bin , weighted by the volume of each zone : @xmath98 where the index @xmath99 refers to a specific radial bin , and the index @xmath100 to a zone within that bin .",
    "inspection of the binned momentum density data within the convective oxygen burning shell at @xmath101  430  s leads us to choose shell boundaries at @xmath102  cm and @xmath103  cm ( figure [ fig:2d_mr ] ) .",
    "we then calculate the vsh modes using @xmath104  cm ( 1/12 of the shell width ) . using equations ( [ eq : nmax])-([eq : ntotal ] )",
    ", this corresponds to @xmath105  32 , @xmath106  24 and @xmath107  825 .",
    "figure [ fig:2d_spectra ] shows the temporal evolution of the reduced power spectra in @xmath59 ( left panel ) and @xmath60 ( right panel ) .",
    "the reduced power spectra are essentially summations of the full spectra over either @xmath59 or @xmath60 : @xmath108 , @xmath109 , and similarly for the solenoidal modes . due to the lack of @xmath110  0 modes and the azimuthal symmetry of the 2d data all the @xmath111 modes have zero coefficients , that is @xmath112 .",
    "the total power ( summed over all @xmath59 and @xmath60 ) of the irrotational mode is @xmath113  g@xmath114  @xmath115  s@xmath116 and that of the solenoidal mode @xmath117  g@xmath114  @xmath115  s@xmath116 .",
    "we therefore have @xmath118 as expected from the discussion in section [ vsh ] . a time - averaged spectrum over the four phases considered ( 100 - 430  s ) is also shown in figure [ fig:2d_spectra ] to illustrate variance of power over time in each wavenumber .",
    "while there is considerable variance about the mean value for each individual wavenumber , illustrating the chaotic nature of convection , the global characteristics of the spectra ( e.g. , the slopes ) remain consistent .",
    "the reduced vsh power spectrum of the convection simulation at @xmath119  s , shown in figure [ fig:2d_430sspec ] , yields scale information about flows in the convective oxygen shell .",
    "the @xmath65-spectrum begins its exponential decline at @xmath120  8 and at @xmath121  1 .",
    "this means that the bulk of the momentum density power is in characteristic angular scales of @xmath122  cm and radial scales of @xmath123  cm , indicating that the size of the convective elements is roughly similar in the radial and angular directions .",
    "we also note that the power of the solenoidal modes in @xmath59 maintains a constant slope in time that can be approximated by a declining exponential of the form @xmath124 .",
    "same is the case for the power of the solenidal modes in @xmath60 with corresponding declining exponential law @xmath125 .",
    "we emphasize that these power - law fits are only indicative and we only use them to illustrate the general characteristics of the power spectra and not for realizations of velocity fields .",
    "for this purpose we recover the phase information by random drawings as discussed in section  [ realization ] .      for the vsh calculation presented in ",
    "[ 2dspectra ] we test the orthonormality of the vsh modes in order to assess the consistency of our method , and to verify the correctness of the vsh code . for this",
    "we evaluate the output of equations  ( [ eq : a_mode_orthogonality ] ) , ( [ eq : b_mode_orthogonality ] ) , ( [ eq : c_mode_orthogonality ] ) and ( [ eq : mutual_orthogonality ] ) of appendix [ sec : appendix ] and verify that the results are either 0 ( orthogonal ) or 1 ( normalized ) .",
    "our results are illustrated in figure [ fig : orthonormal ] .",
    "it can be seen that all three sets of modes have normalization factors very close to unity . also ,",
    "the three sets of vsh modes are orthogonal to each other .    to verify that different modes of the same set are mutually orthogonal we use the @xmath121  1 , @xmath120  0 mode and test its orthogonality against all other modes .",
    "as can be seen in figure [ fig : mutual_ortho ] , orthogonality is recovered in this case as well .",
    "another test of the vsh method is whether the original momentum density data can be recovered accurately by using the decomposition of equations ( [ eq : expansion])-([eq : c_coefficients ] ) . using the vsh decomposition of the convective oxygen - burning shell that we presented in section [ 2dspectra ] , we reconstruct the momentum density data using equation  ( [ eq : expansion ] ) .",
    "figure [ fig : realization ] shows a comparison of the recovered ( middle panel ) versus the original ( left panel ) momentum density field .",
    "for the two datasets we calculate the l2-norm to assess the error of the reconstructed field using the formula : @xmath126^{2 } } { \\int_{\\sigma } d^{3}\\mathbf{x}\\left|\\mathbf{m}(\\mathbf{x})\\right|^{2}}}.\\ ] ] we find @xmath127  0.0029 indicating a successful reconstruction of the data within errors ( since @xmath128  1 ) .",
    "part of the residual deviation of the reconstructed momentum density field from the original one is due to the truncation of the sum over modes at @xmath129 , @xmath130 .",
    "some of the residual is also attributable to the fact that at @xmath70 and @xmath71 the boundary conditions are not perfectly satisfied ( see section [ sims ] ) .",
    "an important application for the vsh framework presented here is the generation of non - spherically - symmetric initial conditions for ccsn simulations that include physically - motivated non - radial velocity fields .",
    "inclusion of non - radial velocity perturbations to otherwise spherically - symmetric initial conditions has been shown to have an important qualitative impact on ccsn simulations @xcite .",
    "this work , however , used very simplistic convolutions of sinusoids to perturb only the @xmath131-direction velocity of the initial model .",
    "the scale and amplitude of these perturbations were chosen to resemble realistic multi - dimensional simulations of convective burning in ccsn progenitors near collapse , but this approach is ultimately insufficient to quantitatively capture the structure of convective velocity fields .",
    "our method of vsh decomposition provides a far superior means of including non - radial velocity fields in the initial conditions for ccsn simulations . as discussed above ,",
    "the vsh framework is purely kinematic in the sense that it includes no information about the physics that is producing the velocity field being considered , but it does respect appropriate boundary conditions for convective shells in stars . in this sections , we describe the process of realizing a pseudo - random velocity field from vsh spectra .    under the assumption that the spectral distributions @xmath63 , @xmath64 , @xmath65 are known we can create corresponding realizations of @xmath13 . for this , we need to restore the phase and the @xmath58-dependence by random number generation so as to turn the power spectra back into full vsh transforms .    in order to do this , we observe that since the data is real , the expansion coefficients in equations  ( [ eq : a_coefficients])([eq : c_coefficients ] ) have the property @xmath132 , @xmath133 , @xmath134  this is traceable to the relation @xmath135 which is inherited by the mode functions @xmath136 , @xmath111 , @xmath137 .",
    "it follows that for each mode , the process of extracting the spectral coefficients @xmath63 , @xmath64 , @xmath65 according to equations  ( [ eq : alpha])([eq : gamma ] ) has elided the sign of the @xmath78 term ( which is purely real ) and the phases of the @xmath138 terms .",
    "the remaining @xmath139 terms are related to the @xmath138 terms by complex conjugation .",
    "we may therefore focus on realizing the truly independent @xmath140 real terms @xmath141 for each mode , and obtain the @xmath139 terms by complex conjugation .",
    "we may accordingly rewrite equations  ( [ eq : alpha])([eq : gamma ] ) as follows : @xmath142\\label{eq : alpha_real}\\\\ \\beta_{ln}&=&b_{ln0}^2 + 2\\sum_{m=1}^l\\left[\\textit{re}\\left\\{b_{lnm}\\right\\}^2 + \\textit{im}\\left\\{b_{lnm}\\right\\}^2 \\right]\\label{eq : beta_real}\\\\ \\gamma_{ln}&=&c_{ln0}^2 + 2\\sum_{m=1}^l\\left[\\textit{re}\\left\\{c_{lnm}\\right\\}^2 + \\textit{im}\\left\\{c_{lnm}\\right\\}^2 \\right]\\label{eq : gamma_real } \\ ] ]    setting the components of a @xmath140-dimensional vector @xmath143 by @xmath144_p=\\left\\ { \\begin{array}{c@{\\quad:\\quad}l } \\sqrt{\\frac{1}{\\alpha_{ln}}}a_{ln0}&p=0\\\\ \\sqrt{\\frac{2}{\\alpha_{ln}}}\\textit{re}\\left\\{a_{lnp}\\right\\}&p=1,\\ldots , l\\\\ \\sqrt{\\frac{2}{\\alpha_{ln}}}\\textit{im}\\left\\{a_{ln\\,p - l}\\right\\}&p = l+1,\\ldots,2l , \\end{array } \\right .",
    "\\label{eq : x_vector}\\ ] ] it is clear that equation  ( [ eq : alpha_real ] ) is satisfied when @xmath145 , that is , when @xmath143 is restricted to a unit hypersphere in @xmath140 dimensions .",
    "we may therefore realize a velocity distribution that respects the spectral distributions @xmath63 by constructing , for each @xmath80 , a random vector @xmath143 on this sphere .",
    "sampling such a random vector is a straightforward matter .",
    "we sample @xmath140 standard normal variables @xmath146 , @xmath147 .",
    "we then compute the normalization @xmath148 . since the density function of the @xmath140-dimensional multivariate normal distribution depends only on @xmath46 , the normalized random variables @xmath149_p=\\hat{y}_p",
    "/ n$ ] are distributed uniformly on the unit hypersphere in @xmath140-dimensions , as required .",
    "the realized values of @xmath150 may be easily recovered from equation  ( [ eq : x_vector ] ) .",
    "this procedure may obviously be repeated to obtain realizations of the spectra @xmath64 and @xmath65 .",
    "of course , statistically - independent random number drawings should be performed for each of the three sets of modes . once all ( @xmath150 , @xmath151 , @xmath152 ) full power spectrum coeffiecents have been recovered ,",
    "equation  [ eq : expansion ] can be used to obtain the final realized momentum density field .",
    "we note that for 2d momentum density data the realization process is different since only the @xmath78 mode is present , which is only uncertain up to a sign . in this case",
    "the random variables are drawn from a uniform distribution instead of a normal one , and are assigned a positive or a negative unity value according to whether they fall in the ( 0 - 0.5 ] or the ( 0.5 - 1 ] range respectively .",
    "we use the vsh power spectra calculated in section [ 2dspectra ] to produce a momentum density field realization by the process described above .",
    "the realized momentum density field for the o shell can be seen in figure [ fig : realization ] ( right panel ) where it is compared with the original momentum density field ( left panel ) .",
    "we observe that qualitatively , scales of macroscopic structures occurring in the original simulation also recur in the realized field .",
    "it should be noted that the spectra only bear scale information , but do not carry any location information .",
    "this means that spatial structure such as stratification can be lost when @xmath13 is analyzed into modes and re - realized from the resulting spectrum .",
    "a stratified distribution @xmath13 with a quiescent core and a convective outer shell , spectrally - analyzed using whole - star modes and re - realized as above , will in general produce new momentum distributions with the same mix of scales as @xmath13 , but with no core - shell structure .",
    "if that structure must be preserved , it is necessary to divide the star into as many concentric layers as required , and analyze each layer separately .",
    "nevertheless , the initial vsh decomposition requirements on mass , momentum conservation and boundary conditions ( equations  [ eq : masscons]-[eq : mombc ] ) are already built in the method and the realization of phase information does not violate them . the conservation of mass flux , as we stated it in   [ vsh ] , is clearly visible in figure  [ fig:2d_spectra ] , where the divergence - bearing mode ( @xmath153 ) is clearly much smaller than the solenoidal modes .",
    "more generally , realization by `` restoring the phases '' is a seemingly simple operation that is , however , fraught with physical significance .",
    "the vsh decomposition itself is , of course , purely a kinematic device , and nothing about the spatial coherence scales of the flow , such as might be determined by convective turbulence structures associated with time - domain intermittency , is included into the method .",
    "depending on the distribution chosen to create randomly sampled phases , such flow structures can be realized or wiped out .",
    "here we discuss a realization strategy in which the phases are all independent , identically distributed ( iid ) on the unit circle .",
    "this strategy is fully incoherent , and definitely wipes out any coherent spatial structure .",
    "this issue is clearly illustrated by considering the distribution of @xmath154 for the realized simulation as compared to the original data ( red curve in figure [ fig:2d_mr ] ) .",
    "although the original and the realized radial components of the momentum density fields have a different spatial distribution , the average integrated value over the convective shell is very similar in the two .",
    "we return to a discussion of this issue in  [ disc_2 ] .",
    "there is , as yet , no multi - dimensional simulation of the late stages of massive stellar evolution that ends at the point of core collapse in the literature .",
    "there are simulations , however , of convective si shell burning in massive stars with iron cores ( e.g. , * ? ? ?",
    "* couch et al .",
    ", in prep . ) . as compared with detailed 1d ccsn progenitor models ( e.g. , * ? ? ?",
    "* ) , these simulations typically make approximations such as reduced nuclear burning networks and replacement of the inner iron core by a boundary condition which make attaining core collapse difficult .",
    "furthermore , these multi - dimensional simulations should not be regarded as fully deterministic as two similar simulations in identical progenitors that were subjected to different small scale perturbations in order to seed convection may result in well - developed convective structures that are not identical in phase . until multi - dimensional ccsn progenitor models at the point of collapse are available , a step toward increased realism in ccsn simulations",
    "may be achieved be leveraging the vsh method we present here in conjunction with state - of - the - art 1d models .",
    "the general procedure for constructing physically - motivated aspherical initial conditions for use in ccsn simulations would be as follows .",
    "first , a suitable simulation of convective burning prior to core collapse in the progenitor of interest is obtained .",
    "the structure of the velocity field in , e.g. , the si - burning shell surrounding the iron core is analyzed with the vsh framework and the spectra , equations ( [ eq : alpha]-[eq : gamma ] ) , are constructed . from the vsh spectra , we generate realizations of the velocity field using the procedure described above in this section which are applied to the si shell of the 1d collapse model .",
    "this yields a vector velocity field with scale and structure statistically equivalent to the original convective burning simulation , in terms of the vector spherical harmonic information , but with a randomized phase .",
    "a goal of future work is to study whether or not the results of ccsn simulations are sensitive to the phase information of the convective velocity field in the si shell at the time of collapse by conducting multi - dimensional ccsn mechanism simulations with several vsh - realized initial velocity fields that differ only in the random seed number of the phasing .",
    "a short - coming of this approach is the possibility for a small divergence of the evolution between the multi - dimensional convective burning simulation and that of the detailed 1d model . for our purposes , however , what matters most is accurately capturing the strength and scale of the convection in the moments prior to core collapse .",
    "we contend that the method sketched here should do just that and will result in initial conditions for ccsn that are more physically representative of real stars than anything that has been done before .",
    "to apply the vsh decomposition method on 3d data we ran a 3d flash simulation featuring a 15-@xmath155 star o - burning shell on the argonne leadership computing facility ( alcf ) _ intrepid _ supercomputer using the same progenitor as for the 2d study .",
    "we used 8@xmath156-zone blocks in a @xmath91  cm octant simulation box with reflective boundaries at the coordinate planes .",
    "the simulation used cartesian coordinates and adaptive mesh refinement ( amr ) , with a maximum resolution of @xmath93  16  km .",
    "it was evolved for 430 s. figure [ 3d_model_viz ] shows a snapshot of the velocity magnitude at this latest simulated phase .",
    "characteristic convective velocities of a few @xmath157-@xmath158  cm  s@xmath159 are obtained , which are similar to the ones seen in the 2d simulation .    in order to obtain the correct vsh power spectra we constructed the full 4@xmath160 steradian momentum density data using reflection symmetry about the three planes x - y , x - z and y - z .",
    "the radial coordinate @xmath161 and @xmath69 remain unaltered in all eight octants while the angular components of @xmath10 had either the same or an opposite sign depending on their specific octant .",
    "of course , to recover the @xmath162 coordinates in the other octants we added multiples of @xmath163 while @xmath131 was the same for all octants in the northern hemisphere and @xmath164 for the southern hemisphere .",
    "therefore the total number of zones in the o - burning shell for which we applied the vsh decomposition is eight times the number in the original octant simulation .    to compute power spectra with the large number of zones and modes in the 3d case",
    ", we implemented a parallelized computation of vsh in _",
    "flash_. prior to doing so , we re - weighted the amr morton space - filling curve @xcite to assign more weight to blocks residing in the o - burning shell , so that most processing power is focused on parts of the domain where it is needed . to reduce computational cost",
    "we also de - refined the amr data outside the o - burning shell prior to applying the vsh decomposition .",
    "these three processes of parallelization , de - refinement of unused data and re - weighting of the morton curve allowed us to efficiently compute 3d vsh spectra from within flash using the alcf _ mira _ supercomputer .",
    "first , we determine the radial limits of the o - burning shell .",
    "the binned profiles of @xmath96 for several epochs are shown in figure [ fig:3d_mr ] .",
    "the data shows that the radial component @xmath165 has a minimum at @xmath166  cm .",
    "we choose this value to be the inner boundary of the convective shell to be decomposed into vsh .",
    "for the outer boundary we investigate two values : a value that corresponds to the same @xmath167 as the inner boundary ( @xmath168  cm ) and a larger value for which @xmath167 has even more significantly declined ( @xmath169  cm ) in order to verify the robustness of the spectra under different choices of outer boundary .",
    "we then run _ flash _ with the vsh implementation discussed above on 512 nodes ( 8192 cores ) on _ mira _ for 11.2 hours for a total of 91750 core hours per run .",
    "for these calculations we used @xmath170  20 and @xmath171  16 for a total of @xmath107  7497 vsh modes calculated .",
    "figure [ fig:3d_spectra_altr2 ] shows the resulting reduced vsh power spectra in the case of the smaller ( solid curves ) and the larger ( dashed curves ) @xmath71 at 430  s. to properly compare the reduced vsh power spectrum in @xmath60 given the different shell sizes we express it in terms of the wavenumber @xmath99 in the right panel of figure [ fig:3d_spectra_altr2 ] using @xmath172 and @xmath173   dp / dn$ ] .",
    "we find that choosing a larger outer radius does not significantly change the resulting vsh power spectra .",
    "we also show the evolution of the power spectra between 200  s and 430  s in figure [ fig:3d_spectra_evolution ] as well as a time - averaged spectrum over these two phases ( thick curves ) . while the slopes of the spectra remain consistent over time , considerable variance is observed for individual wavenumbers in accord with the 2d results .",
    "we see that the solenoidal @xmath41 modes dominate over the irrotational modes while the solenoidal @xmath40 modes are comparable to the irrotational modes .",
    "it is therefore still the case that more power goes to the solenoidal modes , but the solenoidal / irrotational power ratio is smaller than was the case in the 2d simulations .",
    "more specifically at 430  s in the 3d case , the total power of the two solenoidal modes together is @xmath174  g@xmath114  @xmath115  s@xmath116 while that of the irrotational mode @xmath175  g@xmath114  @xmath115  s@xmath116 .",
    "we speculate that the increased importance of the irrotational flow with respect to the solenoidal flow is at least in part due to the physically unrealistic octant boundary conditions , which create radial - flow artifacts at the boundary planes .",
    "the lower resolution of the 3d simulation ( 16  km versus 8  km for the 2d simulation ) may also contribute to the difference in power ratios .",
    "since the choice of a larger @xmath71 does not alter the vsh power spectra significantly we adopt the smaller value @xmath176  cm to calculate the final 3d convective o - burning shell vsh power spectra at two epochs : 200  s and 430  s for @xmath170  15 and @xmath171  11 .",
    "the result is shown in figure  [ fig:3d_spectra_altr2 ] .",
    "we find that the slope of the solenoidal power spectrum in @xmath59 does not change significantly over this 230  s period in agreement with 2d results . however , the 430  s spectrum in this case peaks at @xmath177  5 for both solenoidal modes and at @xmath178  2 .",
    "these peaks corresponds to characteristic angular scales @xmath179  cm and radial scales @xmath180  cm indicating that the convective elements tend to be oblately elongated in the tangential directions .",
    "finally , these findings suggest that in 3d , convection in the o - burning shell moves more power to smaller radial scales but larger angular scales than in 2d .",
    "we also evaluated the exponential law slopes for the 3d power spectra at @xmath101  430  s and recovered @xmath181 and @xmath182 accordingly for the @xmath59- and @xmath60-reduced spectra , indicating that the slope in @xmath59 is flatter than in the 2d case while the slopes in @xmath60 are consistent .",
    "in this paper we present the method of vector spherical harmonics ( vsh ) decomposition to characterize convective stellar velocity fields by calculating power spectra that yield information about the scales where convection has the most power , the distribution of convective power over those scales , and the shape of typical convective elements .",
    "we discussed our numerical implementation of the method and used it to calculate power spectra given a momentum density field from a simulation and the inner and outer radii of the convective region that we wish to decompose into vsh .",
    "we also discussed the techniques used to implement this method for use in large scale 3d simulations that can be used to analyze 3d _ flash _ amr hydrodynamics simulations of stellar convection using large parallel computing resources , and can also be ported to other hydrodynamics codes .",
    "we highlight the importance of properly characterizing multi - dimensional convection in pre - sn stars prior to initiating ccsn simulations .",
    "as previous studies have shown @xcite the one - dimensional mixing - length theory for convection has difficulty in capturing the true nature of stellar convection in convective thin shell burning such as is expected in massive evolved stars .",
    "vigorous convection in the oxygen shell during the core si / s burning phase and in the silicon shell in the hours prior to iron core - collapse may significantly alter the structure of the progenitor star ( couch et al .",
    "2014 , in preparation ) .",
    "it can also affect the core - collapse dynamics and susceptibility to a successful explosion in 3d @xcite .",
    "in addition , the large scale plumes that develop in realistic multi - dimensional convection in oxygen - burning shells can produce gravity waves that can lead to episodic mass - loss prior to the explosion , which affects the initial circumstellar environment within which the sn takes place @xcite .",
    "these results highlight that the core - collapse sn problem is an initial value problem , and that realistic 3d convective stellar velocity fields must be imposed on the progenitor models as initial conditions to hydrodynamic simulations @xcite .",
    "we can use the vsh method to produce physically - motivated realizations of stellar velocity fields in the convective shells of sn progenitors using the derived vsh power spectra from multi - dimensional simulations , yielding more realistic , non - spherical initial conditions .",
    "we have calculated the time evolution of reduced power spectra in both the angular ( @xmath59-modes ) and the radial ( @xmath60-modes ) scales for 2d and 3d convective oxygen shell burning of a 15-@xmath0 star .",
    "we have also used the 2d analysis and results to verify and test the predictions and accuracy of our method and to produce a realized 2d velocity field for the convective oxygen shell that bears the same scale information as the original field .    in connection with realization",
    ", however it is important to emphasize that the realization strategy that we implemented in  [ realization ]  with iid uniform phases  is in a certain sense naive , at least for some purposes .",
    "the point is that the vsh decomposition is a purely kinematic device , which does not incorporate any dynamical information a priori  all such information must be inferred by inspection of the vsh transforms .",
    "this distinguishes the method from approaches to convective turbulence such as reynolds - averaging of the hydrodynamic equations @xcite , or the reduced - model approach based on ensembles of lorenz convective rolls @xcite , where the dynamics are baked in to the analysis from the outset .",
    "one consequence of the dynamical agnosticism of the vsh transform method is that a choice of phase distribution ( such as our iid uniform choice ) can fail to reproduce the coherent spatial structure ( such as convective rolls ) that appear in the simulation from which the vsh transform was extracted .",
    "the spatial coherence corresponding to dynamical flow structures characteristic of convective turbulence necessarily requires some kind of phase coherence . to reproduce it , the complex phases of the vsh transforms , as a function of @xmath183 ,",
    "should be modeled by some distribution other than iid uniform .",
    "those phases are of course available from the vsh transform",
    ". it would be interesting  and perfectly possible  to study them , and possibly even attempt to model them empirically using some correlated stochastic model , generalizing the naive iid uniform treatment of  [ realization ] . if the distributional parameters of such a model were found to be in some sense statistically stable , we would have a further grip on the statistical description of the flow , above and beyond the statistically - stable properties of the spectrum .",
    "this possibility is a promising avenue of future research in stellar convective turbulence .",
    "nevertheless , the velocity fields realized from vsh power spectra also obey to the requirements of the method on mass and momentum conservation as well as the proper boundary conditions . in the future we plan to investigate the sensitivity of ccsn explosion to phase restoration by random drawings using different seeds .",
    "it is interesting to contrast the vsh characterization of a turbulent flow with the karhune - loeve ( k - l ) decomposition @xcite , an established method for extracting the statistical content of such a flow . the k - l decomposition , which extracts the principal eigenmodes of the empirical kernel constructed from many relizations of the flow , is capable of exhibiting the principal coherent structures that are present in the flow , and indeed of correlating velocity field structure with attending structure in other field variables .",
    "the k - l decomposition therefore directly incoporates the phase - coherence modeling that would need to be added separately to the vsh decomposition , and therefore yields greater statistical information about the flow .",
    "in addition , for efficient decomposition , the kernel must be diagonalized by availing oneself of the problem symmetries . for box flows ,",
    "this means fourier transforms . in the spherical case of stars ,",
    "the vector velocity component would necessarily have to be decomposed spherically , along the lines of a vsh decomposition . in summary , although the vsh decomposition method can itself be more computationally expensive than the k - l decomposition since it requires full multi - dimensional simulations and the calculation of a sufficient number of vsh modes it has it s advantages with respect to the intended application to pre - sn stars with concentric convective shells .",
    "an additional limitation of the vsh method derives from the fact that the velocity field , even at very low mach number , does not fully characterize a turbulent flow .",
    "pressure and density perturbation fields of comparable complexity to the velocity field are necessarily also present",
    ". we do not discuss the density perturbation field in this paper , but it may in fact play an important role in the core - collapse dynamics resulting from pre - sn turbulence .",
    "for example , @xcite show that the largest density perturbations can occur at convective boundaries , whereas the implementation of the vsh decomposition developed here necessarily employs `` internal '' boundary conditions , which protects the stratification but also eliminates the velocity fluctuations associated with density fluctuations at these boundaries .",
    "the effects of those fluctuations are therefore excluded from explosions that start from vsh realizations .",
    "it is worth noting , in any event , that from the point of view of preparing ccsn progenitor models of greater realism than radial inflow models , the iid - uniform realizations may be perfectly adequate .",
    "there is no obvious specific reason why the difference between a spatially - coherent flow and a spatially incoherent one should be more important to the explosion properties of a ccsn than the difference between either of those and a radial flow .",
    "we find that the slope of the vsh power spectrum of the solenoidal modes in @xmath59 does not significantly change over the time - scales we simulated with hints of power moving to different values of @xmath59 over time in both 2d and 3d .",
    "this illustrates an advantage of the vsh spectral decomposition : it furnishes a stable statistical description of the turbulent convection in a star .",
    "we also find that most of the power goes to smaller radial and larger angular scales in 3d than in 2d .",
    "we determine the characteristic shape of the convective elements to be more asymmetric in 3d than in 2d .",
    "more specifically the convective eddies seem to be comparably elongated in the radial and tangential directions in 2d , while they seem to be `` flatter '' and more elongated in the tangential directions in 3d .",
    "we stress , however , that these results should not be over - interpreted , since the octant boundary conditions used in the 3d simulation result in axis - aligned artifacts that probably affect the spectral content of the flow , and since we simulated at most one convective overturn time - scale .",
    "we offer this analysis more as an illustration of the power of the vsh method , and of the kind of general observations about the nature of stratified convective flows that the method permits .    in the future we plan to use realized 3d convective fields obtained by the vsh decomposition method to initialize core - collapse simulations and investigate the effect of including more realistic initial conditions to the core - collapse problem .",
    "we also plan to use the method to analyze vigorous convective si burning in the hours prior to core - collapse and study its evolution with time with the aim of understanding where most of the convective energy goes prior to collapse , and of investigating the convective shell properties of a variety of sn progenitors , including rotating and magnetized stars .",
    "we would like to thank david arnett , donald q. lamb , klaus weide , j. craig wheeler and the anonymous referee for useful discussions and comments .",
    "ec would like to thank the enrico fermi institute for its support via the enrico fermi fellowship .",
    "smc is supported by nasa through hubble fellowship grant no .",
    "51286.01 awarded by the space telescope science institute , which is operated by the association of universities for research in astronomy , inc . , for nasa , under contract nas 5 - 26555 .",
    "this work was supported in part by the national science foundation under grant ast-0909132 .",
    "the software used in this work was in part developed by the doe nnsa - asc oascr flash center at the university of chicago .",
    "this research used computational resources at alcf at anl , which is supported by the office of science of the us department of energy under contract no .",
    "de - ac02 - 06ch11357 .",
    "the authors acknowledge the texas advanced computing center ( tacc ) at the university of texas at austin for providing high - performance computing , visualization , and data storage resources that have contributed to the research results reported within this paper .",
    "the vector fields @xmath39 , @xmath184 @xmath41 are defined in terms of a generic helmholtz equation solution @xmath185 . in order to furnish a full set of vector modes , it is necessary to specify a full sturm - liouville family of such solutions .",
    "accordingly , we adopt the orthonormal family of helmholtz equation solutions @xmath186 where @xmath49 is a spherical harmonic function , and @xmath187 is a solution of the radially - separated helmholtz equation , @xmath188        the discrete index @xmath194 on @xmath191 arises because the boundary conditions can only be satisfied for @xmath99 values in a discrete set .",
    "it is necessary to consider both sets of boundary conditions  dirichlet and neumann  because , as we will see , both types are required to create vector modes that satisfy the boundary condition of equation  ( [ eq : nonetmomentum ] ) .",
    "the function @xmath195 is necessarily a linear combination of spherical bessel functions of the first and second kind , @xmath196 and @xmath197 .",
    "the precise linear combination is dictated ( up to a normalization ) by the boundary conditions at @xmath70 and @xmath71 .",
    "the overall normalization is chosen so that @xmath198 the specific form of these radial functions is exhibited in the next section .    in terms of these modes , we define vector spherical modes patterned after the fields @xmath39 , @xmath184 @xmath41 of equations ( [ eq : irrotfun][eq : solenoidfun2 ] ) .",
    "the irrotational mode @xmath199 is @xmath200\\nonumber \\\\   & = & \\lambda_{lnm}^{(b)}\\left[\\frac{dg_{l}^{(b)}\\left(k_{ln}^{(b)}r\\right)}{dr}\\frac{\\mathbf{x}}{r}y_{lm}(\\mathbf{n})+g_{l}^{(b)}\\left(k_{ln}^{(b)}r\\right)\\nabla y_{lm}(\\mathbf{n})\\right],\\label{eq : a_mode}\\end{aligned}\\ ] ] where @xmath201 is a normalization constant to be determined .",
    "it is noteworthy and useful in what follows that the vector @xmath50 appearing in equation  ( [ eq : a_mode ] ) is perpendicular to the radial direction , @xmath202 .    on careful examination",
    ", we can see that with the boundary conditions on @xmath203 and @xmath204 given in equations  ( [ eq : bc_type_1 ] ) , ( [ eq : bc_type_2 ] ) , @xmath205 is purely radial at the boundaries , whereas @xmath206 is purely tangential at the boundaries . by the physical boundary conditions on momenta ( equation  [ eq : nonetmomentum ] ) it follows that only the @xmath206 modes may be legitimately employed to represent stratified velocity fields . for whole - star ( @xmath207 ) fields , on the other hand , both @xmath39 modes are available , and",
    "the appropriate mode should be selected depending on whether the velocity boundary condition at @xmath71 represents outflow or a tangential motion .",
    "the first solenoidal mode @xmath208 is @xmath209\\nonumber \\\\   & = & -\\eta_{lnm}^{(b)}\\ , g_{l}^{(b)}\\left(k_{ln}^{(b)}r\\right)\\,\\mathbf{x}\\times\\nabla y_{lm}(\\mathbf{n}).\\label{eq : b_mode}\\end{aligned}\\ ] ] again , @xmath210 is a normalization constant .",
    "both the dirichlet and neumann scalar functions are available , since manifestly neither leads to radial motion at the boundaries ( or anywhere else , for that matter ) .",
    "only one of the two sets should be selected , however . recall that this mode represents a single degree of freedom ( i.e. one scalar function ) satisfying definite boundary conditions at @xmath70 and @xmath71",
    ". either mode set has the coverage to represent such a function .",
    "given that the dirichlet and neumann modes are nt even mutually orthogonal ( see below ) , representing a vector field using both modes would be problematic , and certainly non - unique .",
    "the dirichlet mode leads to velocity fields that are zero at the boundaries , so that if non - zero tangential motion at the boundary must be modeled , the neumann modes are required .",
    "for this reason we will use the neumann modes , setting * @xmath211 * by default .",
    "the second solenoidal mode @xmath212 is @xmath213\\nonumber \\\\   & = & \\chi_{lnm}^{(b)}\\nabla\\times\\left[-g_{l}^{(b)}\\left(k_{ln}^{(b)}r\\right)\\,\\mathbf{x}\\times\\nabla y_{lm}(\\mathbf{n})\\right].\\label{eq : c_mode}\\end{aligned}\\ ] ] this can be expressed in terms of the elementary vectors @xmath3 and @xmath214 , using the identity @xmath215=\\left(\\mathbf{b}\\cdot\\nabla\\right)\\mathbf{a}-\\left(\\mathbf{a}\\cdot\\nabla\\right)\\mathbf{b}+\\mathbf{a}\\left(\\nabla\\cdot\\mathbf{b}\\right)-\\mathbf{b}\\left(\\nabla\\cdot\\mathbf{a}\\right)$ ] : @xmath216\\nonumber \\\\   &   & -g_{l}^{(b)}\\left(k_{ln}^{(b)}r\\right)\\,\\left[\\nabla\\left(\\mathbf{x}\\cdot\\nabla y_{lm}(\\mathbf{n})\\right)-\\nabla y_{lm}(\\mathbf{n})\\right]-g_{l}^{(b)}\\left(k_{ln}^{(b)}r\\right)\\mathbf{x}\\frac{l(l+1)}{r^{2}}y_{lm}(\\mathbf{n})\\nonumber \\\\   &   & -\\nabla y_{lm}(\\mathbf{n})\\left[r\\frac{dg_{l}^{(b)}\\left(k_{ln}^{(b)}r\\right)}{dr}+3g_{l}^{(b)}\\left(k_{ln}^{(b)}r\\right)\\right]\\biggr\\},\\label{eq : c_mode_alt1}\\end{aligned}\\ ] ] where we ve used the identity @xmath217 , the commutator @xmath218 , and the spherical laplacian @xmath219 .",
    "using the fact that @xmath202 , we obtain @xmath220\\nabla y_{lm}(\\mathbf{n})\\right\\ } .\\label{eq : c_mode_alt2}\\end{aligned}\\ ] ] it is clear from this expression that @xmath221@xmath222 has a non - zero radial component at the boundaries , while @xmath223 is purely tangential at the boundaries .",
    "we therefore choose the dirichlet modes @xmath224 as the mode set appropriate to the boundary condition of equation  ( [ eq : nonetmomentum ] ) .",
    "as we ve now selected a scalar boundary condition for each mode set , we henceforth we drop the @xmath46 or @xmath45 subscripts from the mode vectors for convenience . from here on ,",
    "@xmath225 , @xmath226 , and @xmath227 .",
    "the expressions for @xmath136 , @xmath111 , @xmath137 contained in equations  ( [ eq : a_mode ] ) , ( [ eq : b_mode ] ) and ( [ eq : c_mode_alt2 ] ) correspond to those in equations 13.3.67 - 69 of @xcite .",
    "it can be shown that all modes satisfy orthogonality relations .",
    "the @xmath136 are mutually orthogonal : @xmath228 where we ve used boundary condition on @xmath229 , as well as the fact that @xmath230 .",
    "to confer unit norm upon the @xmath136 modes we thus choose @xmath231    the @xmath111 are also mutually orthogonal : @xmath232 it follows that @xmath111 has unit norm if @xmath233^{-1/2}.\\label{eq : b_mode_normalization}\\ ] ] it is straightforward to show that this orthonormalization would be unchanged had we selected dirichlet modes instead of neumann modes for @xmath111 .",
    "it can also be shown that each set is orthogonal to the other two : @xmath236 thus the three sets of modes are all mutually orthogonal , and each of the @xmath136 , @xmath111 , @xmath137 represents a set comprising mutually orthonormal modes .",
    "completeness has not been established here .",
    "however , it is plausible to assume it .",
    "an arbitrary vector field corresponds in a sense to three scalar functions , each of which may be completely decomposed by sets of scalar functions such as the @xmath237 .",
    "since we have deployed a set of such scalar functions in each of the three vector mode sets , the degree - of - freedom count is unvaried , and we should expect to be able to match arbitrary vector functions with these modes .      the dirichlet radial mode functions @xmath238 satisfy the radially - separated helmholtz equation @xmath239 subject to the boundary conditions ( b.c .",
    ") @xmath240 as such , they are necessarily linear combinations of spherical bessel functions of the first and second kind , @xmath241 and @xmath242 .",
    "it is straightforward to write down a combination that satisfies the b.c .",
    "at @xmath70 : @xmath243\\nonumber \\\\   & = & \\mu_{ln}\\ , t_{ll}(kr_{1},kr),\\label{eq : g_1}\\end{aligned}\\ ] ] where @xmath244 is a normalization constant , and where for convenience we ve introduced the notation @xmath245      using the properties of the spherical bessel functions and the recursion relation ( @xcite ) : @xmath248 where @xmath249 stands for either @xmath196 or @xmath197 , it can be shown that the radial function normalization constant @xmath244 is given by @xmath250^{2}-\\frac{r_{1}^{\\,3}}{2}\\left[t_{l\\ , l-1}(k_{ln}^{(d)}r_{1},k_{ln}^{(d)}r_{1})\\right]^{2}\\right\\ } ^{-1/2}.\\label{eq : radial_normalization2}\\ ] ]    the neumann mode functions @xmath251 also satisfy equation  ( [ eq : radialhelmholtz2 ] ) , but with boundary conditions @xmath252 we may write down a linear combination of @xmath253 and @xmath254 that satisfy the boundary condition at @xmath255 : @xmath256 where the derivative terms were replaced using the recursion relation ( equation  [ eq : besselrecursion ] ) .",
    "the @xmath257 are therefore the infinite set of discrete roots of the equation @xmath258 using the relation of equation  ( [ eq : besselrecursion ] ) this becomes @xmath259 and the normalization constant @xmath260_{r_{1}}^{r_{2}.}\\right\\ } ^{-1/2}.\\label{eq : neumannnorm2}\\ ] ]    equations  ( [ eq : root_eqn ] ) and ( [ eq : nbc_eqn2 ] ) are oscillatory and have countably infinitely many roots , @xmath261 , that interleave with extrema that , in turn are roots of the derivatives of these equations .",
    "our code uses the newton - raphson method to determine all roots and extrema in succession from @xmath121  0 to @xmath262 where @xmath84 is given by equation  [ eq : nmax ] (  [ vsh ] ) .",
    "there are fundamental differences in calculating vhs using 2d versus 3d vector field data . in the 2d case",
    "there is no need to evaluate the @xmath110  0 modes because there is no information in the @xmath162 direction and rotational symmetry can be assumed ( all @xmath263 terms are zero ) .",
    "therefore only the @xmath264 , @xmath265 , and @xmath266 modes are calculated . in such case",
    "the convective elements can be thought as having a toroidal shape in 3d . as a result",
    "the total number of modes calculated is only @xmath267 .",
    "in addition , one has to be careful about the 2d vector field data set used to calculate vhs in order for orthonormality to be established .",
    "the 2d data set needs to include data representing the whole volume of the convective shell and not just a quadrant portion ( with polar angle @xmath268 ) .",
    "omission of half of the data will lead to erroneous treatment of orthonormality for the odd numbered ( in @xmath59 ) irrotational modes and the even numbered ( also in @xmath59 ) solenoidal modes .",
    "therefore , if only quadrant 2d simulation data are available a full reconstruction of the data assuming symmetry by @xmath269  @xmath163 is necessary prior to the calculation of vsh .",
    "similarly , in 3d octant simulations a full reconstruction of all data ( full sphere ) needs to be done assuming symmetry relations prior to the calculation of vsh power spectra .",
    "w.  d. , & meakin , c.  2011 , , 741 , 33 chandrasekhar , s.  1961 , hydrodynamic and hydromagnetic stability , international series of monographs on physics , oxford : clarendon , 1961 .",
    "chen , k .- j .",
    ", heger , a. , & almgren , a.  2012 , arxiv:1204.4842 couch , s.  m. , & ott , c.  d.  2013 , , 778 , l7 deane , a.  e. , & sirovich , l.  1991 , j. fluid mech .",
    ", 222 , 231 de jager , c. , nieuwenhuijzen , h. , & van der hucht , k.  a.  1988 , , 72 , 259 dubey , a. , reid , l.  b. , weide , k. , et al .",
    "2009 , arxiv:0903.4875 eggenberger , p. , meynet , g. , maeder , a. , et al .",
    "2008 , , 316 , 43 fernndez , r. , mller , b. , foglizzo , t. , & janka , h .-",
    "2014 , , 440 , 2763 gilet , c. , almgren , a.  s. , bell , j.  b. , et al .",
    "2013 , , 773 , 137 heger , a. , langer , n. , & woosley , s.  e.  2000 , , 528 , 368 jackson , j.  d.  1975 , 92/12/31 , new york : wiley , 1975 , 2nd ed .",
    "kaniel , s. , & kovetz , a.  1967 , physics of fluids , 10 , 1186 margutti , r. , milisavljevic , d. , soderberg , a.  m. , et al .",
    "2014 , , 780 , 21 mauerhan , j.  c. , smith , n. , filippenko , a.  v. , et al .",
    "2013 , , 430 , 1801 morse , p.  m. , & feshbach , h.  1953 , international series in pure and applied physics , new york : mcgraw - hill , 1953 meakin , c.  a.  2006 , ph.d .",
    "thesis meakin , c.  a. , & arnett , d.  2007a , , 665 , 690 meakin , c.  a. , & arnett , d.  2007 , , 667 , 448 makarov , v.  v. , & murphy , d.  w.  2007 , , 134 , 367 moriya , t.  j. , maeda , k. , taddia , f. , et al .",
    "2014 , arxiv:1401.4893 paxton , b. , bildsten , l. , dotter , a. , et al .",
    "2011 , , 192 , 3 paxton , b. , cantiello , m. , arras , p. , et al .",
    "2013 , , 208 , 4 press , w.  h. , teukolsky , s.  a. , vetterling , w.  t. , & flannery , b.  p.  1992 , cambridge : university press , |c1992 , 2nd ed .",
    "quataert , e. , & shiode , j.  2012 , , 423 , l92 shiode , j.  h. , & quataert , e.  2014 , , 780 , 96 simon , r.  1969 , , 2 , 390 smith , n. , & arnett , w.  d.  2014 , , 785 , 82 sirovich , l.  1987 , quarterly of applied mathematics , 45 , 561 timmes , f.  x.  1999 , , 124 , 241 timmes , f.  x. , & swesty , f.  d.  2000 , , 126 , 501 viallet , m. , meakin , c. , arnett , d. , & mock , m.  2013 , , 769 , 1 vink , j.  s. , de koter , a. , & lamers , h.  j.  g.  l.  m.  2001 , , 369 , 574 warren , m.  s. , & salmon , j.  k.  1993 , proc .",
    "supercomputing 1993 , washington , d.c .",
    ": ieee computer soc .",
    ", 12 weaver , t.  a. , zimmerman , g.  b. , & woosley , s.  e.  1978 , , 225 , 1021 woosley , s.  e. , heger , a. , & weaver , t.  a.  2002 , reviews of modern physics , 74 , 1015 young , p.  a. , & arnett , d.  2005 , , 618 , 908"
  ],
  "abstract_text": [
    "<S> we apply the mathematical formalism of vector spherical harmonics decomposition to convective stellar velocity fields from multi - dimensional hydrodynamics simulations , and show that the resulting power spectra furnish a robust and stable statistical description of stellar convective turbulence . </S>",
    "<S> analysis of the power spectra help identify key physical parameters of the convective process such as the dominant scale of the turbulent motions that influence the structure of massive evolved pre - supernova stars . </S>",
    "<S> we introduce the numerical method that can be used to calculate vector spherical harmonics power spectra from 2d and 3d convective shell simulation data . using this method we study the properties of oxygen shell burning and convection for a 15-@xmath0 star simulated by the hydrodynamics code flash in 2d and 3d . </S>",
    "<S> we discuss the importance of realistic initial conditions to achieving successful core - collapse supernova explosions in multi - dimensional simulations . </S>",
    "<S> we show that the calculated power spectra can be used to generate realizations of the velocity fields of pre - supernova convective shells . </S>",
    "<S> we find that the slope of the solenoidal mode power spectrum remains mostly constant throughout the evolution of convection in the oxygen shell in both 2d and 3d simulations . </S>",
    "<S> we also find that the characteristic radial scales of the convective elements are smaller in 3d than in 2d while the angular scales are larger in 3d .    </S>",
    "<S> = 1    0.57 in </S>"
  ]
}