{
  "article_text": [
    "the inferential building block of conventional statistics , data mining and machine learning rests on the assumption that data is identically and independently distributed ( iid ) . for example , the central limit theorem that the average of random variables ( with finite variance ) approaches a normal distribution assumes the random variables are iid .",
    "similarly standard linear regression postulates a relationship between a dependent and independent variables as @xmath0 where @xmath1 is the dependent variable , @xmath2 is the matrix in which each column represents an independent variable , and @xmath3 is the error vector , assumes that the errors ( @xmath3 ) are iid .",
    "the regression parameters @xmath4 when estimated then describe the dependent variable as a linear combination of the independent variables .    a recurring problem in spatial statistics and data mining has been to carry out a spatial inferential task without invoking the iid assumption .",
    "indeed spatially indexed random variables neither tend to be independent nor identical .",
    "in fact tobler s first law of geography  @xcite that _ everything is related to everything else , but things that are nearby are more related than distant things _ is clearly a statement against making an iid assumption in the analysis of spatial data .",
    "a common approach has been to extend the inferential process by using a spatially autoregressive step@xcite @xmath5 here , if on performing standard linear regression the residual error term @xmath3 shows spatial dependence , then @xmath6 the spatial contiguity or adjacency matrix is introduced to capture all the spatial dependency present in the data .",
    "the value of the parameter @xmath7 is estimated ( between 0 and 1 ) along with the non - spatial parameters @xmath4 , and if it is large ( towards 1 ) , then this is taken as evidence of spatial effects in the data .",
    "a large body of work has developed to exploit the above model for spatial regression tasks .",
    "however , two specific problems are identified in the literature .",
    "first , @xmath6 , which could take many different forms based on local connectivity assumptions , is always assumed a priori and imposed upon the problem  @xcite",
    ". spatial dependence of the non - spatial independent or dependent variables , as we will see , could take complex forms , and an a priori assumption of @xmath6 could at best hide latent dependences ( by not modeling long range spatial dependences since standard forms of @xmath6 model only local spatial dependence , for example ) , or at worst introduce artifact dependences ( by positing that two points close in space are similar even if they have very different behaviors , for example ) . the role of this @xmath6 has been a source of much debate in the econometrics community  @xcite , and its modeling is acknowledged as an open problem .",
    "second , even when the spatial parameter @xmath7 is estimated , it is unclear how @xmath6 itself could be helpful in making predictions on the nature of the non - spatial dependent or independent variables , beyond demonstrating that a particular problem has strong spatial effects .",
    "if however , the @xmath6 were estimated from the data along with the other regression parameters , it could be used to understand the spatial dependence inherent in the problem and then used to predict dependences and clustering properties of either the dependent or the independent variables .",
    "it could also implicitly explain the spatial effects that come into play through omitted variables that have not been modeled .",
    "in addressing the above issues , in this work we propose a convex optimization formulation of the problem where we infer both the contiguity matrix @xmath6 and the regression parameters @xmath4  @xcite .",
    "inferring both @xmath6 and @xmath4 has several advantages in capturing the specifics of the problem that are not captured in a standard assumption of @xmath6 :    1 .   by inferring @xmath6 from the data we are directly able to infer both short distance connections and long distance connections .",
    "for example , houses along a major transport link ( rail or highway ) in a city may show correlations in prices over both short and long distances .",
    "usually , the a priori assumption of @xmath6 captures only short range connectivity and misses out on the long range connectivity properties that may exist in the data .",
    "2 .   by inferring @xmath6 from the data we are directly able to capture clustering properties .",
    "usually , the a priori assumption of @xmath6 captures only local contiguity and misses out on clustered behavior that may exist in the data .",
    "this allows us to capture two different clustering effects : ( i ) a cluster that is discontinuous in space , ( e.g. , two housing submarkets in a city sharing dwelling stock and socio - economic characteristics may not be phyiscally adjacent but their house prices maybe directly correlated ) , and ( ii ) different clusters that overlap in space , ( e.g. low priced and high priced distinct submarket clusters may be superposed at the same point in space . )    however their are certain unique challenges that emerge when dealing with the above problem :    1 .",
    "the number of data items will always be less than the number of parameters . for @xmath8 locations in space and",
    "@xmath9 explanatory variables , the task is to estimate @xmath10 parameters .",
    "we address this by a sparsity regularization condition on @xmath6 , in which we choose an optimum with minimum @xmath11 norm .",
    "such a sparse solution also causes the  picking out \" of the most important spatial dependence relations . at the same time",
    ", it ensures that we choose an optimum that satisfies a given condition out of the infinite possible optima .",
    "2 .   how should one carry out a validation of @xmath6 ; i.e. , once we estimate a @xmath6 , how do we validate whether its learnt form is actually giving us meaningful information ? we address this by posing the optimization formulation in a form that ensures consistency with ordinary least squares ( ols ) solutions . that is , when the sparsity condition on @xmath6 is removed , we obtain the non - spatial least squares solution , since @xmath6 is forced to be close to zero.the ols solution is treated as the baseline for prediction accuracy .",
    "then , when the weight on the sparsity condition is increased , and we learn a sparse @xmath6 , then the prediction accuracy should improve . additionally , using the boston and sydney housing market data",
    ", we also validate the cluster structure detected by @xmath6 by comparing it with actual price submarkets in the data , to ascertain that the spatial dependence of the dependent variable being uncovered by @xmath6 is meaningful .",
    "finally how can the inferred parameters be used in a given application setting ?",
    "we address this by showing that the learnt @xmath6 leads to both better accuracy of prediction as well as the simultaneous identification of cluster structure in the data . in the context of housing markets",
    ", this leads to simultaneous estimation of global regression parameters along with the identification of housing submarkets and spatial spillover effects .",
    "once the submarkets have been identified , independent local ols could be run for these to identify subsets of explanatory variables that play special roles in specific submarkets .",
    "the rest of the paper is organized as follows .",
    "section  [ background ] provides a background on the application setting : housing markets .",
    "section  [ probdef ] formulates the optimization problem , and section  [ algo ] provides the admm solution and algorithm .",
    "section  [ results ] presents the results of applying the model and algorithm to housing market data from boston and sydney .",
    "finally , related work is presented in section  [ relatedwork ] and we end with conclusions in section  [ conclusions ] .",
    "the approach we present in the paper is completely general and can be applied wherever spatial data is used . however , for concreteness , all our examples and experimental results will be based on housing markets analysis and predictions .    the primary tool in housing econometrics for predicting relationships between a dependent variable ( e.g. price ) and a set of independent variables ( e.g. socio - economic or hedonic variables ) is regression .",
    "traditional regression studies are modeled , however , on the assumption that the entire city or region is a unitary housing market  @xcite .",
    "if the entire city or region is a single market , then traditional regression models need not consider spatial dependence beyond global location variables .",
    "the parameters of regression could then predict price and other trends in terms of sets of socio - economic and hedonic variables that operate consistently for the entire market .",
    "however , as new research reveals , this view is problematic .",
    "the current mainstream view of a unitary housing market stems from the seminal work on access - space models by alonso and muth  @xcite , where the price gradient for housing costs is modeled in terms of the travel distance at which housing is located from the central business district ( cbd ) .",
    "although powerful in terms of providing analytically tractable long term equilibrium behaviors in terms tradeoffs of location , travel costs , and housing price , these models make a number of simplifying assumptions .",
    "there are no distinctions of housing or dwelling types , the city is embedded in a featureless space , travel costs are the same in all directions , and a monocentric city is assumed with a single cbd .",
    "these assumptions , however , do not hold for most cities .",
    "thus , while the access - space models explain the large scale suburbanisation behaviors successfully , they are unable to account for the heterogeneity of the housing market , observed by the consistent presence of housing submarkets within a larger market . in the presence of polycentricity of urban structure (",
    "as opposed to one cbd ) and other socio - economic , transport , land use and housing stock characteristics that break the symmetry of the monocentric price gradient model , a single city or region s housing market could show price gradients of a highly variable nature .",
    "a significant body of research as well as current market conditions now provide convincing evidence of quasi - independent housing submarkets within a highly segmented unitary housing market  @xcite .",
    "a housing submarket is defined as a set of dwellings that are close substitutes for other dwellings in the same submarket , but a poor substitute for dwellings in other submarkets . in terms of spatial distribution",
    ", views are divided between whether such submarkets are geographically defined , or defined on the basis of structural variables such as dwellings types . while the geographical definition provides spatially demarcated and non - overlapping submarkets , the structural definitions provide spatially segregated and discontinuous submarkets scattered through the city ( e.g. as has been defined for sydney and melbourne  @xcite .",
    "however , it is accepted that neither the geographical nor the structural definition by itself can provide accurate identification of submarket structures , and that both georgaphy and structural features must be considered jointly for the task  @xcite .    to the best of our knowledge",
    ", we do not know of algorithms , methods or theory that addresses how geographical heterogenous clustering and global structural trends can be brought together jointly to accurately identify housing submarkets . even though the regression and clustering problems are intimately related , current approaches are usually sequential and either the regression problem sits divorced from the clustering problem , or the clustering problem is qualitatively pre - treated in ad - hoc ways  @xcite .",
    "this concrete application problem also outlines the general need for learning the structure of short range , long range , or clustered spatial dependence along with the simultanoeus estimation of regression parameters .",
    "let @xmath1 be an @xmath12 vector of prices ( or any other dependent variable ) , let @xmath2 be an @xmath13 matrix , each column of which represent one of @xmath9 explanatory variables , and let @xmath4 be a @xmath14 vector of regression parameters .",
    "then the standard regression model is stated as @xmath15 , where @xmath3 represents the error term . in the presence of spatial autocorrelation",
    ", the error term does not show the identically independently distributed ( i.i.d . )",
    "structure , but instead shows spatial patterns of dependence .",
    "an example standard response in spatial econometrics and statistics is a spatial autoregressive model ( sar ) model of the form : @xmath16 , where the matrix @xmath6 is an @xmath17 spatial dependence matrix . as discussed , this @xmath6 is modeled based on local distance , contiguity or lattice type assumptions .",
    "the principle observation is that it is imposed onto the problem as a data term , instead of being treated as a variable .",
    "we now consider the more realistic case where we treat @xmath6 as a variable and learnt . in the case of housing prices ,",
    "particular neighborhoods for example show similar price trends because of the common presence of highly regarded local amenities such as school quality or negative criteria such as crime rates .",
    "thus , it is likely that the price data will show spatial clustering , in which case @xmath6 could have a clustered structure with short and long range dependences rather than following local lattice , distance or contiguity assumptions .",
    "in other words , @xmath6 could have a higher - order structure that could be revealed using the data itself .    since we have to estimate @xmath10 parameters , and the number of variables is always going to be higher than the data",
    ", we will have an infinite number of solutions .",
    "in this instance , we draw upon the condition that @xmath6 has to be sparse and positive , since a dense @xmath6 implies every location is related to every other , and is unlikely to provide meaningful information . hence we learn the @xmath6 with the minimum @xmath11-norm .",
    "thus , the optimization problem can be stated as : @xmath18",
    "we will use admm  @xcite to solve the above optimization problem . introducing auxiliary variable @xmath19 , we can rewrite the above as @xmath20    then , the augmented lagrangian is written as @xmath21 = \\\\   & \\frac{1}{2 }",
    "||\\mathbf{y } - \\mathbf{wy } - \\mathbf{x}\\beta||_{2}^{2 } ~+~ \\lambda_{1 } ||\\mathbf{a}||_{1 } \\\\ & ~+~ \\text{tr}[\\mathbf{\\delta_{1}}^{t } ( \\mathbf{a } - \\mathbf{w } + diag(\\mathbf{w } ) ) ] \\\\ & ~+~ \\frac{\\rho_{1}}{2 } ||\\mathbf{a } - \\mathbf{w } + diag(\\mathbf{w})||_{2}^{2 } ~+   i_{+}(\\mathbf{w } ) \\end{aligned}\\ ] ] where @xmath22 when @xmath23 and @xmath24 otherwise .",
    "@xmath25 ~+ \\\\",
    "\\frac{\\rho_{1}}{2 } ||\\mathbf{a } - \\mathbf{w } + diag(\\mathbf{w})||_{2}^{2 } ~+   i_{+}(\\mathbf{w } ) \\bigg ] \\end{aligned}\\ ] ]    looking at the individual terms ,    @xmath26 \\\\ = \\frac{1}{2 } \\frac{\\partial}{\\partial \\mathbf{w } } \\bigg [ \\text{tr } ( \\mathbf{y } - \\mathbf{wy } - \\mathbf{x } \\beta ) ( \\mathbf{y } - \\mathbf{wy } - \\mathbf{x } \\beta)^{t } \\bigg ] \\\\",
    "= \\frac{1}{2 } \\bigg ( \\frac{\\partial}{\\partial \\mathbf{w } } tr \\bigg [ -\\mathbf{yy}^{t}\\mathbf{w}^{t } - \\mathbf{wyy}^{t } + \\mathbf{wyy}^{t}\\mathbf{w}^{t } \\\\ + \\mathbf{wy}\\beta^{t}\\mathbf{x}^{t } + \\mathbf{x}\\beta \\mathbf{y}^{t}\\mathbf{w}^{t } \\beta \\bigg ] \\bigg ) \\\\ = -\\mathbf{yy}^{t } + \\mathbf{wyy}^{t } + \\mathbf{x}\\beta \\mathbf{y}^{t } \\end{aligned}\\ ] ]    similarly ,    @xmath27 \\\\ = - \\mathbf{\\delta_{1 } } + \\text{diag}(\\mathbf{\\delta_{1 } } ) \\end{aligned}\\ ] ]    similarly ,    @xmath28    combining all the individual terms and setting them to zero , and applying the positivity constraint on @xmath6 , we get    @xmath29 ^ { -1 } ( \\mathbf{yy}^{t } - \\mathbf{x}\\beta \\mathbf{y}^{t } + \\mathbf{\\delta_{1 } } - \\text{diag}(\\mathbf{\\delta_{1 } } ) + \\\\ \\rho_{1 } \\mathbf{a } + \\rho_{1 } \\text{diag } ( \\mathbf{a } ) ) \\bigg ] _ + \\end{aligned}\\ ] ]      @xmath31 \\\\ + \\frac{\\rho_{1}}{2 } ||\\mathbf{a } - \\mathbf{w } + diag(\\mathbf{w})||_{2}^{2 } \\bigg ] \\end{aligned}\\ ] ]    applying the soft - thresholding operator ,    @xmath32    we will get    @xmath33      @xmath34 \\end{aligned}\\ ] ]    this can be solved as @xmath35 \\\\ = \\frac{1}{2 } \\frac{\\partial}{\\partial \\beta } \\bigg [ \\text{tr } ( \\mathbf{y } - \\mathbf{wy } - \\mathbf{x } \\beta ) ( \\mathbf{y } - \\mathbf{wy } - \\mathbf{x } \\beta)^{t } \\bigg ]",
    "\\\\ = \\frac{1}{2 } \\bigg ( \\frac{\\partial}{\\partial \\beta } \\text{tr } \\bigg [ -\\mathbf{y } \\beta^{t } \\mathbf{x}^{t } + \\mathbf{wy } \\beta^{t } \\mathbf{x}^{t } - \\mathbf{x } \\beta \\mathbf{y}^{t }    \\\\ + \\mathbf{x } \\beta \\mathbf{y}^{t } \\mathbf{w}^{t } + \\mathbf{x } \\beta \\beta^{t } \\mathbf{x}^{t }   \\bigg ] \\bigg ) \\\\ = -\\mathbf{x}^{t }",
    "\\mathbf{y } + \\mathbf{x}^{t } \\mathbf{w y } + \\mathbf{x}^{t } \\mathbf{x } \\beta ) \\end{aligned}\\ ] ]    setting this to zero , we get    @xmath36 \\end{aligned}\\ ] ]      finally , we can update the lagrangian multiplier @xmath37 as    @xmath38    * convergence .",
    "* this is run iteratively to convergence . since",
    "this optimization problem is convex , admm is guaranteed to attain a global minimum .",
    "we have used a stopping criterion where we measure the absolute difference between the primal and dual variables and stop when the error is stabilized below a given threshold .",
    "we test our approach on two data sets : ( a ) the boston housing data set , that provides the prices and explanatory variable measurements for 506 houses along with the latitude and longitude locations , and ( b ) a data set for 51 local government areas ( lgas ) of sydney , further subdivided into 862 suburbs , with 2015 prices of houses and related explanatory variables available for both area definitions .",
    "we have independently run the optimization model on cvx as well as our admm algorithm , and while the results from both are the same , the cvx takes much more time as the number of locations ( @xmath8 ) climbs even upto 500 .",
    "for example , testing the @xmath39 sydney suburbs dataset took about 960 seconds ( about 16 minutes ) on cvx , whereas it takes negligible time with admm .",
    "the inference of the spatial weights matrix @xmath6 should , as one of its main contributions , scale to identifying fine scale spatial clustering ( in this case , housing submarkets ) for latitude - longitude level microdata upto the individual house level .",
    "this would mean big data sets with millions of locations .",
    "hence , we establish the justification for proposing the admm algorithm . our results , contributions and validations for each data set are reported in three sections , discussed below .",
    "first , we present a comparison of the result of our model with the ordinary least squares ( ols ) and spatial autoregressive models ( sar ) , showing consistent estimates of @xmath4 across all the three cases . however , in our approach , we also learn the structure of spatial dependence , through the spatial weights matrix @xmath6 , that is ignored in ols and the form of which is assumed _ a priori _ as a data term in sar . while we use the sar model only as one of the possible spatial regression models , we note that almost all spatial regression models assume an a priori fixed @xmath6 .",
    "this is problematic , because a priori assumptions rest on modeling only local spatial connectivity , whereas the data may contain a mix of short range and long range connectivity as well as clustering .",
    "hence , to learn the structure of @xmath6 would have many advantages . the main contribution of the approach presented in this paper is learning this @xmath40 along with the consistent estimation of the regression parameters .",
    "we note here that the consistent estimation of regression parameters for the entire region is important , since regression parameters are required to be  global \" for most policy settings .",
    "thus , a validation check on any identified structure of @xmath6 is that its co - inference with @xmath4 does not lead to wildly deviant or fluctuating forms for @xmath4 and is largely consistent with ols results .",
    "for example , even though in principle , it is possible to run local regressions for each lga or census tract or suburb within a metropolitan or state region , policy decisions are usually made by authorities at the metropolitan or state level on the basis of the global paramters .",
    "it is also at the metropolitan or state level that housing submarket clusters need to be identified for the entire urban region .",
    "this would require that regression parameters be globally estimated for entire regions ( as they usually are ) .",
    "this approach provides an added global - local connection , since it does not preclude the possibility of carrying out local regression too .",
    "once the estimation of local spatial clusters are performed using @xmath6 , it is always possible to run local regression models for the identified submarket clusters ( that are hard to define otherwise , as noted in the background section ) .",
    "the boston housing data set was produced in 1978 , incorporating measurements of 14 variables across 506 census tracts  @xcite , and is available as part of the matlab spatial econometrics package  @xcite .",
    "the log of median value of owner - occupied homes in $ 1000 s is taken as the dependent variable , and all the others as explanatory ( per capita crime rate by town , proportion of residential land zoned for lots over 25,000 sq.ft . ,",
    "proportion of non - retail business acres per town , a charles river dummy variable (= 1 if tract bounds river ; 0 otherwise ) , nitric oxides concentration ( parts per 10 million ) , average number of rooms per dwelling , proportion of owner - occupied units built prior to 1940 , weighted distances to five boston employment centres , index of accessibility to radial highways , full - value property - tax rate per $ 10,000 , pupil - teacher ratio by town , the proportion of black population by town , and lower status of the population ) .",
    "we first report on the estimation of the regression parameters @xmath4 .",
    "figure  [ bostonfig1 ] shows the prediction from ols , sar , and admm , respectively , along with the @xmath4 estimates and corresponding @xmath41 values .",
    "the spatial weights matrix @xmath6 for the sar estimation was computed using the inbuilt routines in the matlab spatial econometrics package .",
    "it is seen that the co - estimation of @xmath6 causes the @xmath41 to rise , at the same time , maintaining the consistency of the regression parameters @xmath4 . in the next section",
    "we report on analysing the structure of the inferred @xmath6 , but simply note for now that the co - estimation of spatial dependence from data can actually improve prediction capability , through the higher @xmath41 that results while holding @xmath4 consistent .      at the time of writing this paper , the housing market in sydney",
    "is witnessing a particularly turbulent time  @xcite . in 2014 - 15",
    ", there were warnings of an impending  housing bubble \" , prices have risen consistently and steeply in the last few years , and housing is deemed as acutely unaffordable especially for the younger and poorer sections of the population  @xcite . by 2016 , there are now warnings of an impending fall in prices .",
    "it is an important problem to estimate the fine scale spatial organization of housing submarkets in especially sydney and to some extent melbourne , since they are the regions witnessing the highest rises in price as well as demand population . to the best of our knowledge ,",
    "no statistically or quantitatively based identification of sydney and melbourne housing submarkets have been performed to date , though there is ample evidence of policy interest in the issue and qualitative urban planning approaches that are directed towards tackling this problem  @xcite .",
    "the australian bureau of statistics publishes capital city housing price index series , but assumes the entire metropolitan region as a single housing market , without the identification of clustered submarkets within the region that are witnessed and experienced by residents .",
    "large parts of cities being unaffordable and out of reach pose serious socio - economic affordability and equity concerns .",
    "the agency that records all of the residential property transactions is core logic / r p data .",
    "they have made the data available for university and academic research through an organization called sirca .",
    "we have obtained 9 months ( latest at the time of writing this paper ) of 2015 residential property transactions data for the sydney housing market , that we aggregate over each geographical area of analysis to produce an annual aggregate .",
    "the metropolitan region of sydney is divided into 43 local government areas ( lgas ) and about 8 outlying lgas that are adjacent to metropolitan sydney and seeing spillover growth .",
    "we have included all these 51 regions in our analysis .",
    "the 51 lgas further subdivide into about 862 susburbs ( roughly corresponding to individual post - code areas ) , that forms the lowest level of area definitions for which aggregated data is available from rp data .",
    "data is available for both houses and units ( apartments ) separately , and in this paper we consider the individual detached houses data , since sydney is pre - dominantly a detached dwelling houses market ( though the apartment market is becoming increasingly important recently due to increased population pressures ) .",
    "the dependent variable is median price per location ( lga or suburb ) , the log of which has been considered for the suburb level data , and the explanatory variables are the numbers of houses sold per location , the total monetary value in dollars of the total number of properties sold , the number of properties sold under $ 200,000 , from $ 200,000 - $ 400,000 , $ 400,000 - $ 600,000 , $ 600,000 - $ 800,000 , $ 800,000 - $ 1,000,000 , $ 1 million - $ 2 million , and above $ 2 million , the rental median for each area , the total number of dwellings listed for selling , and the total numbers of dwellings in the area .",
    "figure  [ sydney_fig3 ] shows the predictions of regression parameters from both ols and the admm ( the predictions from sar are close to these ) .",
    "again , it is seen that with consistent @xmath4 emerging from all approaches , the @xmath41 values are higher for the admm , showing a better fit .",
    "it is also interesting to observe in the sydney case , that while the explanatory variables that measure how many properties are being sold within given price ranges of $ 200,000 brackets emerge as very important at the lga level , they turn out to be less important at the suburb level .",
    "this is due to the nature of the data itself - where at the suburb level , many of them may be  low activity \" zones within a particular lga , and numbers being sold and reported are much lower than the same at the lga level ( with many zero values )",
    ". however , the estimates are consistent where the data themselves are similarly scaled at both geographic levels . for example , the second variable is the total value of the sales in dollars , and is consistent for both area definitions .",
    "the eleventh variable is the rental median for the area , and is consistent for both area definitions .",
    "the consistency of the admm algorithm estimating regression parameters consistent with ols is not simply an empirical observation , but can also be observed from the admm model . when we set the regularizer @xmath42 to zero , we get ols estimates from the admm model . since with @xmath43 , the algorithm places no special weight to spatial dependence , the resulting @xmath6 estimate coming from the data term @xmath44 results in a dense @xmath6 but with extremely small close to zero entries .",
    "then , the @xmath45 that is estimated are the same as or extremely close to those estimated in the ols . when the @xmath42 value is increased , a sparser @xmath6 is returned but with higher valued entries .",
    "then , the @xmath45 shifts in a consistent way , along with producing a sparse @xmath6 matrix that brings out the spatial dependence in the data . the values of @xmath42 used for the reported results are shown in the figure captions in each case , but in general a larger value of @xmath42 is needed for larger data sets .",
    "the consistency of the estimated @xmath4 and the improvement of the fit of prediction from our approach provides a first validation for the structure of the learnt @xmath6 .",
    "we now report on the nature of spatial dependence and clustering that is learnt in the @xmath6 matrix .",
    "the approach presented in the paper models @xmath46 , showing that @xmath6 should capture  price \" submarkets , or more generally , spatial dependence of the dependent variable .",
    "therefore , to provide a second validation to the structure of @xmath6 , we compare against the spatial structure of the actual price data and the clustering predictions made by performing a spectral clustering of the learnt @xmath6 .",
    "we note here that the same approach can be extended to model  demand \" or  supply \" submarkets too , or more generally , clustering and short and long range spatial dependence of the explanatory variables .",
    "for example , we could have a model @xmath47 , which is not convex but bi - convex in @xmath6 and @xmath45 , and would need a different admm algorithm to be derived .",
    "but , the general principle of deriving the spatial dependence will hold .",
    "estimating @xmath6 has a particular advantage that is motivated by an omitted variables observation .",
    "in any regression model , it is impossible to capture all the variables that affect the dependent variable , due to factors such as unknown variables or unavailable data . in such a case",
    ", estimating spatial dependence via @xmath6 can be used to implicitly predict how changes in a particular location could lead to changes in all other locations without explicitly knowing about all the other variables that have been omitted .",
    "figures [ bostonfig2](a - d ) show the learnt @xmath6 matrix using our algorithm , compared to the pre - fixed @xmath6 used in sar : instead of only local spatial connectivity the learnt @xmath6 captures both long range connectivity between locations as well as clustering behavior .",
    "we test this finding by performing an eigenvalue decomposition of the learnt @xmath6 , identifying the number of leading eigenvalues @xmath48 separated from the bulk distribution of eigenvalues , and then clustering lower @xmath48-dimensional representation of @xmath40 using k - means  @xcite .",
    "such clustering is not identified for the @xmath6 from sar [ fig .",
    "[ bostonfig2](b ) ] .",
    "figure  [ bostonfig2](e ) shows the real price distribution in the 506 locations , where blue corresponds to lowest prices and red to highest prices .",
    "note that the spatial clustering is not local , and there are instances where lower priced houses occur in close proximity to higher priced houses .",
    "the clusters are therefore mixed or superposed in space .",
    "moreover , there are also long range spatial dependences , with similar priced houses heterogenously spread across in space . assuming purely local spatial dependence as spatial regression models assume will not capture these superpositions of clusters in short range or long range spatial dependence of prices as observed in the boston data .",
    "figure  [ bostonfig2](f ) shows the clusters returned by the kmeans algorithm performed over the lower 4-dimensional representation of our learnt @xmath6 : the price clusters retrieved capture meaningful information ; the highest priced cluster is yellow ( white in fig .",
    "[ bostonfig2](e ) ) , the second highest price cluster is light blue ( yellow in fig .",
    "[ bostonfig2](e ) ) , the third highest price cluster is dark blue ( organge in fig .  [ bostonfig2](e ) ) , and the lowest priced one is dark red ( dark red also in fig .  [ bostonfig2](e ) ) .",
    "the derived clusters correlate strongly with price data as well as short range and long range spatial dependences .    to validate and test this finding more strongly , we plot the top two eigenvector components of both the sar @xmath6 and the one learnt from the admm algorithm . figure  [ bostonfig2](g , h ) show the top two eigenvector components of the sar based and admm based @xmath6 matrices , respectively , with the eigenvector components colored by price data .",
    "as is clearly visible , the sar based @xmath6 does not capture any clustering or short or long range dependence , since by definition , it is defined purely on the basis of local connectivity between points .",
    "in contrast , the top two eigenvectors of the @xmath6 derived using the admm algorithm shows clear clustering behavior .",
    "figure  [ lga_clusters ] shows the spatial structure of @xmath6 derived using the admm analysis for the sydney housing prices data .",
    "again , just like the boston example , we have performed a spectral clustering of the derived @xmath6 . at both the lga and suburb levels",
    ", the identified clusters are spatially plotted using geographic information systems ( gis ) software to show the spatial nature of @xmath6 along with the short range and long range dependencies derived from it , in addition to clustering behavior .",
    "we note here again that such analysis can not be performed for the local contiguity matrices of the kind used in spatial regression models such as sar .",
    "figure  [ lga_clusters](a ) shows the clusters identified for the 51 lgas of the sydney metropolitan area .",
    "we interpret the clusters using our local knowledge of the housing market in sydney .",
    "there were 7 clusters identified , corresponding to the 7 leading eigenvalues of @xmath6 .",
    "sydney is a coastal city , with its central business district ( cbd ) at the eastern most end next to the sea . from the cbd , the city is roughy divided into inner , middle and outer rings of sydney .",
    "the price structure roughly follows this spatial structure with the inner ring the most expensive and the outer ring the least expensive . however , there is also a very pronounced north - east ( much more expensive ) and south - west ( less expensive ) divide  @xcite .",
    "figure  [ lga_clusters](a ) shows that all of these effects have been identified in the clusters : the grey and dark blue colors represent the most expensive inner ring lgas . note that the more expensive lgas are more pronounced towards the east and the north .",
    "the light and dark orange clusters roughly represent the middle ring .",
    "again , the more expensive lgas are stretched toward the north ( e.g. the hills shire in the north colored light orange is a significant distance away from the cbd , but is very expensive with respect to the median and is placed in a cluster along with more distant lgas closer to the city cbd ) .",
    "finally , the least expensive lgas are in the outer ring and show a pronounced south - west concentration . figure  [ lga_clusters](b ) and ( c ) show the actual prices and the clusters identified for the 862 suburbs into which the 51 lgas of the sydney metropolitan area are divided into .",
    "4 main clusters were identified corresponding to the 4 leading eigenvalues of @xmath6 .",
    "other small eigenvalues close to the bulk but just merging into the bulk exist , and it is possible that the clustering may have a hierarchically nested structure if more eigendimensions are chosen for the clustering  @xcite .",
    "we will explore this in future work .",
    "however , the spatial organization of actual prices [ fig .  [ lga_clusters](b ) ] and the clusters identified through @xmath6 [ fig .  [ lga_clusters](c ) ] are clearly similar .",
    "one observation is that at the suburb level the clusters are much more fractured .",
    "the reason for this is that there is a lot of heterogeneity within single lgas , with price and socio - economic differences between them .",
    "thus , contiguous groups of suburbs belonging to different lgas could belong to the same cluster at this finer suburb level .",
    "second , even with the fractured picutre , there are major patterns visible : ( a ) the north - east suburbs of main sydney city largely belong to different clusters as compared to the south west suburbs of main sydney , but in 2015 pockets of high priced activity submarkets are visible towards the outer south and outer far north and ( b ) the highest priced suburbs ( mostly orange red and dark to middle blues ) around the city extend into the west and south along where the major transportation links are ( railway , freeways etc . ) .",
    "figure  [ lga_clusters](d ) and ( f ) show the top two eigenvector components of @xmath6 for the lgas and suburbs , respectively .",
    "again , the localization of eigenvector components by price is clearly visible . this clustering is not visible for a local contiguity matrix that we built by hand for the lgas of sydney , in which we connected each lga to other lgas with which it shares boundaries .",
    "the corresponding eigenvector components of this hand - crafted @xmath6 or other similar variants based on local contiguity needed for running the sar algorithm or other spatial regression models is shown in fig .",
    "[ lga_clusters](e ) .",
    "once the structure of @xmath6 has been learnt , and local price submarkets ( or dependent variable clusters ) identified , local regression can be performed for each of the submarkets .",
    "we have divided the entire data into the 4 identified submarkets , and then divided each of the 4 submarkets into training and test sets , with the test sets containing 30 data points each .",
    "this implies 120 randomly picked data points separated out from the whole data set of 862 suburbs .",
    "then , we have performed ols for the whole training set ( i.e. , @xmath49 data points in the test set ) , followed by ols on the training sets for each of the individual submarkets ( i.e. , minus the 30 test data points from each of the submarkets ) .",
    "then , we have used the test set of 120 data points to estimate the price prediction using the ols estimates from training on the 742 suburbs . in parallel , we have predicted the price for the same 120 points , but this time divided into the 30 data points per submarket , and used the submarket ols estimates to predict the local submarket price for these points .",
    "figure  [ submarkets ] shows that in each case , the local submarket prediction is more accurate than the the whole market prediction .",
    "this demonstrates that by using the structure of the learnt @xmath6 better local regression estimates can be produced for specific housing submarkets .",
    "this is important from the policy perspective , because planning authorities could consider the regression parameter estimates from both the global whole city level as well as the local submarkets levels , to specifically inform spatial decisions such as new land release or density based rezoning .",
    "finally , we note that in spatial regression , a change in one of the explanatory variables could result in spatial spillover effects , such that the dependent variable is affected for several locations by a change in a single location .",
    "this is not considered in ols , where a change in the explanatory variables changes the prediction for only one data point . using both the estimated @xmath4 and @xmath6 , changes in the explanatory variables",
    "can be used to study the spatial spillovers for all the dependent variables .    to predict the spatial spillover effect",
    ", we change the values of a few explanatory variables , producing a new @xmath50 and use the learnt @xmath40 and @xmath4 to recompute a new price vector @xmath51 .",
    "this corresponds to modeling changes in the existing situations .",
    "for example , one of the variables in the boston data set is the average number of rooms per dwelling .",
    "since existing dwellings are often upscaled in size ( e.g. the addition of a double storey ) , the values of the explanatory variables will change .",
    "however , in contrast to ordinary regression , in the spatial case there is evidence of real spatial spillovers that need to be estimated : if a few houses in a neighborhood are upscaled , this may result in a price rise for even those nearby dwellings that do not upscale .",
    "thus , it is necessary to predict not just a price of a new @xmath52 with given explanatory variables , but also how this perturbation to the existing system could in turn change the existing prices , given an exisiting structure of spatial dependence in @xmath6 , and the estimated @xmath4 . in the case of the boston data",
    "set , we successfully use this approach to predict new prices and spatial spillover effects by making small perturbations to the existing variables and recomputing the new price vector @xmath53 using the learnt @xmath40 and @xmath4 .",
    "figure  [ bostonfig3 ] shows , for example , the predicted change in prices ( @xmath54 ) by raising the average number of rooms variables for 3 locations . the 3 locations themselves go through the largest price change ( red points ) , but also visible are changes to other houses in the area that belong to a similar price segment ( shades of blue ) .",
    "note that the prices for nearby houses that do not belong to the same price cluster do not change as much as those that do belong to the same price cluster .",
    "thus , the prediction of the spatial spillover effect is filtered not just by local spatial distance or connectivity , but by the structure of both short range and long range dependencies learnt in @xmath40 .",
    "we will review the relevant work in spatial autoregressive models ( sar ) and alternating direction method of multipliers ( admm ) .",
    "sar models were introduced as a generalization of linear regression to explicitly model spatial autocorrelation in data  @xcite . given a sar model @xmath55 , the parameters @xmath7 and @xmath4 can be estimated using either maximum likelihood estimation or bayesian methods .",
    "the sar model is sometimes referred to as the spatial lag or even the mixed regressive model .",
    "the computational challenge in the estimation the sar model arise due to the need for estimating the spatial dependency parameter @xmath7 as it amounts to optimizing the following function involving a log determinant term of an @xmath17 matrix : @xmath56 since the log determinant term requires the computing the eigenvalues of @xmath57 several approximation including approximations based on the trace , chyebyshev s polynomial have been proposed  @xcite . in our formulation by making @xmath57 as the unknown we have avoided the computation of the log det term .",
    "our admm formulation is bottlenecked by the computing the inverse of @xmath58 .",
    "the admm approach is now routinely used to solve problems of the form :  @xcite    @xmath59    admm is particularly suitable for solving optimization problems arising in data mining and machine learning where @xmath60 represents the data fitting term and @xmath61 enforces regularization . while admm has not been used the formulation of the sar problem , there have been two strands of work which bear some similarity . in kdd 2015 , hallac et .",
    "al .  @xcite introduced the problem of _ network lasso_. given a graph @xmath62 where where each node is associated with a variable @xmath52 , the network lasso optimization formulation is @xmath63 here @xmath64 are elements of the contiguity matrix that is assumed to be given a priori .",
    "the paper tests its approach on california housing data set and infers clusters based on the price variables by fixing the number of nearest neighbors for each data point .",
    "another strand of research is related to spectral unmixing ( su )  @xcite where the objective is to learn the so called abudnance matrix @xmath57 given by the equation @xmath65 . here",
    "@xmath40 captures matrix regression parameters .",
    "similar formulations to address image denoising problem have been addressed  @xcite .",
    "we have presented a convex optimization formulation of the spatial autoregressive regression ( sar ) model ( @xmath66 ) where both the contiguity matrix @xmath57 and the regression parameters @xmath4 are treated as unknown . to the best of our knowledge",
    "this is the first spatial regression formulation where the contiguity matrix is inferred from data .",
    "we have developed an admm based algorithm to solve the convex optimization problem which is nearly two orders of magnitude faster than using generic convex optimization solvers like cvx .",
    "one of the side effects of our approach is that the inference of @xmath57 gives us a natural way to cluster the underlying spatial data .",
    "infact our approach can be seen as a method of simultaneously carrying out regression and clustering on data while obtaining global regression parameters !",
    "we apply our approach on two housing data sets ( boston and sydney ) where the focus is on price prediction .",
    "analysis of the inferred contiguity matrix reveals the existence of housing submarkets which have their own internal characteristics and the both short and long range interactions between them .",
    "we conjecture that our approach will be of invaluable help to both urban policy makers and real estate professionals who want to get a deeper insights about the endogenous aspects of housing markets .",
    "the work in this paper has been supported by a university of sydney henry halloran trust grant that funds the urban lab @ sydney and the housing lab incubator .",
    "the authors thank core logic / r p data and sirca for providing the aggregate level data for sydney .",
    "33ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop _ _  ( ,  ) @noop ( ) @noop _ _ ,  vol .",
    "( ,  ) @noop _ _  ( , ) @noop _ _  ( ,  ) @noop ( ) @noop * * , ( ) @noop * * , ( ) @noop _ _  ( , ) @noop _ _  ( ,  ) @noop * * ,   ( ) @noop _ _  ( , ) @noop _ _ ( ,  ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop `` , ''   ( ) ,   @noop `` , ''   ( ) ,   @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop `` , ''   ( ) ,   @noop ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  vol .",
    "( ,  ) in  @noop _ _  ( ,  )  pp .   @noop * * ,   ( ) in @noop _ _ ( ,  )  pp",
    ".   http://arxiv.org/abs/1410.3699 [ * * ( ) ] in  @noop _ _  ( ,  )  pp ."
  ],
  "abstract_text": [
    "<S> inference methods in traditional statistics , machine learning and data mining assume that data is generated from an independent and identically distributed ( iid ) process . </S>",
    "<S> spatial data exhibits behavior for which the iid assumption must be relaxed . </S>",
    "<S> for example , the standard approach in spatial regression is to assume the existence of a contiguity matrix which captures the spatial autoregressive properties of the data . </S>",
    "<S> however all spatial methods , till now , have assumed that the contiguity matrix is given apriori or can be estimated by using a spatial similarity function . in this paper </S>",
    "<S> we propose a convex optimization formulation to solve the spatial autoregressive regression ( sar ) model in which both the contiguity matrix and the non - spatial regression parameters are unknown and inferred from the data . we solve the problem using the alternating direction method of multipliers ( admm ) which provides a solution which is both robust and efficient . </S>",
    "<S> while our approach is general we use data from housing markets of boston and sydney to both guide the analysis and validate our results . </S>",
    "<S> a novel side effect of our approach is the automatic discovery of spatial clusters which translate to submarkets in the housing data sets . </S>"
  ]
}