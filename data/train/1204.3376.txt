{
  "article_text": [
    "the random graph model @xmath0 assigns uniform probability to graphs on @xmath1 labelled vertices with @xmath2 edges .",
    "a fundamental result of erds and rnyi @xcite is that the random graph @xmath0 undergoes an abrupt change when @xmath2 is around @xmath12 , the value for which the average vertex degree is equal to one .",
    "when @xmath13 and @xmath14 , almost surely the connected components are all of order @xmath15 , and are either trees or unicyclic graphs . when @xmath13 and @xmath16 , almost surely there is a unique giant component of size @xmath17 .",
    "we direct to reader to the reference texts @xcite and @xcite for a detailed discussion of these facts .",
    "we concentrate on the so - called critical window @xmath18 where @xmath7 is a real number , identified by the work of bollobs @xcite .",
    "let us recall that the excess of a connected graph is the number of edges minus the number of vertices .",
    "a connected graph is complex if it has positive excess . as @xmath19 ,",
    "complex components disappear and only trees and unicyclic components survive , and as @xmath20 , components with unbounded excess appear .",
    "a thorough analysis of the random graph in the critical window can be found in @xcite and  @xcite , which constitute our basic references .    for each fixed @xmath7 ,",
    "we denote the random graph @xmath21 by @xmath22 .",
    "the core @xmath23 of @xmath22 is obtained by repeatedly removing all vertices of degree one from @xmath22 . the kernel @xmath24 is obtained from @xmath23 by replacing all maximal paths of vertices of degree two by single edges . the graph @xmath22 satisfies almost surely several fundamental properties , that were established in  @xcite by a subtle simultaneous analysis of the @xmath0 and the @xmath25 models .    1 .",
    "the number of complex components is bounded .",
    "2 .   each complex component has size of order @xmath26 , and the largest suspended tree in each complex component has size of order @xmath26 .",
    "3 .   @xmath23 has size of order @xmath27 and maximum degree three , and the distance between two vertices of degree three in @xmath23 is of order @xmath27 .",
    "4 .   @xmath24 is a cubic ( 3-regular ) multigraph of bounded size .",
    "the key property for us is the last one .",
    "it implies that almost surely the components of @xmath22 are trees , unicyclic graphs , and those obtained from a cubic multigraph  @xmath28 by attaching rooted trees to the vertices of @xmath28 , and attaching ordered sequences of rooted trees to the edges of @xmath28 .",
    "some care is needed here , since the resulting graph may not be simple , but asymptotically this can be accounted for .",
    "it is clear that @xmath22 is planar if and only if the kernel @xmath24 is planar .",
    "then by counting planar cubic multigraphs it is possible to estimate the probability that @xmath22 is planar . to this end we use generating functions .",
    "the trees attached to @xmath24 are encoded by the generating function  @xmath29 of rooted trees , and complex analytic methods are used to estimated the coefficients of the corresponding series .",
    "this allows us to determine the exact probability @xmath8 in particular , we obtain @xmath9 .",
    "this approach was initiated in the seminal paper by flajolet , knuth and pittel @xcite , where the authors determined the threshold for the appearance of the first cycles in @xmath0 .",
    "a basic feature in @xcite is to estimate coefficients of large powers of generating functions using cauchy integrals and the saddle point method .",
    "this path was followed by janson , knuth , uczak and pittel  @xcite , obtaining a wealth of results on  @xmath22 .",
    "of particular importance for us is the determination in @xcite of the limiting probability that @xmath22 has given excess .",
    "the approach by uczak , pittel and wierman in  @xcite is more probabilistic and has as starting point the classical estimates by wright @xcite on the number of connected graphs with fixed excess .",
    "the range of these estimates was extended by bollobs @xcite and more recently the analysis was refined by flajolet , salvy and schaeffer  @xcite , by giving complete asymptotic expansions in terms of the airy function .",
    "the paper is organized as follows . in section [ sec : prelim ] we present the basic lemmas needed in the sequel . except for the proof of lemma  [ le : kernel ] ,",
    "the paper is self - contained .",
    "lemmas [ le : multigraph ] to [ le : airy ] are proved in @xcite with a different presentation ; for the sake of completeness and exposition we provide shorter and hopefully more accessible proofs . in section",
    "[ sec : cubic ] we compute the number of cubic planar multigraphs , suitably weighted , where we follow @xcite . in section [ sec : main ] we compute the exact probability that the random graph @xmath22 is planar as a function of @xmath7 .",
    "we generalize this result by determining the probability that @xmath22 belongs to a minor - closed class of graphs in several cases of interest .",
    "we close this introduction with a remark .",
    "the problem of 2-satisfiability presents a striking analogy with the random graph process .",
    "given @xmath1 boolean variables and a conjunctive formula of @xmath2 clauses , each involving two literals , the problem is to determine the probability that the formula is satisfiable when @xmath2 grows with @xmath1 .",
    "the threshold has been established at @xmath30 and the critical window is also of width @xmath26 ; see @xcite .",
    "however the exact probability of satisfiability when the number of clauses is @xmath31 has not been determined , and appears to be a more difficult problem .",
    "all graphs in this paper are labelled .",
    "the size of a graph is its number of vertices .",
    "a multigraph is a graph with loops and multiple edges allowed .",
    "we recall that the generating function @xmath29 of rooted trees satisfies @xmath32 using lagrange s inversion @xcite , one recovers the classical formula @xmath33 for the number of rooted labelled trees.the generating function for unrooted trees is @xmath34 this can be proved by integrating the relation @xmath35 , or more combinatorially using the dissimilarity theorem for trees @xcite .",
    "a graph is unicyclic if it is connected and has a unique cycle .",
    "unicyclic graphs can be seen as an undirected cycle of length at least three to which we attach a sequence of rooted trees . since the directed cycle construction corresponds algebraically to @xmath36 ( see @xcite ) , the generating function is @xmath37 graphs all whose components are unicyclic are given by the exponential formula : @xmath38    the following result , which is fundamental for us , is proved in ( * ? ? ?",
    "* theorem 4 ) by a careful analysis of the structure of complex components in @xmath22 .",
    "we say that a property @xmath39 holds asymptotically almost surely ( a.a.s . ) in @xmath0 if the probability that @xmath39 is satisfied tends to one as @xmath40 .",
    "recall that @xmath41 .",
    "[ le : kernel ] for each @xmath7 , the kernel of @xmath22 is a.a.s . a cubic multigraph .    given a cubic multigraph @xmath2 with @xmath42 loops , @xmath43 double edges and @xmath44 triple edges , define its weight   as @xmath45 this weight ( called the compensation factor in @xcite ) , has the following explanation .",
    "when we substitute edges of the kernel by sequences of rooted trees , a loop has two possible orientations that give raise to the same graph .",
    "a double ( triple ) edge can be permuted in two ( six ) ways , again producing the same graph . from now on , all multigraphs we consider are weighted , so that we omit the qualifier .",
    "the following lemma is proved in @xcite using a combination of guessing and recurrence relations .",
    "the next proof is already contained in ( * ? ? ? * chap .",
    "[ le : multigraph ] the number @xmath46 of cubic multigraphs with @xmath47 vertices is equal to @xmath48    a cubic multigraph can be modeled as a pairing of darts ( half - edges ) , 3 for each vertex , with a total of @xmath49 darts .",
    "the number of such pairings is @xmath50 .",
    "however , we have to divide by the number @xmath51 of ways of permuting each of the @xmath47 triples of darts .",
    "the weight takes care exactly of the number of times a cubic multigraph is produced in this process .    the next result is essentially proved in @xcite using several algebraic manipulations . here",
    "we present a concise proof .",
    "we denote by @xmath52a(z)$ ] the coefficient of @xmath53 in the power series @xmath54 .    [",
    "le : counting ] the number @xmath55 of simple graphs with @xmath1 vertices , @xmath2 edges and cubic kernel of size @xmath47 satisfies @xmath56 { u(z)^{n - m+ r } \\over ( n - m+r ) ! } \\ , e^{v(z ) }   { e_r \\over ( 2r ) ! } { t(z)^{2r } \\over ( 1-t(z))^{3r}}\\ ] ]    and @xmath57 { u(z)^{n - m+ r } \\over ( n - m+r ) ! } \\ , e^{v(z ) } { e_r \\over ( 2r ) ! } { t(z)^{8r } \\over ( 1-t(z))^{3r}}.\\ ] ]    such a graph is the union of a set of @xmath58 unrooted trees , a set of unicyclic graphs , and a cubic multigraph @xmath28 with a rooted tree attached to each vertex of @xmath28 and a sequence ( possibly empty ) of rooted trees attached to each edge of @xmath28 .",
    "let us see first that @xmath59 .",
    "indeed , the final excess of edges over vertices must be @xmath60 .",
    "each tree component contributes with excess  @xmath61 , each unicyclic component with excess @xmath4 , and @xmath28 ( together with the attached trees ) with excess @xmath62 .",
    "hence @xmath63    the first two factors @xmath64 and @xmath65 on the right - hand side of the inequalities encode the set of trees and unicyclic components .",
    "the last part encodes the kernel @xmath28 .",
    "it has  @xmath47 vertices and is labelled , hence the factor @xmath66 ; the weighting guarantees that each graph contributing towards @xmath55 is counted exactly once .",
    "the trees attached to the @xmath47 vertices give a factor @xmath67 .",
    "the sequences of trees attached to the @xmath68 edges give each a factor @xmath69 .",
    "however , this allows for the empty sequence and the resulting graph may not be simple , so we get only an upper bound . to guarantee that the final graph is simple",
    "we take sequences of length at least two , encoded by @xmath70 ( length one is enough for multiple edges of @xmath28 , but length two is needed for loops ) .",
    "since this misses some graphs , we get a lower bound .",
    "the following technical result is essentially lemma 3 from @xcite .",
    "we reprove it here for completeness in a simplified version tailored to our needs ( see also the proof of theorem 5 in @xcite ) .",
    "[ le : integral ] let @xmath71 .",
    "then for any fixed @xmath42 and integer @xmath72 we have @xmath73 \\frac{u(z)^{n - m+r}}{(n - m+r ) ! } \\frac{t(z)^{a}}{(1-t(z))^{3r } } \\ , e^{v(z ) } = \\sqrt{2 \\pi } a\\left(3r+{\\textstyle}\\frac{1}{2},\\lambda\\right )   \\left ( 1 + o\\left(\\frac{\\lambda^4}{n^{1/3}}\\right)\\right)\\ ] ] uniformly for @xmath74 , where @xmath75    the proof is based on relating the left - hand side of equation   to the integral representation of @xmath76 defined in  ( * ? ? ?",
    "* equation(10.7 ) ) : @xmath77 where @xmath78 is the polynomial @xmath79 and @xmath80 is a path in the complex plane that consists of the following three straight line segments : @xmath81 the constant term in the left - hand side of is estimated using stirling s formula , getting @xmath82 the coefficient of @xmath52 $ ] in equation   is estimated by means of a contour integral around @xmath83 , using the expressions of @xmath84 and @xmath85 in terms of @xmath29 : @xmath86 we make the change of variable @xmath87 , whose inverse is @xmath88 , and we obtain @xmath89 where the integrand is split into a smooth function @xmath90 and a large power involving @xmath91 the contour path in equation   should be such that @xmath92 . as remarked in  @xcite",
    "( see also  @xcite ) , the function @xmath93 satisfies @xmath94 .",
    "moreover , precisely at the critical value @xmath95 we also have @xmath96 .",
    "this triple zero shows up in the procedure used in @xcite when estimating ( [ cauchy ] ) for large  @xmath1 by means of the saddle - point method .",
    "notice that @xmath93 is singular at @xmath97 , due to the singularity at @xmath98 of @xmath29 .",
    "let @xmath99 , and let @xmath100 be the positive solution to @xmath101 this choice is necessary in order to get precise bounds for the tail estimates that appear using the saddle - point method .",
    "following the proof of  ( * ? ? ?",
    "* lemma 3 ) , we evaluate ( [ cauchy ] ) on the path @xmath102 , where @xmath103 runs from @xmath104 to @xmath105 .",
    "that is , @xmath106 the main contribution to the value of this integral comes from the vicinity of @xmath107 .",
    "the magnitude of @xmath108 depends on the real part @xmath109 .",
    "observe that @xmath110 decreases as @xmath111 increases , and that @xmath112 has its maximum on the circle @xmath102 when @xmath107 .",
    "we write @xmath113 . analyzing @xmath114",
    ", we have @xmath115 uniformly in any region such that @xmath116 . for the function @xmath117",
    ", we have @xmath118 if @xmath119 is the integrand of  ( [ cauchy ] ) , we have @xmath120 when @xmath121 . finally , @xmath122 where the error term has been derived from those already in  @xcite .",
    "the proof of the lemma is completed by multiplying  ( [ stirling ] ) and ( [ cauchy ] ) , and canceling equal terms .",
    "it is important to notice that in the previous lemma the final asymptotic estimate does _ not _ depend on the choice of @xmath42 .",
    "the next result is a direct consequence and can be found as formula ( 13.17 ) in @xcite .",
    "[ le : airy ] the limiting probability that the random graph @xmath22 has a cubic kernel of size @xmath47 is equal to @xmath123 where @xmath124 and @xmath125 is as in the previous lemma .    in particular , for @xmath126",
    "the limiting probability is @xmath127    using the notation of lemma [ le : counting ] , the probability for a given @xmath1 is by definition @xmath128 lemma [ le : counting ] gives upper and lower bounds for this probability , and using lemma [ le : integral ] we see that both bounds agree in the limit and are equal to @xmath129 thus proving the result .",
    "a key point is that the discrepancy between the factors @xmath67 and @xmath130 in the bounds for @xmath55 does not affect the limiting value of the probability .",
    "notice that if we replace the @xmath131 by the numbers @xmath132 arising by counting _",
    "cubic multigraphs , we obtain immediately the probability that @xmath22 has a cubic planar kernel of size  @xmath47 .",
    "since @xmath22 is planar if and only if its kernel is planar , we can use this fact to compute the probability of  @xmath22 being planar .",
    "but first we must compute @xmath132 .",
    "in this section we compute the numbers @xmath133 of cubic planar multigraphs of size @xmath47 .",
    "the associated generating function has been obtained recently by kang and uczak @xcite ( generalizing the enumeration of simple cubic graphs in @xcite ) , but their derivation contains some minor errors .",
    "they do not affect the correctness of @xcite , since the asymptotic estimates needed by the authors are still valid .",
    "however , for the computations that follow we need the exact values .",
    "the next result is from @xcite , with the corrections mentioned below .",
    "all multigraphs are weighted as in the previous section .",
    "[ le : cubic - planar ] let @xmath134 be the generating function of connected cubic planar multigraphs",
    ". then  @xmath134 is determined by the following system of equations : @xmath135    the generating functions @xmath136 and @xmath137 correspond to distinct families of edge - rooted cubic planar graphs , and @xmath138 is an algebraic function related to the enumeration of 3-connected cubic planar graphs ( dually , 3-connected triangulations ) .",
    "the corrections with respect to @xcite are the following . in the first equation",
    "a term @xmath139 has been removed . in the second and sixth equations",
    "we have replaced a term @xmath140 by @xmath141 . in the fourth equation",
    "we have removed a term @xmath142 . for the combinatorial interpretation of the various generating functions and the proof of the former equations we refer to @xcite .",
    "notice that eliminating @xmath138 from the last two equations we obtain a relation between @xmath143 and  @xmath137 .",
    "this relation can be used to obtain a single equation satisfied by @xmath143 , eliminating from the remaining equations .",
    "we reproduce it here in case the reader wishes to check our computations .",
    "@xmath144 the first terms are @xmath145 this allows us to compute @xmath146 and @xmath137 , hence also @xmath134 .",
    "the first coefficients of @xmath134 are as follows .",
    "@xmath147 using the set construction , the generating function @xmath148 for cubic planar multigraphs is then @xmath149 where @xmath133 is the number of planar cubic multigraphs with @xmath47 vertices .",
    "this coincides with the generating function for all cubic ( non - necessarily planar ) multigraphs up to the coefficient of  @xmath150 .",
    "the first discrepancy is in the coefficient of @xmath151 .",
    "the difference between the coefficients is @xmath152 , corresponding to the 10 possible ways of labelling @xmath153 , the unique non - planar cubic multigraph on six vertices .",
    "let @xmath154 be a graph with a cubic kernel @xmath28 .",
    "then clearly @xmath154 is planar if and only if @xmath28 is planar , and we can compute the probability that @xmath0 is planar by counting over all possible planar kernels .",
    "[ th : planar ] let @xmath155 be the number of cubic planar multigraphs with @xmath47 vertices .",
    "then the limiting probability that the random graph @xmath156 is planar is @xmath157 in particular , the limiting probability that @xmath158 is planar is @xmath159    the same analysis as in section [ sec : prelim ] shows that @xmath160 is the probability that the kernel is planar and has @xmath47 vertices . summing over all possible @xmath62 , we get the desired result .    as already mentioned , erds and rnyi @xcite conjectured that @xmath161 exists and @xmath162 .",
    "this was proved in @xcite , showing that @xmath163 exists for all @xmath7 and that @xmath164 .",
    "the bounds in @xcite for @xmath161 are @xmath165 obtained by considering connected cubic multigraphs with at most six vertices .",
    "we remark that stepanov @xcite showed that @xmath166 for @xmath167 ( without actually establishing the existence of the limiting probability ) . the function @xmath163 is plotted in figure 1 . as expected , @xmath163 is close to 1 when @xmath168 and close to 0 when @xmath169 .",
    "for instance , @xmath170 and @xmath171 .    besides planar graphs , one can consider other classes of graphs .",
    "let @xmath172 be a class of graphs closed under taking minors , that is , if @xmath173 is a minor of @xmath154 and @xmath174 , then @xmath175 . if @xmath176 are the excluded minors of @xmath172 , then we write @xmath177 .",
    "( by the celebrated theorem of robertson and seymour , the number of excluded minors is finite , but we do not need this deep result here ) .",
    "the following result generalizes the previous theorem .",
    "let @xmath178 and assume all the @xmath179 are 3-connected .",
    "let @xmath180 be the number of cubic multigraphs in @xmath172 with @xmath47 vertices .",
    "then the limiting probability that the random graph @xmath156 is in @xmath172 is @xmath181 in particular , the limiting probability that @xmath158 is in @xmath172 is @xmath182 moreover , for each @xmath7 we have @xmath183    if all the @xmath179 are 3-connected , then clearly a graph is in @xmath172 if and only its kernel is in @xmath172 .",
    "the probability @xmath184 is then computed as in theorem [ th : planar ] .",
    "it is positive since @xmath172 contains all trees and unicyclic graphs , which contribute with positive probability ( although tending to 0 as @xmath185 ) . to prove that it is less than one , let @xmath103 be the largest size of the excluded minors",
    "@xmath179 . by splitting vertices",
    "it is easy to construct cubic graphs containing @xmath186 as a minor , hence @xmath22 contains @xmath186 as a minor with positive probability ( alternatively , see the argument at the end of @xcite ) .",
    "it follows that @xmath187 .",
    "being planar and of being series - parallel are both plotted for @xmath188 $ ] .",
    "the function on top corresponds to the planar case . ]    in some cases of interest we are able to compute the numbers @xmath189 explicitly .",
    "let @xmath190 be the class of series - parallel graphs .",
    "the same system of equations as in lemma [ le : cubic - planar ] holds for series - parallel graphs with the difference that now @xmath191 ( this is due to the fact that there are no 3-connected series - parallel graphs ) . the generating function for cubic series - parallel multigraphs can be computed as @xmath192 for instance , @xmath193(g(z)-g_{\\rm sp}(z ) ) = { 1 \\over 24}$ ] , corresponding to the fact that @xmath194 is the only cubic multigraph with @xmath195 vertices which is not series - parallel .",
    "the limiting probability that @xmath196 is series - parallel is @xmath197 see figure 1 for a plot of @xmath198 .",
    "the class @xmath199 of outerplanar graphs does not fall directly under this scheme , since @xmath200 is not 3-connected , but adapting the equations in lemma [ le : cubic - planar ] ( in particular the parallel decomposition encoded by @xmath201 ) it is possible to enumerate exactly cubic outerplanar multigraphs .",
    "the first terms in the generating function are @xmath202 the first discrepancy with @xmath203 is at @xmath204 , corresponding to the graph @xmath200 with either a loop or a double edge attached at the vertices of degree two .",
    "the probability of being outerplanar is @xmath205 we do not plot @xmath206 in figure 1 since it is too close to @xmath198 to see a clear distinction .    as another example ,",
    "consider excluding @xmath153 .",
    "since the only 3-connected non - planar graph in @xmath207 is @xmath208 , which is not cubic , the limiting probability of being in this class is _ exactly _ the same as of being planar , although @xmath207 is exponentially larger than the class of planar graphs @xcite . but",
    "excluding the graph @xmath209 , obtained by adding one edge to @xmath153 , does increase the probability , since @xmath153 is in the class and is cubic and non - planar ( the probability is computable since the 3-connected graphs in @xmath210 are known @xcite ) .",
    "other classes such as @xmath211 or @xmath212 can be analyzed too using the results from @xcite .",
    "it would be interesting to compute the probability that @xmath22 has genus @xmath213 .",
    "for this we need to count cubic multigraphs of genus @xmath213 ( orientable or not ) .",
    "we only know how to do this for @xmath214 , the reason being that a 3-connected planar graph has a unique embedding in the sphere .",
    "this is not at all true in positive genus .",
    "it is true though that almost all 3-connected graphs of genus @xmath213 have a unique embedding in the surface of genus @xmath213 ( see @xcite )",
    ". this could be the starting point for the enumeration , by counting first 3-connected maps of genus @xmath213 ( a map is a graph equipped with a 2-cell embedding ) .",
    "but this is not enough here , since we need the _ exact _ numbers of graphs .",
    "the first and third authors acknowledge the warm hospitality and support from the laboratoire dinformatique algorithmique : fondements et applications ( liafa ) in paris , where much of this work was done ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be the uniform random graph with @xmath1 vertices and @xmath2 edges . </S>",
    "<S> erds and rnyi ( 1960 ) conjectured that the limiting probability @xmath3 exists and is a constant strictly between @xmath4 and @xmath5 . </S>",
    "<S> uczak , pittel and wierman ( 1994 ) proved this conjecture and janson , uczak , knuth and pittel ( 1993 ) gave lower and upper bounds for this probability . in this paper </S>",
    "<S> we determine the exact limiting probability of a random graph being planar near the critical point @xmath6 . for each @xmath7 </S>",
    "<S> , we find an exact analytic expression for @xmath8 in particular , we obtain @xmath9 . </S>",
    "<S> we extend these results to classes of graphs closed under taking minors . as an example </S>",
    "<S> , we show that the probability of @xmath10 being series - parallel converges to @xmath11 . for the sake of completeness and exposition we reprove in a concise way several basic properties we need of a random graph near the critical point .    </S>",
    "<S> _ we dedicate this paper to the memory of philippe flajolet . _ </S>"
  ]
}