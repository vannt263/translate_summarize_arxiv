{
  "article_text": [
    "the main purpose of this paper is to study an extension of the dirac theory of constraints ( @xcite ) and the gotay - nester theory ( @xcite ) for the case in which the equation of motion is a dirac dynamical system on a manifold @xmath0 , @xmath1 where @xmath2 is a given _",
    "integrable _ dirac structure on @xmath0 , which gives a foliation of @xmath0 by presymplectic leaves , and @xmath3 is a given function on @xmath0 , called the _ energy_.",
    "one of the features of systems like ( [ 11drracds ] ) is that they can represent some constrained systems where the constraints appear even if the lagrangian is nonsingular , as it happens in the case of integrable nonholonomic systems .",
    "we will work under explicit hypotheses about regularity , locality and integrability , although some of our results can be applied in more general cases , as indicated in the paragraph _",
    "hypotheses _ , below in this section .    in the gotay - nester theory",
    "the starting point is an equation of the form @xmath4 where @xmath5 is a presymplectic form on @xmath0 .",
    "in fact , in the gotay - nester theory the more general case where @xmath6 is replaced by an arbitrary closed 1-form @xmath7 is considered , but this will not be relevant here .",
    "[ [ example - euler - lagrange - and - hamiltons - equations . ] ] example : euler - lagrange and hamilton s equations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath8 be a lagrangian , degenerate or not .",
    "let @xmath9 and let @xmath10 be the presymplectic form @xmath11 on the pontryagin bundle @xmath12 .",
    "then the euler - lagrange equations are written equivalently in the form of equation ( [ 11gn ] ) with @xmath13 .",
    "in fact , we have , in local coordinates , @xmath14 using equations ( [ e - l])([e - l2 ] ) we can easily see that ( [ 11gn ] ) becomes @xmath15 which is clearly equivalent to the euler - lagrange equations . the case @xmath16 , where @xmath17 is a given hamiltonian on @xmath18 of course gives hamilton s equations .",
    "the idea of using the pontryagin bundle to write such fundamental equations of physics appears in",
    ". + equation ( [ 11gn ] ) is equivalent to equation ( [ 11drracds ] ) in the case in which the dirac structure on @xmath0 is the one naturally associated to @xmath5 , denoted @xmath19 , in which case the foliation of @xmath0 has obviously only one presymplectic leaf . in general , equation ( [ 11drracds ] ) may be considered as a collection of equations of the type ( [ 11gn ] ) , one for each presymplectic leaf of the dirac structure .",
    "however , in order to study the initial condition problem this approach might not be appropriate , because different initial conditions might belong to different presymplectic leaves and therefore correspond to different equations of the type ( [ 11gn ] ) , which is not the usual situation .",
    "the algorithm of the gotay - nester theory generates a finite sequence of secondary constraint submanifolds @xmath20 .",
    "the final constraint submanifold @xmath21 has the property that every solution curve of ( [ 11gn ] ) is contained in @xmath21 ( in fact",
    ", it is the smallest submanifold having that property ) . equations of motion are given by restricting the variable @xmath22 in equation ( [ 11gn ] ) to @xmath23 , and existence of solution curves @xmath24 for a given initial condition @xmath25 is guaranteed , under the condition that the kernel of @xmath26 has locally constant dimension .",
    "an important point in the gotay - nester approach is that the equations defining the secondary constraint submanifolds are written in terms of @xmath5 ( see formula ) , which makes the whole algorithm invariant under a group of transformations preserving @xmath5 .    in order to solve",
    ", we will develop a constraint algorithm that we call cad ( _ constraint algorithm for dirac dynamical systems _ ) .",
    "the cad extends the gotay - nester algorithm and gives a sequence of secondary foliated constraint submanifolds .",
    "the secondary foliated constraint submanifolds can be written in terms of the dirac structure using formula , which generalizes .",
    "let @xmath27 be an embedding of @xmath0 into a symplectic manifold @xmath28 , in such a way that the presymplectic leaves of @xmath0 are presymplectic submanifolds of @xmath29 and let , by slight abuse of notation , @xmath30 denote an arbitrary extension of the given energy on @xmath0 .",
    "this kind of framework can be naturally constructed in many examples .",
    "then one can consider , at least locally , that @xmath0 is a primary foliated constraint submanifold defined by equating certain constraints to @xmath31 , which generalizes the situation of the dirac theory of constraints .",
    "one of the results of this paper establishes that there exists a dirac bracket whose symplectic leaves are _ adapted _ to the foliations of the primary and final foliated constraint submanifolds .",
    "we also prove that the equations of motion on the final foliated constraint submanifold can be nicely written in hamiltonian form with respect to this dirac bracket and the _ abridged total energy _ , which we introduce in section [ subsectionequationsof motion ] .",
    "our extension of the gotay - nester and dirac theories has especially simple and interesting features when applied to lc circuits .",
    "we show that the algorithm stops either at @xmath32 or @xmath33 , and concrete physically meaningful formulas for the first three constraint submanifolds and for the evolution equations can be given for this case .",
    "other geometric treatments of lc circuits can be found , for instance , in @xcite .",
    "systems of the type ( [ 11drracds ] ) are important also in the not necessarily integrable case since they represent , for instance , the lagrange - dalembert equations of nonholonomic mechanics .",
    "more references will be given in section [ subsectiondiracdynamicalsystems ] .",
    "we remark that even though the main focus of this paper is the case where the dirac structure is integrable , many results , most notably the constraint algorithm cad and the treatment of nonholonomic systems in section [ sectionconstalgforrdirac ] , are proven for a not necessarily integrable dirac structure .",
    "+ gotay - nester s theory is more geometric than dirac s and provides a certain notion of duality or correspondence between the two , in the spirit of the dualities between submanifolds and the equations defining them , manifolds and their ring of functions , hamiltonian vector fields and their hamiltonian or poisson brackets and the collection of their symplectic leaves .",
    "emphasizing this point of view in a common geometric language and showing that a combination of results from both theories may have advantages in a given example , rather than using one or the other , is an aspect of the paper .    from this point of view , the notion of second class constraints is related to the notion of second class constraint submanifold , the latter being determined in this paper as a submanifold that is tangent to a second class subbundle of a certain tangent bundle .",
    "they are symplectic submanifolds ( @xcite ) .",
    "the first class constraint submanifolds are coisotropic submanifolds ( @xcite ) .",
    "the presence of primary and secondary first class constraints , which in dirac s work is connected to the principle of determinacy and to the notion of physical variables , is explicitly related here to certain manifolds @xmath34 and @xmath35 in a commutative diagram , in theorem [ lemmmma ] .",
    "the diagonal arrow in this diagram , which is a submersion , is dual to the diagonal arrow in the diagram in lemma [ lemalema ] , which is a surjective poisson algebra homomorphism . in some examples , instead of applying the dirac method to write equations of motion , it may be simpler to proceed in two stages .",
    "first apply the gotay - nester algorithm to find the final constraint submanifold , which , as proven in the gotay - nester theory , coincides with the submanifold defined by equating the final constraints obtained in the dirac algorithm to @xmath31 . then switch to the dirac viewpoint and",
    "write equations of motion using the dirac bracket . also , in order to calculate the dirac bracket at points of the final constraint submanifold , using the symplectic leaf that contains that submanifold may be easier than using dirac s expression .",
    "[ [ the - point - of - view - of - ides . ] ] the point of view of ides .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + +    in order to study the problem of finding solution curves of general dirac dynamical systems ( [ 11drracds ] ) the more general theory of _ implicit differential equations _ may be useful .",
    "an implicit differential equation ( ide ) on a manifold @xmath0 is written as @xmath36 a solution of ( [ defsolide ] ) _ at a point _",
    "@xmath37 is a vector @xmath38 satisfying ( [ defsolide ] ) .",
    "solution curve _ , say @xmath24 , @xmath39 , must satisfy , by definition , that @xmath40 is a solution at @xmath24 for all @xmath39 .",
    "basic questions such as existence , uniqueness or extension of solutions for a given initial condition are not completely answered yet , although many partial results have been established for certain classes of ide .",
    "one approach is to use a _ constraint algorithm _ , which consists of a decreasing sequence of constraint submanifolds @xmath41 defined as follows , @xmath42 with @xmath43 .",
    "this algorithm , which obviously uses only the differentiable structure regardless of any other structure which may be present , like presymplectic , poisson or dirac structures , represents a differential geometric aspect underlying the algorithms of gotay - nester , dirac or cad . to ensure that each @xmath44 is a submanifold and that the algorithm stops after a finite number of steps one may choose to assume certain conditions of the type `` locally constant rank '' conditions . then the original ide is reduced to an equivalent ode depending on parameters on the _ final constraint submanifold _ @xmath21 . in fact , by construction , @xmath21 is characterized by the property that it is the smallest submanifold that contains all solutions curves of the given ide . therefore , if @xmath21 is empty , there are no solution curves .",
    "dirac s original work has a wide perspective from the physical point of view , with connections to classical , quantum and relativistic mechanics .",
    "however , from the point of view of abstract ide theory , and in a very concise way , we may say that a combination of the dirac and the gotay - nester methods shows how to transform a given gotay - nester equation ( [ 11gn ] ) into an equivalent ode depending on parameters ( [ eq_dirac_evolution_thm ] ) on a final constraint submanifold , while what we show in this paper is how to transform a given dirac dynamical system ( [ 11drracds ] ) into an equivalent ode ( [ eq : vector_field_foliated ] ) depending on parameters on a final foliated constraint submanifold .",
    "some more comments on the connection between dirac s and gotay - nester ideas and ide are in order .",
    "we can compare , to see how the idea of applying a constraint algorithm works in different contexts . in @xcite ,",
    "one works in the realm of subanalytic sets ; in @xcite and @xcite one works with presymplectic manifolds ; in @xcite one works with complex algebraic manifolds ; @xcite uses poisson brackets ; in @xcite some degree of differentiability of the basic data is assumed , and , besides , some constant rank hypotheses are added , essentially to ensure applicability of a certain constant rank theorem",
    ". some relevant references for general ides connected to physics or control theory , which show a diversity of geometric or analytic methods or a combination of both are .",
    "[ [ hypotheses . ] ] hypotheses .",
    "+ + + + + + + + + + +    as for regularity , we will work in the @xmath45 category . throughout the paper",
    "we assume that the subsets @xmath44 appearing in sequences of the type @xmath46 that are generated by some constraint algorithm , are submanifolds regularly defined by equating some functions ( constraints ) to @xmath31 , and that the sequence stops .",
    "more regularity conditions like assumptions [ k1 ] , [ k2 ] , [ lambda ] , [ 2s_constant ] , [ assumptionfoliation ] , and some others will be introduced when needed along the paper .",
    "our results will be of a local character , but for some of them , like the notion of second class submanifolds , it is indicated how to define them globally .",
    "the usage of local coordinates is almost entirely avoided and basic facts in symplectic geometry or poisson algebra arguments are used instead .",
    "the condition of integrability of the dirac structure appearing in ( [ 11drracds ] ) has its own interest .",
    "however , the cad does not assumes integrability and can be applied for instance to general nonholonomic systems . on the other hand , in the non - integrable case certain brackets that we study would not satisfy the jacobi identity , and",
    "will not be studied in this paper .",
    "[ [ structure - of - the - paper . ] ] structure of the paper .",
    "+ + + + + + + + + + + + + + + + + + + + + + +    the first part of the paper , which includes sections [ section7 ] and [ mainresultsofdiracandgotaynester ] , contains a review of the dirac and gotay - nester methods .    in sections [ sectiondiracstructures ] to [ sectionanextensionofetc ]",
    "we develop our main results , extending the gotay - nester and dirac theories .",
    "section [ sectiondiracstructures ] is devoted to a review of basic facts on dirac structures and dirac dynamical systems ( @xcite ) .",
    "the notion of dirac structure ( @xcite ) gives a new possibility of understanding and extending the theory of constraints , which is the main purpose of the present paper . in section [ sectionconstalgforrdirac ]",
    "we develop our cad algorithm .",
    "we do it for the general case of a not necessarily integrable dirac structure so that one can apply cad to general noholonomic systems . in section [ sectionexamples ]",
    "we study the example of integrable nonholonomic systems , and lc circuits are viewed as a particular case . in section [ sectionanextensionofetc ]",
    "we show how to extend the dirac theory for the case of a dirac dynamical system ( [ 11drracds ] ) .",
    "in this section we review , without proof , basic facts belonging to the dirac and the gotay - nester theories .",
    "the dirac method starts with a given submanifold @xmath0 , called the primary constraint submanifold , of a symplectic manifold @xmath28 defined by equating the primary constraints to @xmath31 , and a given energy @xmath30 . in the original work of dirac @xmath47",
    ", @xmath48 is the canonical symplectic form , @xmath0 is the image of the legendre transformation and @xmath3 is the hamiltonian defined by dirac .",
    "however , locally , any symplectic manifold is an open subset of a cotangent bundle , therefore the original dirac formalism can be applied to the , seemingly more general , case described above , at least for the local theory .",
    "+ an interesting variant of the original situation considered by dirac is the following .",
    "consider the canonical symplectic manifold @xmath49 with the canonical symplectic form @xmath48 , and let the primary constraint be @xmath50 , canonically embedded in @xmath29 via the map given in local coordinates @xmath51 of @xmath29 by @xmath52 .",
    "in particular , @xmath0 is defined regularly by the equation @xmath53 .",
    "if @xmath5 is the presymplectic form on @xmath0 obtained by pulling back the canonical symplectic form of @xmath18 using the natural projection , then one can show that @xmath54 .",
    "the embedding @xmath55 is globally defined ( see appendix [ pontryagin_embedding ] for details ) .",
    "the number @xmath56 is a well - defined function on @xmath0 and it can be naturally extended to a function on a chart with coordinates @xmath51 , but this does not define a global function on @xmath29 consistently . on the other hand , it can be extended to a smooth function on @xmath29 using partitions of unity and any such extension will give consistent equations of motion . in this paper",
    "we will not consider global aspects . in any case , for a given lagrangian @xmath57 we can take @xmath58 .",
    "for a given presymplectic manifold @xmath59 one can always find an embedding @xmath55 into a symplectic manifold @xmath60 such that @xmath54 .",
    "moreover , this embedding can also be chosen such that it is coisotropic , meaning that @xmath61 is a coisotropic submanifold of @xmath62 ( see @xcite ) .",
    "however , we should mention that the embedding given above is not coisotropic .",
    "the dirac and the gotay - nester algorithms can be studied independently . on the other hand",
    ", they are related as follows . for a given system ( [ 11gn ] ) choose a symplectic manifold @xmath28 in such a way that @xmath63 is a presymplectic submanifold and @xmath3 ( using a slight abuse of notation ) is an arbitrary extension of @xmath64 to @xmath29 .",
    "moreover , assume that @xmath0 is defined regularly by a finite set of equations @xmath65 , @xmath66 , where each @xmath67 is a",
    "_ primary constraint_. the dirac algorithm gives a sequence of secondary constraints @xmath68 , @xmath69 , which defines regularly a sequence of secondary constraint submanifolds @xmath44 , @xmath70 , by equations @xmath71 , @xmath69 , which coincide with the ones given in the gotay - nester algorithm .",
    "dirac s theory of constraints has been extensively studied from many different points of view and extended in several directions .",
    "part of those developments in the spirit of geometric mechanics is contained in the following references , but the list is far from being complete , .",
    "as we have explained above we will work in a general context of a given symplectic manifold @xmath28 , @xmath27 and @xmath72 , where the primary constraint submanifold @xmath0 is regularly defined by equations @xmath65 , @xmath73 on @xmath29 .",
    "the dirac constraint algorithm goes as follows .",
    "one defines the _ total energy _",
    "the preservation of the primary constraints is written @xmath75 , @xmath73 , @xmath76 , or @xmath77 then @xmath32 is defined by the condition that @xmath78 if and only if there exists @xmath79 such that the system of equations @xmath80 , @xmath75 , @xmath73 , is satisfied . the submanifold @xmath32 is defined by equations @xmath81 , @xmath82 , where each @xmath83 is a _ secondary constraint _ , by definition . by proceeding iteratively one obtains a sequence @xmath84 .",
    "then there are _ final constraints _ , say @xmath85 , @xmath86 , defining a submanifold @xmath21 by equations @xmath87 , @xmath86 , called the _ final constraint submanifold _ , and the following condition is satisfied : for each @xmath88 there exists @xmath89 such that @xmath90 for each @xmath88 the space of solutions of the linear system of equations ( [ equationequationforlambda ] ) in the unknowns @xmath91 is an affine subspace of @xmath92 , called @xmath93 , whose dimension is a locally constant function @xmath94 .",
    "one can locally choose @xmath95 unknowns as being free parameters and the rest will depend affinely on them",
    ". then the solutions of ( [ equationequationforlambda ] ) form an affine bundle @xmath96 over @xmath21 .",
    "after replacing @xmath97 in the expression of the total energy , the corresponding hamiltonian vector field , @xmath98 @xmath88 , which will depend on the free unknowns , will be tangent to @xmath21 .",
    "its integral curves , for an arbitrary choice of a time dependence of the free unknowns , will be solutions of the equations of motion , which is the main property of the final constraint submanifold @xmath21 from the point of view of classical mechanics .",
    "the lack of uniqueness of solution for a given initial condition in @xmath21 , given by the presence of free parameters , indicates , according to dirac , the nonphysical character of some of the variables . in our context the physical variables will be given a geometric meaning .",
    "dirac introduces the notion of weak equality for functions on @xmath99 .",
    "two such functions are _ weakly equal",
    "_ , denoted @xmath100 , if @xmath101 .",
    "then , for instance @xmath102 . if @xmath103 then @xmath104 , for some functions @xmath105 on @xmath99 and conversely .",
    "since we use the notion of a constraint submanifold , in particular the final constraint submanifold , we prefer not to use the notation @xmath106 .",
    "now let us make some comments on the notions of first class and second class constraints .",
    "the rank of the skew - symmetric matrix @xmath107 is necessarily even , say , @xmath108 , and it is assumed to be constant on @xmath21 , as part of our regularity conditions ; for our results we will assume later a stronger condition ( assumption [ 2s_constant ] ) .",
    "one can choose , among the @xmath85 , @xmath86 , @xmath108 functions @xmath109 , @xmath110 , and replace the rest of the @xmath85 by @xmath111 with appropriate functions @xmath112 in such a way that @xmath113 , @xmath114 , define @xmath21 regularly and , besides , @xmath115 , @xmath116 , @xmath117 , for @xmath118 , @xmath119 and @xmath88 .",
    "the @xmath120 are linear combinations with smooth coefficients of the @xmath109 and @xmath121 , and conversely .",
    "the functions @xmath109 , @xmath110 , are called _ second class constraints _ and the functions @xmath121 , @xmath122 , are called _ first class constraints_.    more generally , any function @xmath123 on @xmath99 satisfying @xmath124 , @xmath125 , @xmath126 , is a first class constraint with respect to the submanifold @xmath21 , by definition .",
    "any function @xmath127 on @xmath99 satisfying @xmath128 , @xmath129 , is a _",
    "first class function _ , by definition .",
    "for instance , the total energy @xmath130 is a first class function .",
    "now define the energy @xmath131 in terms of @xmath121 , @xmath109 , @xmath132 , @xmath110 , as @xmath133 the preservation of the constraints for the evolution generated by @xmath131 can be rewritten as @xmath134 , which is equivalent to @xmath135 for all @xmath88 , and @xmath136 , for all @xmath88 .",
    "the latter is equivalent to @xmath137 for all @xmath88 , which determines the @xmath138 as well - defined functions on @xmath21 .",
    "then the solutions @xmath139 form an affine bundle with base @xmath21 and whose fiber , parametrized by the free parameters @xmath140 , has dimension @xmath141 .",
    "any section @xmath142 of this bundle determines @xmath131 as a first class function .",
    "this means that @xmath143 , for each @xmath88 , and therefore a solution curve of @xmath144 is contained in @xmath21 provided that the initial condition belongs to @xmath21 .",
    "the function @xmath131 is essentially the _ extended hamiltonian _ defined by dirac .",
    "dirac defines an interesting bracket , now called the _ dirac bracket _ ,",
    "@xmath145 which is defined on an open set in @xmath99 containing @xmath21 , where @xmath146 , which by definition is the inverse matrix of @xmath147 , is defined .",
    "the dirac bracket is a poisson bracket and has the important property that for _ any _ function @xmath148 on @xmath99 , the condition @xmath149 , @xmath110 , is satisfied on a neighborhood of @xmath21 , which implies that @xmath150 , for any function @xmath148 .",
    "besides , @xmath151 , @xmath152 , on @xmath21 .",
    "because of this , one may say that , with respect to the dirac bracket , all the constraints @xmath109 , @xmath110 and @xmath121 , @xmath132 , behave like first class constraints , with respect to @xmath21 .",
    "we will need just a few basic facts from the gotay - nester theory .    in order to find solution curves to ( [ 11gn ] )",
    "we can apply the general algorithm for ides described in the introduction , and the final ide can be written @xmath153    let @xmath154 be the pullback of @xmath5 to @xmath21 . if @xmath154 is symplectic , one obtains the simpler equivalent equation @xmath155 on @xmath21 , which is in hamiltonian form .",
    "however , one must be aware that if @xmath154 is degenerate then ( [ eq : ham_form_sympl_omegac ] ) is not equivalent in general to ( [ gngnfinal ] ) .",
    "the equation on @xmath21 , @xmath156 where @xmath157 , defines an affine distribution on @xmath21 , more precisely , one has an affine bundle @xmath158 with base @xmath21 whose fiber @xmath159 at a given point @xmath88 is , by definition , @xmath160    the equivalence between the dirac and the gotay - nester algorithms can be made explicit as an isomorphism of affine bundles , as follows .",
    "the affine bundles @xmath161 and @xmath162 are isomorphic over the identity on @xmath21 , more precisely , the isomorphism @xmath163 is given by @xmath164 , using equation ( [ x_dirac_classical ] ) . in particular , the rank of @xmath158 is @xmath165 .",
    "[ [ describing - the - secondary - constraints - using - omega . ] ] describing the secondary constraints using @xmath5 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the constraint manifolds @xmath44 defined by the algorithm can be described by _",
    "equations written in terms of the presymplectic form _",
    "@xmath5 , which is a simple but important idea , because those equations will obviously be invariant under changes of coordinates preserving @xmath5 . depending on the nature of @xmath5 one",
    "may obtain analytic , smooth , linear , etc",
    ". , equations , which may simplify matters in given examples .",
    "the context of reflexive banach manifolds is used in @xcite and @xcite .",
    "the condition defining the subsets @xmath166 , @xmath167 namely , @xmath168 is equivalent to @xmath169 or , since @xmath170 , @xmath171",
    "in this section we will describe some results on first class and second class constraints and constraint submanifolds and also equations of motion which will be useful for our extension of those notions , to be developed in section  [ sectionanextensionofetc ] .",
    "the following results about linear symplectic geometry are an essential part of many of the arguments that we use in the paper , since under our strong regularity assumptions many of them are essentially of a linear character .",
    "[ lemma6.1 ] let @xmath172 be a symplectic vector space of dimension @xmath173 , @xmath174 a given subspace .",
    "for a given basis @xmath175 , @xmath176 of @xmath177 , let @xmath178 .",
    "then the rank of the matrix @xmath179 $ ] is even , say @xmath108 , and @xmath180 form a basis of @xmath181 . moreover , the basis @xmath182 can be chosen such that for all @xmath183 @xmath184    consider the subspace @xmath185 . by a well - known result",
    "there is a basis @xmath186 of @xmath187 such that for all @xmath183 @xmath188 then take @xmath189 .",
    "the first part of the lemma is easy to prove using this .",
    "[ lemma6.2 ] let @xmath175 , @xmath190 be a basis of @xmath177 having the properties stated in lemma [ lemma6.1 ]",
    ". then @xmath191 , @xmath192 form a basis of @xmath193 .",
    "let @xmath194 be an arbitrary vector in @xmath187 .",
    "now @xmath195 iff @xmath196 .",
    "since the first @xmath108 columns of the matrix @xmath179 $ ] are linearly independent and the rest are zero , we must have @xmath197 , for @xmath198 , and @xmath199 , @xmath200 are arbitrary .",
    "this means that @xmath193 is generated by @xmath191 , @xmath200 .",
    "[ cordim ] @xmath201 .",
    "immediate from lemma [ lemma6.2 ] .",
    "let @xmath5 be the pullback of @xmath48 to @xmath202 via the inclusion .",
    "then @xmath203 is a presymplectic space . in what follows ,",
    "the @xmath204 and @xmath205 operators are taken with respect to @xmath48 unless specified otherwise .",
    "[ lemmaperp ] @xmath206 .",
    "@xmath207 iff @xmath208 iff @xmath209 .",
    "this is equivalent to @xmath210 .",
    "[ lemma6.5 ]",
    "let @xmath211 be a given basis of @xmath177 and let @xmath212 .",
    "let @xmath213 be given .",
    "then the following conditions are equivalent .",
    "* @xmath214 . *",
    "the linear system @xmath215 has solution @xmath216 .",
    "let us show that ( [ linsyst ] ) has solution @xmath217 iff the system @xmath218 has solution @xmath219 , where @xmath220 and @xmath221 is a basis satisfying the conditions of lemma [ lemma6.1 ] . since @xmath222 and @xmath223 are both bases of @xmath187 there is an invertible matrix @xmath224 $ ] such that @xmath225 .",
    "let @xmath226 $ ] be the inverse of @xmath224 $ ] , so @xmath227 .",
    "assume that ( [ linsyst ] ) has solution @xmath228 .",
    "we can write ( [ linsyst ] ) as @xmath229 using this we have that for @xmath230 @xmath231 where @xmath232 .",
    "this means that the system ( [ linsyst2 ] ) has solution .",
    "the converse is analogous . using this , lemmas [ lemma6.2 ] and [ lemmaperp ] , and the form of the coefficient matrix @xmath233 $ ] in lemma [ lemma6.1 ] , the proof that ( [ linsyst2 ] ) has solution @xmath234 iff @xmath235 is easy and is left to the reader .",
    "[ lemma6.6 ] consider the hypotheses in lemma [ lemma6.5 ] .",
    "then the solutions to @xmath236 ( if any ) are precisely @xmath237 , where @xmath217 is a solution to ( [ linsyst ] ) .",
    "a solution to ( [ presymplecticsharp ] ) exists if and only if @xmath235 .",
    "if @xmath5 is symplectic then ( [ linsyst ] ) and ( [ presymplecticsharp ] ) have a unique solution and if , in addition , @xmath238 , then @xmath239 ,  , @xmath240 and @xmath241 coincides with @xmath242 defined by ( [ presymplecticsharp ] ) .    since @xmath243 , @xmath244 form a basis of @xmath187 we have that @xmath245 is a solution to ( [ linsyst ] ) iff @xmath246 iff @xmath247 iff @xmath248 .",
    "now , let @xmath249 , where @xmath217 satisfies ( [ linsyst ] ) .",
    "then we have @xmath250 as we have just seen and we also have @xmath251 since @xmath252 generate @xmath253 .",
    "we have proven that @xmath254 is a solution to ( [ presymplecticsharp ] ) . to prove that every solution @xmath254 to ( [ presymplecticsharp ] ) can be written as before",
    ", we can reverse the previous argument . using this ,",
    "it is clear that if @xmath5 is symplectic then ( [ linsyst ] ) has unique solution , in particular , we have that @xmath255 . if , in addition , @xmath238 then @xmath256 .",
    "since @xmath243 , @xmath257 is a basis of @xmath187 , using lemma [ lemmaperp ] and the fact that @xmath258 we get that @xmath259 for @xmath257 .",
    "[ corollary6.7 ] let @xmath260 .",
    "then @xmath261 .",
    "@xmath262 , which has dimension @xmath263 from corollary [ cordim ] and lemma [ lemmaperp ] . on the other hand",
    "the dimension of the subspace of @xmath140 satisfying ( [ linsyst ] ) is clearly also @xmath263 , since the coefficient matrix has rank @xmath108 .",
    "we shall start with the constrained hamiltonian system @xmath264 , where @xmath28 is a symplectic manifold , @xmath30 is the energy and @xmath27 is the primary constraint submanifold .",
    "the equation to be solved , according to the gotay - nester algorithm , is @xmath265 where @xmath266 and @xmath88 , @xmath21 being _ the final constraint .",
    "_ let @xmath154 be the pullback of @xmath48 via the inclusion of @xmath21 in @xmath29 .",
    "since @xmath154 is presymplectic , @xmath267 is an involutive distribution . from now on we will assume the following .",
    "[ k1 ] the distribution @xmath267 has constant rank and defines a regular foliation @xmath268 , that is , the natural map @xmath269 , where @xmath270 is a submersion .",
    "[ lemma7.1 ] the following assertions hold :    * ( a ) * there is a uniquely defined symplectic form @xmath271 on @xmath272 such that @xmath273 .    *",
    "( b ) * let @xmath274 be a given vector field on @xmath272 . then there is a vector field @xmath254 on @xmath21 that is @xmath275-related to @xmath274 .    * ( c ) * let @xmath276 .",
    "then there exists a vector field @xmath254 on @xmath21 such that @xmath254 is @xmath275-related to @xmath277 , and for any such vector field @xmath254 the equality @xmath278 holds for all @xmath279 .    *",
    "( d ) * let @xmath280 . then one can choose the function @xmath281 and the vector field @xmath254 in * ( c ) * in such a way that @xmath282 .    *",
    "( a ) * by definition , the leaves of the foliation @xmath268 are connected submanifolds of @xmath21 , that is , each @xmath283 , @xmath284 , is connected . for @xmath284 ,",
    "let @xmath88 such that @xmath285 . for @xmath286 , as @xmath275 is a submersion , there are @xmath287 such that @xmath288 .",
    "we define @xmath289 . to prove that this is a good definition observe first that it is a consistent definition for fixed @xmath37 , which is easy to prove , using the fact that @xmath290 .",
    "now choose a darboux chart centered at @xmath37 , say @xmath291 , such that , in this chart , @xmath292 and @xmath293 , where @xmath294 and @xmath295 are independent of @xmath296 .",
    "this shows that @xmath297 is well defined on the chart . using this and the fact that one can cover the connected submanifold @xmath283 with charts",
    "as explained above , one can deduce by a simple argument that @xmath298 is well defined .    *",
    "( b ) * let @xmath127 be a riemannian metric on @xmath21 . then for each @xmath88 there is a uniquely determined @xmath299 such that @xmath300 is orthogonal to @xmath301 and @xmath302 , for all @xmath88 .",
    "this defines a vector field @xmath254 on @xmath21 which is @xmath275-related to @xmath274 .",
    "* ( c ) * given @xmath303 and using the result of * ( b ) * we see that there is a vector field @xmath254 on @xmath21 that is @xmath275-related to @xmath277",
    ". then , for every @xmath88 and every @xmath304 , @xmath305    * ( d ) * one can proceed as in * ( b ) * and * ( c ) * , choosing @xmath303 such that @xmath306 and , besides , the metric @xmath127 such that @xmath307 is perpendicular to @xmath308 .",
    "[ definitionfirstclassconstr ] * ( a ) * for any subspace @xmath309 define the distribution @xmath310 by @xmath311 .    *",
    "( b ) * the space of * _ first class functions _ * is defined as @xmath312 in other words , @xmath313 is the largest subset of @xmath314 satisfying @xmath315 @xmath88 .",
    "dirac was interested in classical mechanics , where states are represented by points in phase space , as well as in quantum mechanics where this is not the case .",
    "from the point of view of classical mechanics , among the constraint submanifolds and constraints the only ones that seem to play an important role are @xmath0 , @xmath21 and the constraints @xmath67 , @xmath85 defining them by equations @xmath65 , @xmath87 , respectively .",
    "[ lemmai6 ] * ( a ) * @xmath313 is a poisson subalgebra of @xmath316 .    *",
    "( b ) * @xmath21 is an integral submanifold of @xmath317 .",
    "moreover , for any vector field @xmath254 on @xmath21 that is @xmath275-related to a vector field @xmath277 on @xmath318 there exists a function @xmath319 such that @xmath320 and @xmath321 .",
    "in particular , any vector field @xmath254 on @xmath21 satisfying @xmath322 for all @xmath88",
    "is @xmath275-related to the vector field @xmath31 on the symplectic manifold @xmath318 , which is associated to the function @xmath323 , therefore there exists a function @xmath324 , which satisfies @xmath325 , such that @xmath326 , @xmath88 .    *",
    "( a ) * let @xmath327 .",
    "then @xmath328 and @xmath329 are both tangent to @xmath21 at points @xmath37 of @xmath21 which implies that @xmath330(x)$ ] is also tangent to @xmath21 at points of @xmath37 of @xmath21 .",
    "this shows that @xmath331 .",
    "it is easy to see that any linear combination of @xmath332 and also @xmath333 belong to @xmath313 .    *",
    "( b ) * by definition @xmath334 .",
    "we need to show the converse inclusion .",
    "let @xmath335 , we need to find @xmath336 such that @xmath337 .",
    "choose the function @xmath303 and the vector field @xmath254 on @xmath21 as in lemma [ lemma7.1 ] , * ( d)*. choose any extension of @xmath338 to a function @xmath127 on @xmath29 .",
    "for each @xmath279 , we can apply lemmas [ lemma6.5 ] and [ lemma6.6 ] with @xmath339 , @xmath340 , @xmath341 , @xmath342 , @xmath343 . we obtain that in a neighborhood @xmath344 of each point @xmath345 of @xmath21 we can choose @xmath346 functions @xmath347 , @xmath348 , such that @xmath349 for all @xmath350 .",
    "let @xmath351 , for all @xmath352 .",
    "then we have that @xmath353 , for all @xmath350 .",
    "now , consider a partition of unity @xmath354 , @xmath355 , on @xmath29 , where each @xmath354 is defined on an open set @xmath356 , @xmath355 .",
    "let @xmath357 be defined by the condition @xmath358 if and only if @xmath359 .",
    "using standard techniques of partitions of unity and the above result one can assume without loss of generality that for each @xmath358 there is a function @xmath360 defined on @xmath356 such that @xmath361 , for all @xmath362 .",
    "let @xmath363 , which can be naturally extended by @xmath31 on @xmath29 .",
    "then it is easy to see , using the fact that @xmath364 , for each @xmath88 , that @xmath365 , for each @xmath366 , and in particular @xmath367 .",
    "[ lemmaii6 ] * ( a ) * each function @xmath319 is locally constant on the leaves of @xmath268 therefore , since they are connected , for each @xmath319 there is a uniquely determined @xmath368 , called @xmath369 , such that @xmath370 .",
    "moreover , the vector fields @xmath371 , @xmath88 , on @xmath21 and @xmath277 on @xmath272 are @xmath275-related .    *",
    "( b ) * for each @xmath372 there exists @xmath319 such that @xmath373 and the vector fields @xmath371 , @xmath88 , on @xmath21 and @xmath277 on @xmath272 are @xmath275-related .    *",
    "( a ) * let @xmath319 , we only need to show that @xmath374 is constant on the leaves of @xmath268 , which is equivalent to showing that @xmath375 , for all @xmath376 . for a given @xmath279 ,",
    "let @xmath377 ; then using lemma [ lemmai6 ] * ( b ) * one sees that there is a function @xmath378 such that @xmath379 .",
    "then we have @xmath380 now we shall prove that @xmath381 and @xmath277 are @xmath275-related .",
    "for each @xmath88 and each @xmath382 , we have @xmath383 using this we obtain @xmath384 which shows that @xmath385 , because @xmath297 is symplectic and @xmath386 represents an arbitrary element of @xmath387 .    * ( b ) * to find @xmath374 we choose a vector field @xmath254 that is @xmath275-related to @xmath277 according to lemma [ lemma7.1 ] and then use lemma [ lemmai6 ] * ( b)*.    [ definition7.5 ] @xmath388 elements of @xmath389 are called * first class constraints*.    [ iiilemma6 ] * ( a ) * @xmath389 is a poisson ideal of @xmath313 , that is , it is an ideal of the ring @xmath313 such that if @xmath390 , then @xmath391 , for all @xmath392 .    *",
    "( b ) * @xmath393 is a poisson subalgebra of @xmath313 .    * ( a ) * let @xmath394 and @xmath392 .",
    "then it is immediate that @xmath395 and @xmath396 belong to @xmath389 . for any @xmath397",
    ", we have @xmath398 .    *",
    "( b ) * follows from * ( a ) * , using basic poisson algebra arguments .",
    "[ lemmaiiii6i ] the following conditions are equivalent for a function @xmath336 .    *",
    "( i ) * @xmath399 .    *",
    "( ii ) * @xmath400 is locally constant .    *",
    "( iii ) * @xmath401 for @xmath88 .",
    "assume * ( i)*. then @xmath402 for all @xmath403 , that is , @xmath404 . by lemma [ lemmai6 ] , * ( b ) * , we know that @xmath405 represents any vector in @xmath406 .",
    "we can conclude that @xmath407 is locally constant , so * ( ii ) * holds .",
    "now we will prove that * ( ii ) * implies * ( iii)*. let @xmath407 be locally constant .",
    "then for all @xmath408 and all @xmath279 , @xmath409 since , again by lemma [ lemmai6 ] , @xmath410 represents any element of @xmath406 , we can conclude that @xmath411 , so * ( iii ) * holds true .",
    "now we will prove that * ( iii ) * implies * ( i)*. assume that @xmath412 , @xmath279 .",
    "then for all @xmath378 and all @xmath88 , @xmath413 that is , @xmath414 . using this and the definitions",
    ", we see that @xmath415 .",
    "[ lemalema ] the map @xmath416 defined in lemma [ lemmaii6 ] is a surjective poisson map and its kernel is @xmath389 , therefore there is a natural isomorphism of poisson algebras @xmath417 .",
    "surjectivity of @xmath418 and the fact that its kernel is @xmath389 follows immediately from lemma [ lemmaii6 ] and the definitions .",
    "this implies that @xmath419 is an algebra isomorphism . also , using the definitions , for @xmath327 and any @xmath88 we can prove easily that @xmath420 where @xmath421 , @xmath422 .",
    "denote by @xmath423 the natural homomorphism of poisson algebras .",
    "then from the previous equalities we obtain @xmath424 , which shows that @xmath425 is a poisson isomorphism . in other words , we have the commutative diagram    all the arrows are defined in a natural way and they are surjective poisson algebra homomorphisms .    [ [ physical - variables . ] ] physical variables .",
    "+ + + + + + + + + + + + + + + + + + +    it is immediate to see from the definitions that for all @xmath279 , @xmath426    from now on we will assume the following .",
    "[ k2 ] * ( a ) * @xmath427 is a regular distribution , that is , it determines a regular foliation @xmath428 and the natural projection @xmath429 , where @xmath430 , is a submersion .    *",
    "( b ) * @xmath431 is a distribution of constant rank .",
    "[ lemmmma ] the distribution @xmath431 is regular and has rank @xmath95 .",
    "its integral manifolds are @xmath432 , where @xmath433 is an integral manifold of @xmath434 .",
    "moreover , these integral manifolds give a foliation @xmath435 of @xmath21 which is regular , that is , the natural map @xmath436 , where @xmath437 is a submersion .",
    "besides , each leaf of the foliation @xmath268 is foliated by leaves of @xmath435 , which gives a naturally defined submersion @xmath438 . in other words ,",
    "we obtain the commutative diagram    where each arrow is a naturally defined submersion .",
    "the first assertion , about the rank of the distribution @xmath431 , is easy to prove .",
    "let @xmath439 .",
    "then there exists a uniquely determined integral manifold @xmath433 of the distribution @xmath434 such that @xmath440 . using that , by assumption",
    ", @xmath441 is a distribution of constant dimension and that @xmath442 we can conclude that the intersection @xmath432 coincides with the integral leaf of the integrable distribution of @xmath443 containing @xmath345 .",
    "so we obtain the foliation @xmath435 of @xmath21 . using ( [ equationkernelss ] )",
    "we can deduce that each leaf of the foliation @xmath268 is foliated by leaves of @xmath435 .",
    "the rest of the proof follows by standard arguments .",
    "[ lemma_big_diagram ] * ( a ) * the following diagram is commutative    where the arrows are defined as follows .",
    "the maps @xmath444 , @xmath275 , @xmath445 and @xmath446 are defined in assumption [ k1 ] , assumption [ k2 ] and theorem [ lemmmma ] . by definition ,",
    "the map @xmath447 is the inclusion .",
    "the map @xmath448 is an embedding defined by @xmath449 , where @xmath433 is a leaf of the foliation @xmath428 .",
    "we will think of @xmath448 as being an inclusion .",
    "the vector bundle @xmath450 is the tangent bundle @xmath451 restricted to @xmath452 . in other words , since @xmath448 is an inclusion , @xmath453 is identified via some isomorphism , called @xmath454 , with the pullback of @xmath451 by @xmath448 .",
    "we call @xmath455 the natural map associated to the pullback .    *",
    "( b ) * the presymplectic form @xmath5 on @xmath0 passes to the quotient via @xmath444 giving a uniquely defined symplectic form @xmath456 on @xmath35 , satisfying @xmath457 .",
    "the presymplectic form @xmath154 , which , by definition is @xmath458 , defines uniquely a presymplectic form @xmath459 on @xmath452 via @xmath445 satisfying @xmath460 , @xmath461 .",
    "the energy @xmath3 on @xmath0 satisfies @xmath462 , for all @xmath88 , therefore it defines uniquely a 1-form on @xmath453 , called @xmath463 .",
    "since @xmath3 is constant on each leaf of @xmath435 , it also defines a function @xmath464 on @xmath452 . since @xmath465 via the inclusion @xmath466 we have @xmath467 , for all @xmath468 .    *",
    "( c ) * equation of motion ( [ diracagainagain ] ) on @xmath21 passes to the quotient @xmath452 as @xmath469 where @xmath470 .",
    "this means that if @xmath471 is a solution of ( [ diracagainagain ] ) then @xmath472 , where @xmath473 , is a solution of ( [ tildeequation ] ) .",
    "therefore , a solution curve @xmath24 of ( [ diracagainagain ] ) projects to a solution curve @xmath474 of ( [ tildeequation ] ) on @xmath452 . equation ( [ tildeequation ] ) has unique solution @xmath475 for each @xmath476 .",
    "this solution also satisfies the equation @xmath477 however solutions to equation ( [ tildeequation2 ] ) are not necessarily unique , since @xmath478 is not necessarily @xmath31 .    *",
    "( d ) * the restriction of the energy @xmath479 satisfies @xmath480 for all @xmath88 , therefore there is a uniquely defined function @xmath481 on @xmath318 such that @xmath482 .",
    "the equation @xmath483 has unique solution @xmath484 for @xmath485 .",
    "if @xmath475 is a solution of ( [ tildeequation ] ) then @xmath486 is a solution of ( [ barequation ] ) .",
    "therefore , a solution curve @xmath487 of ( [ tildeequation ] ) projects to a solution curve @xmath488 of ( [ barequation ] ) on @xmath272 .    *",
    "( a ) * the equality @xmath489 was proven in theorem [ lemmmma ] .",
    "the equality @xmath490 results immediately from the definitions .",
    "the equality @xmath491 results by applying the definitions and showing that , for given @xmath366 , @xmath492 , where @xmath493 is the only leaf of @xmath428 containing @xmath37 .",
    "* ( b ) * existence and uniqueness of @xmath456 and @xmath494 is a direct consequence of the definitions and standard arguments on passing to quotients . for any @xmath279",
    "we know that there exists a solution @xmath254 of equation ( [ diracagainagain ] ) , from which it follows immediately that @xmath495 . the rest of the proof consists of standard arguments on passing to quotients .    *",
    "( c ) * we shall omit the proof of this item which is a direct consequence of the definitions and standard arguments on passing to quotients .    *",
    "( d ) * if @xmath300 is a solution of @xmath496 then it is clear that it also satisfies @xmath497 .",
    "it follows that @xmath480 for all @xmath88 .",
    "the rest of the proof is a consequence of standard arguments on passing to quotients .",
    "recall that the locally constant function @xmath95 on @xmath21 is the dimension of the distribution @xmath498 on @xmath21 and also the dimension of the fiber of the bundle @xmath158 .",
    "if @xmath95 is nonzero then there is no uniqueness of solution to equation of motion ( [ diracagainagain ] ) , since solution curves to that equation satisfy , by definition , @xmath499    passing to the quotient manifold @xmath452 eliminates this indeterminacy and uniqueness of solution is recovered .",
    "this is related to the notions of _ physical state _ and _ determinism _ , mentioned by @xcite .",
    "the reduced equations of motion on the symplectic manifold @xmath500 are hamilton s equations .",
    "the reduced equations of motion on the manifold @xmath501 are not necessarily hamilton s equations but they are odes .",
    "the natural fibration @xmath502 has the following property . for @xmath503 and @xmath504 ,",
    "if @xmath505 and @xmath506 are the unique solution curves through @xmath507 and @xmath508 respectively , then @xmath509 .",
    "this means that there is a one - to - one correspondence between the solution curves on @xmath501 and @xmath500 , modulo the choice of a point on the fiber over the physical state @xmath507 .",
    "see also remark [ physicalstate ] .",
    "the notions of first class and second class constraints and functions and also second class submanifolds only depend on the final constraint submanifold @xmath21 and the ambient symplectic manifold @xmath29 and do not depend on the primary constraint @xmath510 or the energy @xmath511 .",
    "accordingly , in this section we will adopt an abstract setting , where only an ambient symplectic manifold and a submanifold are given . among several interesting references",
    "we cite @xcite which has some points of contact with our work .",
    "the following definition is inspired by the ones given in section [ poisson - dirac - gotay - nester ] .",
    "[ firstfirstclass ] let @xmath512 be a symplectic manifold and @xmath513 a given submanifold .",
    "then , by definition , @xmath514 elements of @xmath515 are called * _ first class functions . _ * elements of @xmath516 are called * _ first class constraints . _ * the submanifold @xmath433 is called a * _ first class constraint submanifold _ * if for all @xmath517 the condition @xmath518 implies @xmath519 , that is , @xmath520 , where @xmath521 is the ideal of the ring @xmath522 of all functions vanishing on @xmath433 .    obviously , using the notation introduced before in the present section , @xmath523 and @xmath524 .",
    "all the properties proven for @xmath313 and @xmath389 hold in general for @xmath515 and @xmath516 . for instance , @xmath525 is the set of all @xmath526 .",
    "every function @xmath527 satisfies @xmath528 , for all @xmath529 and @xmath530 is the set of all @xmath531 .",
    "we shall collect in a single lemma [ mainlemma1section7 ] the basic properties of first and second class constraints and dirac brackets and their proofs in a compact way and with a uniform language that does not rely on coordinates .",
    "most of these results are essentially known since the fundamental works of dirac , and have been stated and proven in different ways in the literature , except perhaps for the notion of second class subbundle and the corresponding description of second class submanifolds as tangent to the subbundle . the second class subbundles @xmath532 classify all second class submanifolds @xmath533 containing @xmath433 at a linear level , that is , @xmath187 is tangent to the second class submanifold .",
    "for such a second class submanifold , which is a symplectic submanifold , the dirac bracket of two functions @xmath148 and @xmath534 at points @xmath535 can be calculated as the canonical bracket of the restrictions of @xmath148 and @xmath534 .",
    "this has a global character . a careful study of the global existence of a bracket defined on sufficiently small open sets @xmath536 containing @xmath433 which coincides with the previous one on the second class submanifold will not be considered in this paper .",
    "however , to write global equations of motion on the final constraint submanifold one only needs to know the vector bundle @xmath187 , which carries a natural fiberwise symplectic form .",
    "all these are fundamental properties of second class constraints and constraint submanifolds , and theorem [ theoremsecondclass ] collects the essential part of them ; we suggest to take a look at it before reading lemma [ mainlemma1section7 ] .",
    "[ mainlemma1section7 ] let @xmath512 be a symplectic manifold of dimension @xmath173 and @xmath537 a given submanifold of codimension @xmath538 .",
    "let @xmath5 be the pullback of @xmath48 to @xmath433 and assume that @xmath539 has constant dimension .",
    "assume that @xmath433 is defined regularly by equations @xmath540 on a neighborhood @xmath541 and assume that we can choose a subset @xmath542 such that @xmath543 for all @xmath544 , where we assume that @xmath545 , for all @xmath544 .",
    "we shall often denote @xmath546 and @xmath547 the inverse of @xmath548 .",
    "moreover , we will assume that the following stronger condition holds , for simplicity .",
    "equations @xmath549 and @xmath550 define submanifolds of @xmath551 regularly , for small enough @xmath552 and @xmath553 .",
    "then    * ( a ) * @xmath554 .",
    "there are @xmath555 , @xmath556 , which in particular implies @xmath557 , @xmath558 , for @xmath559 , @xmath560 , such that @xmath561 , are linearly independent for all @xmath562 .",
    "moreover , @xmath563 form a basis of @xmath564 , for all @xmath562 and @xmath565 form a basis of @xmath566 .    *",
    "( b ) * the vector subbundle @xmath567 with base @xmath433 and fiber @xmath568 satisfies @xmath569 @xmath562 .    * ( c ) * there is a neighborhood @xmath551 of @xmath433 such that the equations @xmath570 , on @xmath551 define a symplectic submanifold @xmath571 such that @xmath572 and @xmath573 for @xmath574 , where we have extended the definition of @xmath575 for @xmath574 using the expression @xmath568 for @xmath574 .",
    "the submanifold @xmath576 has the property @xmath577 , that is , @xmath433 is a first class constraint submanifold of @xmath576 , defined regularly by @xmath578 , @xmath579 , and @xmath580 , @xmath579 .",
    "moreover , it has the only possible dimension , which is @xmath581 , for symplectic submanifolds having that property .",
    "it is also a minimal object in the set of all symplectic submanifolds @xmath582 , ordered by inclusion , satisfying @xmath583 .    *",
    "( d ) * let @xmath202 be any vector subbundle of @xmath584 such that @xmath585 or equivalently , @xmath586 then @xmath587 , for @xmath562 . let @xmath533 be a submanifold of @xmath62 such that @xmath588 , for each @xmath535 . then @xmath433 is a submanifold of @xmath533 . such a submanifold @xmath533 always exists . moreover , for such a submanifold there is an open set @xmath536 containing @xmath433 such that @xmath589 is a symplectic submanifold of @xmath62 .",
    "let @xmath590 and let @xmath591 be equations defining @xmath592 for some open neighborhood @xmath593 and satisfying that @xmath594 are linearly independent for @xmath595 .",
    "then , @xmath596 are linearly independent and @xmath597 , for @xmath598 .",
    "all the properties established in * ( a ) * , * ( b ) * , * ( c ) * for @xmath599 on @xmath433 hold in an entirely similar way for @xmath600 , on @xmath601 .",
    "in particular , @xmath602 .    * ( e ) * let @xmath603 be the pullback of @xmath48 to @xmath576 and @xmath604 the corresponding bracket . for given @xmath605 define @xmath606 and also @xmath607 which is the famous bracket introduced by dirac , called * dirac bracket * , and it is defined for @xmath37 in the neighborhood @xmath551 where @xmath548 has an inverse @xmath547 .",
    "then , for any @xmath608 , @xmath609 for @xmath560 , and also @xmath610 if we denote @xmath611 the hamiltonian vector field associated to the function @xmath612 , with respect to the dirac bracket @xmath613 then the previous equalities are equivalent to @xmath614 the jacobi identity is satisfied for the dirac bracket @xmath615 on @xmath576 , that is , @xmath616 for @xmath617 .    *",
    "( f ) * let @xmath551 be an open neighborhood of @xmath433 such that @xmath548 is invertible for @xmath544",
    ". for each @xmath618 let @xmath619 and define @xmath620 by the equations @xmath621 , @xmath622 , @xmath544 .",
    "for any @xmath623 in a sufficiently small neighborhood of @xmath31 , @xmath620 is a nonempty symplectic submanifold of @xmath62 .",
    "define the matrix @xmath624 , and also @xmath625 as being its inverse , @xmath544 .",
    "then , the equalities @xmath626 and also , @xmath627 are satisfied for all @xmath544 .",
    "all the definitions and properties proved in * ( e ) * for the case @xmath628 hold in general for any @xmath623 in a neighborhood of @xmath31 small enough to ensure that @xmath620 is nonempty . in particular , the equalities @xmath629 and @xmath630 hold for @xmath631 , and any @xmath623 in such a neighborhood .",
    "the dirac bracket @xmath615 satisfies the jacobi identity for @xmath632 and the symplectic submanifolds @xmath620 are the symplectic leaves of the poisson manifold @xmath633 . by shrinking , if necessary , the open set @xmath551 and for @xmath623 in a sufficiently small neighborhood of @xmath634 , the equations @xmath635 , @xmath556 , define regularly a first class constraint submanifold @xmath636 , and the functions @xmath637 are first class constraints , that is , @xmath638 @xmath556 .",
    "we have that @xmath639 , where @xmath640 is the pullback of @xmath48 to @xmath641 .",
    "one has @xmath642 and @xmath643 , therefore @xmath644 .    * ( a ) * let @xmath535 .",
    "we are going to use lemmas and corollaries [ lemma6.1][corollary6.7 ] with @xmath645 ; @xmath646 ; @xmath647 , @xmath648 ; @xmath649 ; @xmath650 ; @xmath651 .",
    "elements @xmath652 , @xmath653 such that @xmath654 , which implies @xmath655 for @xmath562 , must satisfy @xmath656 , or , equivalently , @xmath657 , for @xmath257 , @xmath658 . using lemma [ lemma6.6 ]",
    "we see that @xmath659 .",
    "since one can choose @xmath660 linearly independent solutions , say @xmath661 , @xmath662 , we obtain elements @xmath663 , namely , @xmath664 , such that @xmath665 are linearly independent , or , equivalently , taking into account corollary [ corollary6.7 ] , that @xmath666 is a basis of @xmath667 for @xmath562 . if @xmath668 ,  , @xmath669 , @xmath670 ,  , @xmath671 , were not linearly independent , then there would be a linear combination , say @xmath672 , with at least one nonzero coefficient , and some @xmath562 , such that @xmath673 for some @xmath674 , @xmath675 .",
    "but then , for any @xmath110 , @xmath676 , which contradicts the fact that @xmath677 . using this and the fact that @xmath113 , @xmath114 , @xmath678 , @xmath110 define @xmath433 regularly , we can conclude that @xmath668 ,  , @xmath669 , @xmath670 ,  , @xmath671 is a basis of @xmath566 .    *",
    "( b ) * if @xmath679 then @xmath680 , @xmath110 , which implies @xmath681 , @xmath110 , then @xmath682 , @xmath560 , which proves ( [ fla715 ] ) . to prove ( [ fla716 ] )",
    "we apply the operator @xmath683 to both sides and obtain the equivalent equality @xmath684 , which we know is true , as proven in * ( a)*. to prove ( [ fla717 ] ) we apply the orthogonal operator @xmath685 to both sides of ( [ fla716 ] ) .    *",
    "( c ) * since @xmath686 are linearly independent for @xmath562 they are also linearly independent for @xmath37 in a certain neighborhood @xmath551 of @xmath433 .",
    "then @xmath687 define a submanifold @xmath576 of @xmath551 containing @xmath433 . to see that it is a symplectic submanifold choose @xmath608 and apply corollary [ corollary6.7 ] with @xmath688 @xmath689 @xmath690 @xmath691 , @xmath560 ; @xmath692 . we can conclude that @xmath693 .",
    "now let us prove that @xmath694 , namely , @xmath695 . from this",
    ", using that @xmath571 is symplectic one obtains @xmath696 . to prove that @xmath697 is a first class constraint submanifold defined by first class constraints @xmath698 , @xmath699 , on @xmath576 , we observe first that it is immediate that @xmath700 , @xmath699 , define @xmath433 regularly",
    "it remains to show that @xmath701 , @xmath699 , @xmath562 , where @xmath702 is the hamiltonian vector field associated to the function @xmath698 with respect to the symplectic form @xmath603 .",
    "this is equivalent to showing that @xmath703 for @xmath562 or , equivalently , @xmath704 for @xmath562 .",
    "we know that @xmath705 is the pullback of @xmath48 to @xmath571 and @xmath706 is the pullback of @xmath121 , via the inclusion @xmath707 , then we have @xmath708 for @xmath562 , since @xmath121 are first class constraints , @xmath579 . finally , using the definitions we can easily see that @xmath709 and that @xmath710 and from * ( a ) * we know that @xmath711 .",
    "we can conclude that @xmath712 .    *",
    "( d ) * we know that for @xmath535 , @xmath713 , and @xmath714 ; then using ( [ 720eq ] ) we obtain @xmath587 . also from ( [ 720eq ] )",
    "we immediately deduce by applying @xmath685 to both sides , @xmath715 in particular @xmath716 .",
    "let @xmath127 be a given riemannian metric on @xmath62 and let @xmath717 be the @xmath127-orthogonal complement of @xmath525 in @xmath718 , in particular , @xmath719 , for each @xmath562 .",
    "define @xmath720 by choosing @xmath721 appropriately one can ensure that @xmath533 is a submanifold and , moreover , it is easy to see from the definition of @xmath533 that @xmath722 , for each @xmath562 .",
    "we leave for later the proof that @xmath723 is a symplectic submanifold of @xmath62 , for an appropriate choice of the open set @xmath551 , which amounts to choosing @xmath721 appropriately .",
    "assume that @xmath724 are linearly independent for @xmath725 .",
    "since @xmath726 for @xmath562 and @xmath622 , we can deduce that @xmath727 , that is , @xmath728 . then using ( [ 721eq ] )",
    ", we see that @xmath596 are linearly independent and span @xmath729 . if @xmath730 for some @xmath562 then @xmath731 , where at least some @xmath732 , @xmath560 .",
    "let @xmath733 , then @xmath734 , @xmath110 .",
    "on the other hand , since @xmath735 , then @xmath736 , @xmath737 . we can conclude that @xmath738 and then @xmath739 , in particular , @xmath740 , which implies @xmath741 , contradicting the linear independence of @xmath742 .",
    "it follows from which precedes that by replacing @xmath743 by @xmath744 , @xmath560 and @xmath433 by @xmath601 all the properties stated in * ( a ) * , * ( b ) * and * ( c ) * are satisfied . in particular , @xmath745 and @xmath746 is symplectic .",
    "it is now clear that by covering @xmath433 with open subsets like the @xmath747 we can define @xmath551 as being the union of all such open subsets and one obtains that @xmath748 is a symplectic submanifold .    *",
    "( e ) * let @xmath608 .",
    "then , since @xmath749 , we obtain @xmath750 using this we obtain @xmath751    for any @xmath752 , @xmath608 and @xmath753 , we have @xmath754 , so @xmath755 . therefore , for any @xmath756 ,",
    "@xmath757 which shows that @xmath758 , where both hamiltonian vector fields are calculated with the symplectic form @xmath603 . using this , for any @xmath759 and any @xmath608 , one obtains @xmath760 the equality @xmath761 is an immediate consequence of the previous ones . the jacobi identity for",
    "the bracket @xmath762 follows using the previous formulas , namely , for @xmath608 , one obtains @xmath763 where the bracket in the last term is the canonical bracket on the symplectic manifold @xmath576 , for which the jacobi identity is well known to be satisfied .    *",
    "( f ) * the equalities ( [ equationsss ] ) and ( [ equationssss ] ) are proven in a straightforward way .",
    "the equations ( [ constrequalitiesc ] ) and ( [ equationsssss ] ) follow easily using a technique similar to the one used in * ( e)*. using all this , the proof of the jacobi identity for the bracket @xmath762 on @xmath551 goes as follows .",
    "let @xmath544 and let @xmath623 be such that @xmath764",
    ". for @xmath765 using * ( e ) * we know that the jacobi identity holds for @xmath766 on @xmath620 .",
    "but then , according to ( [ equationssss ] ) it also holds for @xmath762 for all @xmath631 .",
    "now we will prove that @xmath620 are the symplectic leaves .",
    "since they are defined by equations @xmath767 , @xmath560 on @xmath551 we need to prove that @xmath768 , @xmath769 , for all @xmath770 , @xmath771 . using ( [ equationssss ] ) and ( [ constrequalitiesc ] ) we see that @xmath772 .",
    "to finish the proof , observe first that , since @xmath773 , @xmath113 , @xmath774 define regularly the submanifold @xmath775 , by shrinking @xmath551 if necessary and for all @xmath623 sufficiently small , we have that @xmath776 , @xmath113 , @xmath774 define regularly a submanifold @xmath777 and therefore @xmath778 , @xmath737 , define regularly @xmath641 as a submanifold of @xmath620 . to prove that it is a first class constraint submanifold and that @xmath779 , @xmath737 , are first class constraints , that is @xmath780 , @xmath737 , we proceed in a similar fashion as we did in * ( c ) * , replacing @xmath781 by @xmath782 .",
    "the fact that @xmath779 , @xmath737 , are first class constraints defining @xmath641 implies that @xmath639 . from the definitions",
    "one can deduce that @xmath642 and @xmath643 , therefore @xmath644 .",
    "the following theorem summarizes the essential part of the previous lemma .",
    "[ theoremsecondclass ] let @xmath512 be a symplectic manifold , @xmath513 and let @xmath5 be the pullback of @xmath48 to @xmath433 .",
    "assume that @xmath783 has constant rank .",
    "let @xmath202 be a vector subbundle of @xmath784 such that @xmath785 .",
    "then there is a symplectic submanifold @xmath533 containing @xmath433 of dimension @xmath786 such that the condition @xmath787 , for all @xmath562 holds .",
    "the vector bundle @xmath187 is called the * second class subbundle * tangent to the second class submanifold @xmath533 .",
    "the submanifold @xmath533 is locally defined by certain equations @xmath788 , ",
    ", @xmath789 as in lemma [ mainlemma1section7 ] . under the hypotheses of that lemma ,",
    "namely , that @xmath108 is constant on a neighborhood @xmath551 of @xmath433 , @xmath533 will be one of the symplectic leaves of the dirac bracket @xmath790 .",
    "\\(a ) under our strong regularity conditions the symplectic leaves of the dirac bracket give a ( local ) regular foliation of a neighborhood of the final constraint submanifold @xmath433 .",
    "this implies by the weinstein splitting theorem ( @xcite ) that there are local charts where the dirac bracket is constant .",
    "\\(b ) the tangent second class subbundle @xmath187 in a sense ( modulo tangency ) classifies all the possible second class constraint submanifolds containing a given submanifold @xmath791 .",
    "it carries enough information to write the dirac brackets along the final constraint submanifold @xmath433 and therefore also equations of motion , as we show in section [ subsectionequationsof motion ] .",
    "we are going to describe equations of motion in the abstract setting of section [ subsectionv ] , that is , a symplectic manifold @xmath512 and a submanifold @xmath513 , defined regularly by equations @xmath792 @xmath793 .",
    "for this purpose , we need to introduce in this abstract setting , by definition , the notions of _ primary constraints _ , _ primary constraint submanifold _ and the _ energy_. + the * _ primary constraint submanifold _ * is a given submanifold @xmath794 containing @xmath433 , and in this context , @xmath433 will be called the final constraint .",
    "we will assume without loss of generality that @xmath795 is defined regularly by the equations @xmath792 @xmath796 , with @xmath797 , where each @xmath798 , @xmath796 will be called a * _ primary constraint _ * while each @xmath799 @xmath800 will be called a * _ secondary constraint _ * , for obvious reasons .",
    "in this abstract setting the * _ energy _ * is by definition a given function @xmath801 .",
    "+ the equations of motion can be written in the gotay - nester form , @xmath802 where @xmath803 , for all @xmath804 .",
    "we require that for each @xmath535 , the space of solutions @xmath805 of is nonempty and forms an affine bundle .",
    "now we will transform this equation into an equivalent poisson equation using the dirac bracket .    the condition @xmath806 , for all @xmath562 and all first class constraints @xmath807 will appear later as a necessary condition for existence of solutions for any given initial condition in @xmath433 , so we will assume it from now on",
    ". + the _ * total energy * _ is defined by @xmath808 where the functions @xmath809 , @xmath796 must satisfy , by definition , @xmath810 , @xmath811 , @xmath562 or , equivalently , @xmath812 sum over @xmath796 .    [ lambda ] we assume that the solutions @xmath813 form a nonempty affine bundle @xmath814 .",
    "equivalently , if we call @xmath815 the dimension of the fibers , @xmath816 is constant on @xmath433 .    by taking a sufficiently small neighborhood @xmath551",
    ", we can assume that @xmath817 is a trivial bundle over @xmath818 , which we extend arbitrarily as a trivial affine bundle on @xmath551",
    ".    for each section of @xmath817 one has a hamiltonian @xmath819 , @xmath820 , and the equation of motion on @xmath818 , @xmath821    [ [ equations - of - motion - in - terms - of - the - dirac - bracket . ] ] equations of motion in terms of the dirac bracket .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    local equations of motion in terms of a dirac bracket become simpler when the second class constraints are adapted to the primary constraint , as we will explain next .",
    "this has been considered by dirac .",
    "the case of general second class constraints is important for the global case , and will not be studied here .",
    "assume that the primary and final constraints @xmath822 are defined by @xmath823 regularly on a certain neighborhood @xmath551 of @xmath795 .",
    "for choosing first class and second class constraints one can proceed as follows .",
    "[ 2s_constant ] the rank of the matrix @xmath824 , @xmath825 , which we will call @xmath108 , is constant on an open neighborhood @xmath551 of @xmath826 .    by shrinking @xmath551 if necessary",
    ", one can choose @xmath827 in such a way that @xmath828 is a regular submatrix .",
    "without loss of generality , assume that these functions are the last @xmath108 , that is , @xmath829 , @xmath830 . for each @xmath798 , @xmath831",
    ", there are @xmath832 such that @xmath833 , @xmath834 , defined on @xmath551 satisfy @xmath835 for all @xmath562 , and all @xmath836 .",
    "therefore , these @xmath121 are first class constraints and @xmath837 are second class constraints , and for each @xmath544 the @xmath838 are linearly independent , @xmath544 .",
    "we will sometimes call @xmath839 a complete set of first class and second class constraints for @xmath433 .",
    "+ now we will show how to choose a complete set of first class and second class constraints * _ adapted to the primary constraints_*. this , as a definition , means choosing @xmath840 as before in such a way that , for @xmath841 equal to the rank of the submatrix @xmath842 , @xmath843 , @xmath844 are primary constraints .    to achieve this ,",
    "let @xmath845 such that the rows @xmath846 , @xmath847 , are linearly independent . without loss of generality , assume that these functions are the last @xmath848 , that is , @xmath849 , @xmath850 .",
    "then , for each @xmath851 , there are @xmath832 , @xmath847 such that @xmath852 defined on @xmath551 satisfy @xmath853 for all @xmath854 , @xmath562 , and all @xmath855 .",
    "therefore , these @xmath856 form a set of @xmath857 first class constraints .",
    "note that @xmath858 is a complete set of primary constraints , in the sense that their differentials are linearly independent on @xmath551 , and every primary first class constraint @xmath807 can be written as @xmath859 .    in order to obtain a complete set of first class and second class constraints",
    "we first choose @xmath860 such that the rows @xmath861 , @xmath862 @xmath863 , @xmath864 are linearly independent .",
    "this can be done because the matrix @xmath865 , @xmath866 , has rank @xmath108 .",
    "as before , assume that @xmath867 , @xmath868",
    ".    then , for each @xmath869 there are @xmath870 , @xmath871 , @xmath863 , @xmath872 , such that @xmath873 , @xmath863 , @xmath872 , satisfies @xmath874 for all @xmath562 , and all @xmath855 .",
    "it can be shown using the definitions that @xmath875 are linearly independent for @xmath535 .",
    "note that no nontrivial linear combination of the @xmath876 is a primary first class constraint .",
    "therefore , @xmath877 form a complete set of first class and second class constraints adapted to the primary constraints .",
    "+ we will now take advantage of these adapted constraints to write the equations of motion in a simpler way . the total energy defined on @xmath551",
    "is @xmath878 @xmath879 , @xmath880 . as usual , we impose on @xmath130 the condition that it is first class , which means that @xmath881 , @xmath882 and @xmath883 @xmath884 , @xmath535 . from this",
    "we obtain well - defined @xmath885 , @xmath535 , which we extend arbitrarily for @xmath352 .",
    "then the equations of motion are written as @xmath886 @xmath535 , where @xmath887 , @xmath879 , are completely arbitrary real numbers .",
    "we can also write this equation in the poisson form @xmath888    now we will see a simpler expression for the equations using dirac brackets rather than the canonical bracket . since @xmath130 is first class , then @xmath889 for @xmath535 ( see lemma [ mainlemma1section7](e ) ) .",
    "then the equations of motion can be written as @xmath890 this equation , obtained in an abstract setting , is similar to the one in page 42 of @xcite for the case @xmath891 .",
    "we can rewrite the total energy as @xmath892 where @xmath893 and @xmath894 , and therefore ( [ eq : f_ht_dirac_bracket ] ) can be written as @xmath895 or equivalently , @xmath896 @xmath535 .",
    "we will denote @xmath897 @xmath898 , and call it the * _ abridged total energy_*. it has the property that it provides the same dynamical information as the total energy in terms of the dirac bracket .",
    "moreover , for each @xmath562 the map @xmath899 given by @xmath900 is an isomorphism . in particular , for any solution curve @xmath901 of @xmath902 on @xmath433 , we have @xmath903 for a ( uniquely determined ) choice of @xmath904 , @xmath893 .",
    "we have proven the following theorem .",
    "[ theorem321 ] let the primary @xmath905 and final constraint @xmath433 be submanifolds defined regularly by equations ( [ calsprime ] ) , ( [ sprimec ] ) on a neighborhood @xmath536 of @xmath905 , where @xmath512 is a symplectic manifold .",
    "let @xmath108 be the rank of the matrix @xmath906 , @xmath825 , which , by assumption [ 2s_constant ] , is constant on @xmath551 .",
    "let @xmath841 be the rank of the matrix @xmath842 , @xmath907 , which , by assumption [ lambda ] is constant on @xmath433 .",
    "choose @xmath841 linearly independent rows @xmath908 , @xmath909 of @xmath910 , say w.l.o.g .",
    "@xmath849 , @xmath850 . then for each @xmath893 one can find coefficients @xmath832 such that @xmath911 , @xmath912 , defined on @xmath551 constitute a maximal set of linearly independent primary first class constraints .",
    "then @xmath913 is a complete set of primary constraints and one can extend it to a complete set of first class and second class constraints @xmath914 let @xmath915 be a given energy satisfying @xmath881 , @xmath535 , @xmath831 . consider the following _ abridged total energy _",
    "@xmath916 @xmath893 , where @xmath917 are arbitrary real parameters . the corresponding hamiltonian vector field with respect to the dirac bracket",
    "is @xmath918 @xmath352 . for @xmath535 ,",
    "this vector field is tangent to @xmath433 and gives the equations of motion .",
    "equivalently , we can write the equations of motion as @xmath919 since @xmath920 is tangent to @xmath433 , the evolution of a function @xmath374 on @xmath433 is given by for any @xmath148 such that @xmath921 .    equation ( [ eq : poisson_dirac_evolution_thm ] ) represents an elaboration on the equation ( [ eq : f_ht_dirac_bracket ] ) .",
    "it has interesting advantages which may be useful in practice , because it only requires calculating @xmath922 , which is a set of second class constraints adapted to the primary constraint",
    ". it will be generalized to extend its applicability to examples where the constraints are _ foliated _ , as we will see in section  [ sectionanextensionofetc ] .",
    "[ physicalstate ] the geometric meaning of @xmath848 is given by the fact that @xmath923 is the number of independent primary first class constraints @xmath924 , @xmath925 .",
    "this number coincides with @xmath95 and with the dimension of the leaves of the foliation @xmath926 of @xmath21 ( see theorem [ lemmmma ] ) . also , the hamiltonian vector fields @xmath927 are tangent to the leaves of @xmath926 .",
    "using the formula @xmath928=x_{-\\{f , g\\}}$ ] it is easy to prove that the iterated poisson brackets of the @xmath924 give functions whose hamiltonian vector fields are tangent to the leaves of @xmath926 .",
    "each one of these functions , let us call it @xmath374 , satisfies that @xmath929 for all @xmath279 , but not necessarily @xmath374 is a linear combination of the @xmath924 , on a neighborhood of @xmath21 , so it might not be a primary first - class constraint .",
    "one can prove that such a function is zero on @xmath21 , but since @xmath930 for all @xmath279 , it can not be included in a set of constraint functions defining @xmath21 regularly and containing the @xmath924 , in other words , it is not an _ independent _ secondary first class constraint .",
    "there are examples in the literature where the poisson bracket of two primary first class constraints is an independent secondary first class constraint , for instance , that is the case in @xcite ; for that example assumption [ k2 ] ( a ) does not hold ( but [ k2 ] ( b ) does ) .    according to @xcite , pages 2324 , primary first class constraints and",
    "their iterated brackets represent transformations that do not change the physical state of the system , which in this case is implied directly from the requirement of determinism .",
    "we have seen that under our regularity conditions , those iterated brackets do not really add any new such transformations besides the ones given by the primary first class constraints .",
    "in addition , note that @xmath931 is also the dimension of the kernel of the presymplectic form on @xmath433 ( see theorem [ mainlemma1section7 ] ( a ) ) , which is the number of first class constraints , and also the dimension of the leaves of @xmath268 ( see assumption [ k1 ] ) .",
    "since the hamiltonian vector fields @xmath932 corresponding to the first class constraints generate the integrable distribution associated to @xmath268 , then the transformations that preserve the leaves of @xmath268 are those which preserve the physical state .",
    "so , points of @xmath933 would represent exactly the physical states .",
    "@xcite introduces the notion of extended hamiltonian . in our context",
    ", we should define the notion of * _ extended energy _ * , @xmath934 @xmath935 where the @xmath936 represent the secondary first class constraints .",
    "both @xmath937 and @xmath130 give the same dynamics on the quotient manifold @xmath500 .",
    "if @xmath938 is symplectic , there are only second class constraints among the @xmath798 , @xmath939 , and conversely . in this case ,",
    "the rest of the paper is devoted to generalizing the dirac and gotay - nester theories of constraints . in this section",
    "we review a few basic facts related to dirac structures and dirac dynamical systems following @xcite and @xcite , which are of direct interest for the present paper .",
    "we introduce the flat @xmath941 and the orthogonal @xmath942 operators with respect to a given dirac structure , which is important to describe the algorithm , in the next section .",
    "in fact , we obtain a technique which imitates the gotay - nester technique , by replacing @xmath5 by @xmath943 .",
    "[ [ dirac - structures - on - vector - spaces . ] ] dirac structures on vector spaces .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath202 be an @xmath944-dimensional vector space and let @xmath945 be its dual space . define the _ symmetric pairing _",
    "@xmath946 on @xmath947 by @xmath948 for @xmath949 where @xmath950 is the natural pairing between @xmath945 and @xmath202 .",
    "a _ linear dirac structure _ on @xmath202 , ( sometimes called simply a _ dirac structure _ on @xmath202 ) , is a subspace @xmath951 such that @xmath952 , where @xmath953 is the orthogonal of @xmath943 relative to the pairing @xmath954 .",
    "one can easily check the following result .",
    "[ defdiracstr ] a vector subspace @xmath955 is a dirac structure on @xmath202 if and only if it is maximally isotropic with respect to the symmetric pairing .",
    "a further equivalent condition is given by @xmath956 and @xmath957 for all @xmath958 .",
    "one of the main examples is the dirac structure naturally defined on a presymplectic vector space @xmath959 by @xmath960 here the definition of @xmath961 is the standard one , namely , @xmath962 is defined by @xmath963 , for all @xmath964 .",
    "we also recall the definition of orthogonality on @xmath202 associated to a given presymplectic form @xmath5 . for a given subset @xmath965",
    "we define the @xmath5-orthogonal complement @xmath966 by @xmath967 we recall some standard facts in the following lemma , omitting the proof .",
    "[ circperp ] let @xmath5 be a presymplectic form on a vector space @xmath202 and let @xmath968 be any vector subspace",
    ". then @xmath969 , where the right hand side denotes the annihilator of @xmath970 .",
    "the following proposition is a direct consequence of propositions 1.1.4 and 1.1.5 in @xcite .",
    "[ diracpresymplectic ] given a dirac structure @xmath951 define the subspace @xmath971 to be the projection of @xmath943 on @xmath202 . also , define the 2-form @xmath972 on @xmath973 by @xmath974 , where @xmath975 .",
    "( one checks that this definition of @xmath976 is independent of the choice of @xmath7 ) .",
    "then , @xmath972 is a skew form on @xmath973 .",
    "conversely , given a vector space @xmath202 , a subspace @xmath977 and a skew form @xmath5 on @xmath978 , one sees that @xmath979 is the unique dirac structure @xmath943 on @xmath202 such that @xmath980 and @xmath981 .",
    "@xmath943 is the dirac structure associated to a presymplectic form @xmath5 on @xmath202 , as explained before , if and only if @xmath982 and @xmath983 .    [ [ the - operators - dflat - and - d . ] ] the operators @xmath941 and @xmath942 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    there is a natural extension , which is important in the present paper , of the previous definition of @xmath961 for the case of a general dirac structure @xmath984 . for a given dirac structure @xmath985 and given @xmath986 define the _ set _ @xmath987 , sometimes denoted @xmath988 for short , by @xmath989 note that @xmath943 is the dirac structure associated to a presymplectic form on @xmath202 , that is , @xmath990 , if and only if @xmath982 and for each @xmath991 , the set @xmath987 has a single element , more precisely , @xmath992 . in this sense",
    ", @xmath987 generalizes @xmath993 . for a given subset @xmath994 define @xmath995 , also denoted @xmath996 , by @xmath997 if @xmath998 is a subspace , then @xmath995 is a subspace of @xmath945 .",
    "it is straightforward to check that for all @xmath999 , @xmath1000    the notion of orthogonal complement with respect to @xmath5 can be generalized as follows . for any subset @xmath994 define @xmath1001 by @xmath1002 clearly ,",
    "@xmath1003 it is easy to check that for any subspace @xmath994 one has @xmath1004 we recall also that , since @xmath1005 is a presymplectic form on @xmath973 , one has , according to lemma [ circperp ] and with a self - explanatory notation , @xmath1006 the following proposition generalizes lemma [ circperp ] and is one of the ingredients of the constraint algorithm described in section [ sectionconstalgforrdirac ] .",
    "[ circperpd]let @xmath984 be a given dirac structure and let @xmath994 be a given subspace . then @xmath1007 .",
    "we first show that @xmath1008 .",
    "let @xmath1009 , say @xmath1010 for some @xmath1011 .",
    "since @xmath1012 for all @xmath1013 by definition of @xmath1001 , it follows that @xmath1014 . to prove the converse inclusion",
    ", we first observe that it is equivalent to prove that @xmath1015 .",
    "let @xmath1016 , then @xmath1017 , for all @xmath1018 , which is an immediate consequence of the definitions .",
    "but , also by definition , this implies that @xmath1019 .",
    "[ [ dirac - structures - on - manifolds . ] ] dirac structures on manifolds .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we will give the definition and some basic properties of dirac manifolds , following @xcite and @xcite , using the notation of the latter .    a _ dirac structure _",
    "@xmath943 on a manifold @xmath0 is a subbundle of the whitney sum @xmath2 such that for each @xmath1020 , @xmath1021 is a dirac structure on the vector space @xmath1022",
    "dirac manifold _ is a manifold with a dirac structure on it . from proposition [ diracpresymplectic ]",
    "we deduce that a dirac structure @xmath943 on @xmath0 yields a distribution @xmath1023 whose dimension is not necessarily constant , carrying a presymplectic form @xmath1024 , for all @xmath1025 .",
    "we can also deduce the following theorem , whose detailed proof appears in @xcite .",
    "[ diracpresymplecticmanifold ]",
    "let @xmath0 be a manifold and let @xmath5 be a 2-form on @xmath0 . given a distribution @xmath978 on @xmath0 ,",
    "define the skew - symmetric bilinear form @xmath1026 on @xmath978 by restricting @xmath5 to @xmath1027 . for each @xmath1025",
    "let @xmath1028 then @xmath1029 is a dirac structure on @xmath0 .",
    "it is the only dirac structure @xmath943 on @xmath0 satisfying @xmath1030 and @xmath1031 , for all @xmath1025 .    using lemma [ circperp ] and proposition [ circperpd ] we can easily deduce the following proposition .",
    "[ circperpmanifold ] let @xmath943 be a dirac structure on @xmath0 and let @xmath717 be a subspace of @xmath1032 for each @xmath1020 ; then , with a self - explanatory notation , the following equalities hold for each @xmath1020 : @xmath1033    a dirac structure @xmath943 on @xmath0 is called _ integrable _ if the condition @xmath1034 is satisfied for all pairs of vector fields and 1-forms @xmath1035 , @xmath1036 , @xmath1037 that take values in @xmath943 and where @xmath1038 denotes the lie derivative along the vector field @xmath254 on @xmath0 .",
    "this definition encompasses the notion of closedness for presymplectic forms and jacobi identity for brackets .",
    "the following fundamental theorem was proven in @xcite .",
    "[ presymplfoliation ] let @xmath943 be an integrable dirac structure on a manifold @xmath0",
    ". then the distribution @xmath973 is involutive .",
    "if , moreover , the hypotheses of the stefan - sussmann theorem ( @xcite ) are satisfied , for each @xmath1020 there exists a uniquely determined embedded submanifold @xmath433 of @xmath0 such that @xmath562 and @xmath1039 for all @xmath1040 . in other words , @xmath433 is an integral submanifold of @xmath973 .",
    "each integral submanifold @xmath433 carries a presymplectic form @xmath1041 defined by @xmath1042 , for each @xmath535 .",
    "lagrangian and hamiltonian mechanics has been developed in interaction with differential , symplectic , and poisson geometry ; a few references are .",
    "dirac dynamical systems in the integrable case represent a synthesis and a generalization of both .",
    "nonholonomic mechanics represents a generalization of lagrangian and hamiltonian mechanics and is a long - standing branch of mechanics , engineering and mathematics .",
    "some references and historical accounts on the subject are .",
    "some references that are more closely related to this paper are .",
    "dirac dynamical systems ( [ 11drracds ] ) in the not necessarily integrable case may be viewed as a synthesis and a generalization of nonholonomic mechanics from the lagrangian and the hamiltonian points of view .",
    "they can be written equivalently as a collection of systems of the type @xmath1043    a related approach has been studied in @xcite . as it was shown in @xcite , one can write nicely the equations of nonholonomic mechanics , on the lagrangian side , using the dirac differential . we will show how this is related to system ( [ 11drracds ] ) .",
    "it was also shown in @xcite and references therein how to use dirac structures in lc circuit theory , on the lagrangian side .",
    "on the hamiltonian side , poisson brackets for lc circuits were written in @xcite , see also @xcite . in @xcite the hamiltonian structure for nonlinear lc circuits in the framework of dirac structures is investigated and simple and effective formulas are described .",
    "in @xcite a further unification , including reduction , is presented , which is consistent with mechanics on lie algebroids ( ) .",
    "some results in this section , in particular the cad and examples of nonholonomic mechanics , are proven for not necessarily integrable dirac structures .",
    "first , we shall briefly consider the case of an integrable dirac structure .",
    "this includes the case of a constant dirac structure on a vector space , that is , one that is invariant under translations , which includes the one used for lc circuits .",
    "later on we will consider the general case .",
    "[ [ the - case - of - an - integrable - dirac - manifold . ] ] the case of an integrable dirac manifold .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    assume that @xmath943 is an integrable dirac structure on a manifold @xmath0 .",
    "each solution curve @xmath24 of the system ( [ 11drracds ] ) must satisfy @xmath1044 for all @xmath1045 , which implies , according to theorem [ presymplfoliation ] and equation ( [ classicalm122 ] ) , that it must be a solution curve to the equation @xmath1046 on a presymplectic leaf @xmath433 , where @xmath1047 is the inclusion , which can be solved using the gotay - nester algorithm .",
    "such a procedure to solve ( [ 11drracds ] ) might be useful in those cases where the presymplectic leaves @xmath1048 can be found easily .",
    "this occurs for instance if @xmath0 is a vector space and @xmath943 is a constant ( i.e.  translation - invariant ) dirac structure , as we will show next .",
    "however , this procedure has the drawback that in order to find a solution of ( [ 11drracds ] ) for a given initial condition , one must first find the leaf @xmath433 containing that initial condition and then solve .",
    "for an initial condition on a different leaf , one has to repeat the constraint algorithm for a different corresponding equation . because of this , even in these simple cases , working directly with the dirac structure @xmath943 , using the constraint algorithm to be developed in this section , rather than with the associated presymplectic form on a presymplectic leaf , is not only possible but also convenient , since this leads to obtaining a single equation on a final foliated constraint submanifold , as we will see .",
    "[ [ the - case - of - a - constant - dirac - structure . ] ] the case of a constant dirac structure .",
    "let @xmath202 be a vector space and @xmath1049 a given linear dirac structure .",
    "then we have the presymplectic form @xmath1050 on @xmath1051 and the associated linear map @xmath1052 .",
    "we consider the dirac structure @xmath1053 on the _ manifold _",
    "@xmath202 defined as @xmath1054 , where we have used the natural identification @xmath1055 .",
    "this dirac structure is integrable and constant , that is , invariant under translations in a natural sense , as we will show next .    for each @xmath1056 the presymplectic leaf @xmath493 containing @xmath37 ( in the sense of theorem [ presymplfoliation ] )",
    "is @xmath1057 . for each @xmath1056",
    ", @xmath1050 induces the constant presymplectic form @xmath1058 given by @xmath1059 where @xmath1060 , so @xmath1061 represents any point in the symplectic leaf @xmath1062 , or , equivalently , @xmath1063 consider the system @xmath1064    this system , for a given initial condition @xmath1065 , is equivalent to the following equation on the presymplectic leaf @xmath433 that contains @xmath37 @xmath1066 keeping @xmath37 fixed and writing @xmath1067 , the system on the presymplectic leaf @xmath1068 becomes @xmath1069 therefore equation is equivalent to the following equation on the subspace @xmath1051 @xmath1070 with initial condition @xmath1071 .",
    "equation ( [ equation3 ] ) can be solved by the algorithm described in @xcite and @xcite , and sketched in section [ the gotay - nester algorithm ] .",
    "notice that , since the presymplectic form @xmath1050 on the vector space @xmath1051 determines naturally a translation - invariant dirac structure on the same space @xmath1051 considered as a manifold , equation ( [ equation3 ] ) is also a dirac dynamical system in the same way ( [ equation ] ) is , but with the dirac structure given by the presymplectic form @xmath1050 considered as a constant form on the manifold @xmath1062 . because of this and also because @xmath1072 , equation ( [ equation3 ] ) is , in essence , simpler than system ( [ equation ] ) .",
    "[ [ the - case - of - a - general - dirac - manifold . ] ] the case of a general dirac manifold .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    now let @xmath943 be a dirac structure on @xmath0 that needs not be integrable .",
    "in order to explain our algorithm for dirac manifolds we need the following auxiliary result , involving a given subspace @xmath717 of @xmath1032 , which is easy to prove using results from section [ sectiondiracstructures ] .",
    "[ lemmaequivalence ] for each @xmath1020 we have the following equivalent conditions , where @xmath717 is a given subspace of @xmath1032 .",
    "* there exists @xmath1073 such that ( [ 11drracds ] ) is satisfied .",
    "* there exists @xmath1073 such that @xmath1074 . *",
    "@xmath1075 . * @xmath1076 .",
    "* there exists @xmath1073 such that @xmath1077 .",
    "* @xmath1078 .",
    "* @xmath1079 .",
    "now we can describe the constraint algorithm for dirac dynamical systems , called _",
    "cad_. following the same idea of the gotay - nester algorithm described in section [ the gotay - nester algorithm ] we should construct a sequence of constraint submanifolds .    to define the first constraint submanifold @xmath32 we may use either one of the equivalent conditions of lemma [ lemmaequivalence ] , with @xmath1080 .",
    "we want to emphasize the role of the two equivalent conditions ( iv ) and ( vii ) , as they represent a formal analogy between the cad and the gotay - nester algorithm",
    ". of course , the gotay - nester algorithm , by definition , corresponds to the case @xmath1081 .",
    "define @xmath1082 let us assume that @xmath32 is a submanifold .",
    "then we define the second constraint submanifold @xmath1083 by either of the following equivalent conditions , in agreement with ( iv ) and ( vii ) of lemma [ lemmaequivalence ] , with @xmath1084 , @xmath1085 more generally we define recursively @xmath166 for @xmath1086 , by either of the conditions @xmath1087 with @xmath1088 .",
    "the algorithm stops and the final constraint submanifold @xmath21 is determined by the condition @xmath1089 .",
    "the solutions @xmath22 are in @xmath1090 .",
    "we have proven that solution curves of ( [ 11drracds ] ) are exactly solution curves of @xmath1091    in some examples , it is sometimes easier to write the constraint submanifolds using condition ( vi ) in lemma [ lemmaequivalence ] , that is , @xmath1092 with @xmath1088 , @xmath1093 , where @xmath1094 .",
    "[ importantremark ] formula ( [ constraintsubmf3 ] ) has a special meaning in the case of an integrable dirac structure .",
    "in fact , let @xmath433 be an integral leaf of the distribution @xmath973 ; then by applying the gotay - nester algorithm , encoded in the recursion formula ( [ equationalgorithgn ] ) , to the system ( [ equation15 ] ) one obtains a sequence of secondary constraints @xmath1095 given by the recursion formula @xmath1096 but it is clear that equation ( [ sequationalgorithgn ] ) coincides with equation ( [ constraintsubmf3 ] ) since @xmath1097 , @xmath1098 and the presymplectic form @xmath1041 on @xmath433 is defined by @xmath1099 for all @xmath562 .",
    "we are assuming regularity conditions that ensure that the gotay - nester algorithm applied for each @xmath433 stops after a number of steps @xmath1100 which does not depend on @xmath433 and which is at the same time the number of steps after which the cad stops .",
    "as a conclusion , the final constraint submanifold @xmath21 of the cad is foliated by leaves @xmath1101 , where @xmath433 varies on the set of integral leaves of the distribution @xmath973 .",
    "we may say that in the case of an integrable dirac structure @xmath943 the cad is equivalent to a collection of gotay - nester algorithms , one for each leaf @xmath433 of the distribution @xmath973 .",
    "the final equation given by ( [ gotaygen1ccc])([gotaygen1ccc2 ] ) becomes @xmath1102 which is equivalent to the collection of equations @xmath1103    in section [ sectionanextensionofetc ] we will extend the dirac theory of constraints .",
    "for that purpose , we will use an embedding of @xmath0 in a symplectic manifold @xmath62 such that the presymplectic leaves @xmath433 of are presymplectic submanifolds of @xmath62 .",
    "the submanifold @xmath0 plays the role of a primary _ foliated _ constraint submanifold .",
    "the case in which there is only one leaf gives the dirac theory .",
    "[ [ solving - the - equation . ] ] solving the equation .",
    "+ + + + + + + + + + + + + + + + + + + + +    the constraint algorithm cad gives a method to solve the ide ( [ 11drracds ] ) which generalizes the gotay - nester method .",
    "assume that the final constraint submanifold @xmath21 has been determined , and consider , for each @xmath88 , the affine space @xmath1104 which is nonempty if @xmath21 is nonempty , a condition that will be assumed from now on .",
    "let @xmath95 be the dimension of @xmath159 .",
    "the following theorem is one of the ingredients of our main results , and generalizes the gotay - nester algorithm for the case of dirac dynamical systems rather than gotay - nester systems ( [ 11gn ] ) .",
    "its proof is not difficult , using the previous lemma , and is left to the reader .",
    "[ maintheorem1 ] let @xmath0 be a given manifold , @xmath943 a given dirac structure on @xmath0 and @xmath3 a given energy function on @xmath0 , and consider the dirac dynamical system @xmath1105 assume that for each @xmath1106 , the subset @xmath44 of @xmath0 defined recursively by the formulas ( [ constraintsubmf1])([constraintsubmf3 ] ) is a submanifold , called the * _",
    "@xmath1107-constraint submanifold_*. the decreasing sequence @xmath44 stops , say @xmath1108 ( which implies @xmath1109 , for all @xmath1110 ) , and call @xmath21 the * _ final constraint submanifold_*. then the following hold :    _ ( a ) _ for each @xmath88 , there exists @xmath1111 such that ( [ againdirac ] ) is satisfied .",
    "the dirac dynamical system ( [ againdirac ] ) is equivalent to the equation @xmath1112 that is , both equations have the same solution curves @xmath1113 .",
    "_ ( b ) _ for each @xmath88 , @xmath95 equals the dimension of @xmath1114 .    _",
    "if @xmath95 is a locally constant function of @xmath37 on @xmath21 then @xmath1115 is an affine bundle with base @xmath21 .",
    "each section @xmath254 of @xmath158 is a vector field on @xmath21 having the property that @xmath1116 , for all @xmath88 .",
    "solution curves to such vector fields are solutions to the dirac dynamical system ( [ 11drracds ] ) .",
    "more generally , one can choose arbitrarily a time - dependent section @xmath1117 , then solution curves of @xmath1117 will be also solutions to ( [ 11drracds ] ) and those are the only solutions of ( [ 11drracds ] ) .",
    "solution curves to ( [ 11drracds ] ) are unique for any given initial condition if and only if @xmath1118 , for all @xmath88 .    [ [ local - representation - for - sc . ] ] local representation for @xmath158 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    one can find a local representation for @xmath158 by just choosing a local parametrization of @xmath21 .",
    "let @xmath1119 , where @xmath551 is an open set and @xmath538 is the dimension of @xmath21 , be such a local parametrization .",
    "then substitute this expression for @xmath37 in ( [ 11drracds ] ) to obtain an ide in @xmath1120 , namely @xmath1121 the local representation of @xmath158 is given by the trivial affine bundle @xmath1122    [ [ some - results - concerning - uniqueness - of - solution . ] ] some results concerning uniqueness of solution .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    under assumption [ k2 ] ( b ) , we can prove the following lemma .",
    "[ lemmalemma ] ( a ) existence and uniqueness of a solution curve @xmath24 of ( [ redagaindirac ] ) for any initial condition @xmath1123 , and therefore also of the dirac dynamical system ( [ againdirac ] ) , is equivalent to any of the conditions    \\(i ) @xmath1124 , for each @xmath88 ,    \\(ii ) @xmath1125 , for each @xmath88 ,    \\(iii ) @xmath1126 , for each @xmath88 . + ( b ) if @xmath1127 , or , equivalently , @xmath1128 , is symplectic for each @xmath88 then there is existence and uniqueness of solution @xmath24 of ( [ redagaindirac ] ) for any initial condition @xmath1123 , and therefore also of the dirac dynamical system ( [ againdirac ] ) .",
    "one also has that @xmath1127 is symplectic for each @xmath88 if and only if any one of the following conditions is satisfied :    \\(i ) @xmath1129 ,    \\(ii ) @xmath1130 .",
    "we first recall the argument from theorem [ maintheorem1 ] .",
    "uniqueness of a solution @xmath24 of equation ( [ redagaindirac ] ) for any given initial condition @xmath1131 ( which , as we know from the cad , must satisfy @xmath1132 and @xmath1133 for all @xmath1045 ) holds if and only if for each @xmath88 there is a uniquely determined @xmath1134 such that @xmath1135 in other words , if equation ( [ redagaindirac ] ) defines a vector field on @xmath21 .",
    "in fact , if this is the case , by the general theory of ode on manifolds we have existence and uniqueness of solution .",
    "we also recall that under assumption [ k2 ] ( b ) , the equation ( [ redagaindirac ] ) defines a family of vector fields on @xmath21 , which defines an affine distribution of constant rank whose space at the point @xmath88 is the affine space of all solutions @xmath1136 as indicated above . using this",
    "we can deduce that uniqueness of solution @xmath24 of ( [ redagaindirac ] ) for any initial condition @xmath1123 , is equivalent to the affine distribution defined above having dimension @xmath31 .",
    "now we shall prove the equivalence between uniqueness of solution and _",
    "( a)_. let @xmath1137 satisfying equation ( [ redagaindirac ] ) , that is , @xmath1138 let @xmath1139 be such that @xmath1140",
    ". then @xmath1141 also satisfies ( [ redagaindirac ] ) , which shows that the affine distribution described above has dimension greater than @xmath31 . using this , the proof of the equivalence between uniqueness of solution and _ ( a)(i ) _ follows easily . the rest of the proof of the equivalence with _ ( a )",
    "_ follows from the fact that @xmath1142 for each @xmath88 , which can be proved directly using the definitions .",
    "note that the equivalence between _",
    "( i ) , ( ii ) , ( iii ) _ of _ ( a ) _ holds for _ any _ subspace @xmath1143 .",
    "now we shall prove _",
    "( b)_. first of all , if @xmath1137 satisfies ( [ redagaindirac ] ) then , since @xmath1143 , it clearly also satisfies @xmath1144 we can conclude that if @xmath1145 , which as we know coincides with @xmath1146 , is symplectic then equation ( [ redagaindirac ] ) defines a vector field @xmath1136 on @xmath21 , which is , in fact , given by equation ( [ equationequation111 ] ) . then existence and uniqueness of solution @xmath24 of ( [ redagaindirac ] ) for any initial condition @xmath1123",
    "is guaranteed .",
    "finally , the equivalence between symplecticity of @xmath1147 and _ ( b)(i ) _ and _ ( b)(ii ) _ is easy to prove using basic linear symplectic geometry .",
    "in fact , is is easy to prove that symplecticity of @xmath1145 is equivalent to @xmath1148 . using lemma [ lemmaperp ]",
    "we can deduce that @xmath1149 from which we obtain @xmath1150 .    with the method just described , one can deal with many examples of interest , such as nonholonomic systems and circuits , provided that one chooses the manifold @xmath0 and the dirac structure @xmath943 properly .",
    "we show in the next section how a nonholonomic system given by a distribution @xmath1151 on the configuration space @xmath1152 can be described by a dirac dynamical system on the pontryagin bundle @xmath50 and how one can apply the constraint algorithm cad to this example , although we will not perform a detailed calculation of the sequence of constraint submanifolds @xmath44 .",
    "we also show how lc circuits can be treated with the same formalism as nonholonomic systems . the main point for doing this",
    "is , again , to choose the manifold @xmath0 as being the pontryagin bundle @xmath1153 , where , this time , @xmath1152 is the charge space , and a canonically constructed dirac structure @xmath1154 on @xmath0 , where , this time , @xmath1155 represents kirchhoff s current law .",
    "we also show how this approach using @xmath1156 is related to the approach used in @xcite .",
    "in this section we deal with two examples , namely , nonholonomic systems , and lc circuits , showing that dirac dynamical systems give a unified treatment for them .",
    "we will perform the detailed calculation of the constraint submanifolds @xmath44 for the case of lc circuits only .",
    "[ [ nonholonomic - systems . ] ] nonholonomic systems .",
    "+ + + + + + + + + + + + + + + + + + + + +    recall that a nonholonomic system is given by a configuration space @xmath1152 , a distribution @xmath1151 , called the nonholonomic constraint , and a lagrangian @xmath1157 .",
    "equations of motion are given by lagrange - dalembert s principle .",
    "inspired by the hamilton - poincar principle given in , we can write a convenient equivalent form of the lagrange - dalembert principle as @xmath1158 where @xmath1159 is defined by @xmath1160 , and with the restriction on variations @xmath1161 , @xmath1162 for @xmath1163 , along with the kinematic restriction @xmath1164 . the resulting equations are @xmath1165 we are going to show that equations ( [ nonholoeq])([nonholoeq3 ] ) can be written in the form ( [ 11drracds ] ) .",
    "for this purpose we must construct an appropriate dirac structure associated to the nonholonomic constraint .",
    "inspired by several results in @xcite and by the hamilton - poincar s point of view we define a dirac structure @xmath1166 on @xmath12 associated to a given distribution @xmath1151 on a manifold @xmath1152 by the local expression @xmath1167 * note .",
    "* we shall accept both equivalent notations @xmath1168 for an element of @xmath1169 .    by checking that @xmath1170 , that is @xmath1171 , and that @xmath1172 for all @xmath1173 we can conclude using lemma [ defdiracstr ] that @xmath1154 is a dirac structure on @xmath0 .",
    "we should now prove that @xmath1154 is well defined globally , in other words , that it does not depend on the choice of a local chart .",
    "let @xmath1174 and @xmath1175 be the natural maps that in local coordinates are given by @xmath1176 and @xmath1177 . for a given distribution @xmath1151 consider the distribution @xmath1178 and also the 2-form @xmath1179 , on the manifold @xmath1180 , where @xmath5 is the canonical 2-form on @xmath99 .",
    "we have the local expressions @xmath1181 and @xmath1182 .",
    "now we can apply theorem [ diracpresymplecticmanifold ] replacing @xmath0 by @xmath1183 , @xmath978 by @xmath1184 and @xmath5 by @xmath456 and then we can easily check that the dirac structure @xmath1185 coincides with @xmath1154 . in other words , by using theorem [ diracpresymplecticmanifold ] we have obtained a coordinate - independent description of @xmath1154 given in terms of @xmath1186 , @xmath1187 and @xmath456 , which proves in particular that it is well defined globally .",
    "it is straightforward to check that the condition @xmath1188 where @xmath13 , is equivalent to @xmath1189 which is clearly equivalent to equations ( [ nonholoeq])([nonholoeq3 ] ) .",
    "now that we have written the equations of motion as a dirac dynamical system , we can proceed to apply the cad .",
    "first , we can easily prove the following formulas using the definitions and proposition [ circperpd ] : @xmath1190 then we have @xmath1191    we could continue applying the algorithm as explained in general in section [ sectionconstalgforrdirac ] , and we would obtain specific formulas for @xmath1192 , etc .",
    "[ [ relationship - with - implicit - lagrangian - systems . ] ] relationship with implicit lagrangian systems .    in @xcite",
    "the description of a nonholonomic system as an _ implicit lagrangian system _ was introduced and equations of motion were shown to be a _ partial vector field _ written in terms of the _ dirac differential_. there is a close and simple relationship between this approach and the one of the present paper , which we shall explain next .",
    "first , we should recall the notion of an implicit lagrangian system .",
    "let @xmath1193 be a given lagrangian ; then @xmath1194 is a @xmath1195-form on @xmath1196 , @xmath1197 , which is locally expressed by @xmath1198 define a differential operator @xmath1199 , called the _ dirac differential _ of @xmath1200 , by @xmath1201 where @xmath1202 is the diffeomorphism defined by @xmath1203 here @xmath48 is the canonical @xmath1204-form on @xmath99 and @xmath1205 is the canonical isomorphism which is given in a local chart by @xmath1206 .",
    "we have the local expression @xmath1207 we must now recall the definition and properties of the dirac structure @xmath1208 on the manifold @xmath99 , where @xmath1155 is a given distribution on @xmath1152 , studied in propositions 5.1 and 5.2 of @xcite . let @xmath1209 be the canonical projection",
    ". then @xmath1210 is defined by @xmath1211 the dirac structure @xmath1208 is the one given by theorem [ diracpresymplecticmanifold ] , with @xmath1212 , @xmath1213 the canonical symplectic form on @xmath99 and @xmath1214 , and it is described by @xmath1215 now we will define the notion of an implicit lagrangian system .",
    "let @xmath1216 be a given lagrangian ( possibly degenerate ) and let @xmath1151 be a given regular _ constraint distribution _ on a configuration manifold @xmath1152 .",
    "denote by @xmath1208 the induced dirac structure on @xmath18 that is given by the equation ( [ eqmahi ] ) and write @xmath1217 for the dirac differential of @xmath1200 .",
    "let @xmath1218 be the image of @xmath1155 under the legendre transformation .",
    "an _ implicit lagrangian system _ is a triple @xmath1219 where @xmath254 represents a vector field defined at points of @xmath1218 , together with the condition @xmath1220 in other words , for each point @xmath1221 let @xmath1222 and then , by definition , @xmath1223 must satisfy @xmath1224    a _ solution curve _ of an implicit lagrangian system @xmath1225 is a curve @xmath1226 , @xmath1227 , which is an integral curve of @xmath254 where @xmath1228 .",
    "the following proposition is essentially proposition 6.3 of @xcite .",
    "[ idemahi ] the condition @xmath1229 defining an implicit lagrangian system is given locally by the equalities @xmath1230    it is clear that equations ( [ nonholomahi])([nonholomahic ] ) are equivalent to ( [ nonholoeq])([nonholoeq3 ] ) and also to ( [ nnhhooll1])([nnhhooll4 ] ) .",
    "this leads immediately to a precise link between the approach to nonholonomic systems given in @xcite and the one in the present paper , which is given in the next proposition whose proof in local coordinates is easy and will be omitted .",
    "recall that @xmath32 is the first constraint manifold given by ( [ constraintnonholo1 ] ) .",
    "[ link ] let @xmath1231 be a given lagrangian , @xmath1151 a given distribution and let @xmath1232 be given by @xmath1233 . then the following assertions hold .",
    "1 .   @xmath1234 .",
    "let @xmath1235 be a solution to ( [ nonholodirac ] ) ; then in particular one has @xmath1236 , and let @xmath1237 , that is , @xmath1238 .",
    "then @xmath1239 is a solution to ( [ diracdiffeq ] ) .",
    "a curve @xmath1240 is a solution curve of ( [ nonholodirac ] ) if and only if @xmath1241 is a solution curve of the implicit lagrangian system given by ( [ diracdiffeq ] ) .",
    "[ [ lc - circuits . ] ] lc circuits .",
    "+ + + + + + + + + + + +    this is a case of a constant dirac structure of the type explained in section [ sectionconstalgforrdirac ] .",
    "our approach is closely related and equivalent to the one described in @xcite .",
    "there are many relevant references where the structure of kirchhoff s laws has been studied from different points of view ; some of them emphasize the geometry behind the equations , see @xcite .",
    "we first briefly recall the description of lc circuits given in @xcite .",
    "let @xmath978 be a vector space representing _ the charge space _ ; then @xmath1242 is the _ current space _ and @xmath1243 is the _ flux linkage space .",
    "_ there is a constant distribution @xmath1244 ( that is , @xmath1155 is invariant under translations ) , which represents the _ kirchhoff s current law _ ( kcl ) .",
    "the subbundle @xmath1245 represents the _",
    "kirchhoff s voltage law _ ( kvl ) .",
    "one has a dirac structure on the cotangent bundle @xmath1246 , @xmath1247 given by @xmath1248 which clearly does not depend on @xmath1249 , in other words it is a constant dirac structure , so for each base point @xmath1249 we have @xmath1250 where @xmath1251",
    "the dynamics of the system is given by a lagrangian @xmath1252 .",
    "this lagrangian is given by a quadratic form on @xmath1253 representing the difference of the energies in the inductors and the capacitors , say , @xmath1254 where @xmath944 is the number of branches of the circuit .",
    "of course , some of the terms in the previous sum may be zero , corresponding to the absence of an inductor or a capacitor in the corresponding branch .",
    "+ one approach would be to use the time evolution of the circuit in terms of the dirac differential , given by equation ( [ diracdiffeq ] ) .",
    "this shows that dirac structures provide a unified treatment for nonholonomic systems and lc circuits . in other words",
    "the equation is @xmath1255 with @xmath1256 and @xmath1221 , where @xmath1257 represents the dirac differential of @xmath1200 .",
    "+ however , we will follow the philosophy of this paper and choose to work on @xmath1258 rather than working with the dirac differential .",
    "[ [ applying - the - cad - to - lc - circuits . ] ] applying the cad to lc circuits .",
    "it should be now clear how we can apply the constraint algorithm cad developed in the present paper to deal with lc circuits exactly as we did with the case of nonholonomic systems .",
    "more precisely , it should now be clear that an lc circuit can be described by the methods described in the first part of the paragraph _ nonholonomic systems _ ( beginning of section [ sectionexamples ] ) , by taking @xmath1259 , @xmath1260 and defining @xmath1154 and @xmath1261 as indicated in that paragraph .",
    "as we have already said , in the case of circuits the dirac structure @xmath1154 is constant and therefore integrable .",
    "however , we prefer not to work with the system restricted to a presymplectic leaf , as explained before , but to apply directly the algorithm for a general dirac structure , as we will explain next .",
    "+ define the linear maps @xmath1262 and @xmath1263 by @xmath1264 if there is no capacitor in a circuit branch , the corresponding component of @xmath1265 will be zero ( infinite capacitance ) , while zero capacitance is ruled out since it would represent an electrically open circuit branch .",
    "the physically relevant case corresponds to @xmath1266 , @xmath1267 , for @xmath1268 .",
    "however , the constraint algorithm applies to the general case where capacitances and inductances can be negative .",
    "the evolution equations ( [ nnhhooll1])([nnhhooll4 ] ) for a general nonholonomic system become @xmath1269 now we will apply the cad . first , note that @xmath1270    the first constraint submanifold is calculated as follows , taking into account the general expression ( [ e_d2 ] ) , @xmath1271 now we simply continue applying the algorithm .",
    "let @xmath1272 then @xmath1273 , denoted simply as @xmath1274 , is @xmath1275 and therefore @xmath1276 in the same way we can calculate @xmath33 . in fact , @xmath1277 @xmath1278 then @xmath1279 where we have called @xmath1280 now we shall calculate @xmath1281",
    ". we will show later that @xmath1282 for all lc circuits with either a positive inductance or a non - infinite positive capacitance on every branch ( lemma [ lemmafordeltaoneequaldeltatwo ] and theorem [ thm_positive_nu ] ) .",
    "first we compute @xmath1283 thus , one finds that @xmath1284 and hence @xmath1285 similarly we calculate @xmath1286 as follows .",
    "@xmath1287 let @xmath1288 ; then @xmath1289 and we can rewrite @xmath1290 as @xmath1291 then we have @xmath1292 @xmath1293 from this , one sees how to recursively define @xmath44 . for all",
    "@xmath1294 define @xmath1295 where @xmath1296 by definition .",
    "we have the following expressions for the constraint submanifolds @xmath44 .",
    "@xmath1297 in order to solve the system we may apply the method to solve the general equation ( [ gotaygen122 ] ) explained before .",
    "it is clear that the parametrization @xmath1298 , where @xmath538 is the dimension of the final constraint @xmath21 , can be chosen to be a linear map and the ide ( [ gotaygen122 ] ) will be a linear system .",
    "+ this system is of course still an ide .",
    "one of the purposes of this paper is to write hamilton s equations of motion , using an extension of the dirac procedure extended to primary foliated constraint submanifolds , developed in section [ sectionanextensionofetc ] . for this purpose",
    ", we will need to consider @xmath1299 as being the primary foliated constraint embedded naturally in the symplectic manifold @xmath1300 .",
    "[ [ physical - interpretation - of - the - constraint - equations - for - lc - circuits . ] ] physical interpretation of the constraint equations for lc circuits .",
    "the equations defining the constraint submanifolds have an interesting interpretation in circuit theory terms",
    ". from now on we will assume the physically meaningful situation where @xmath1301 , @xmath1302 , @xmath1268 .",
    "we will show that in this case , the algorithm stops either at @xmath32 or at @xmath33 .",
    "a circuit has an underlying directed graph , since each branch has a direction in which the current flow will be regarded as positive .",
    "a _ loop _ is a closed sequence of different adjacent branches .",
    "it also has a direction , which does not have to be compatible with the directions of the branches involved .",
    "the set of loop currents is a set of generators for the kcl subspace @xmath1303 .",
    "we shall call a circuit branch _ inductive _ ( resp .",
    "_ capacitive _ ) if there is an inductor ( resp .",
    "capacitor ) present on that branch . a loop will be called _ inductive _ ( resp .",
    "_ capacitive _ ) if it has an inductor ( resp .",
    "capacitor ) on at least one of its branches . a branch or loop that is capacitive but not inductive will be called _",
    "purely capacitive_. a branch or loop that is neither inductive nor capacitive will be called _ empty _ , since no capacitors or inductors are present .",
    "thus , a non - inductive branch or loop can be either empty or purely capacitive , and a purely capacitive loop must have at least one capacitor , no inductors , and possibly some empty branches .    the first one of the equations defining @xmath32 is @xmath1304 , which is @xmath1305 , @xmath1268 .",
    "the quantity @xmath1306 is the voltage corresponding to an inductor through which the current is @xmath1307 .",
    "then @xmath1308 can be interpreted as a time integral of the voltage on branch @xmath1309 due to the inductor in that branch ( the _ flux linkage _ of the inductor ) .",
    "the second equation , @xmath1310 , is just kcl for the currents @xmath1311 .",
    "the next constraint submanifold @xmath1312 incorporates the equation @xmath1313 , which represents the kvl equations for the purely capacitive loops , as explained in the next theorem .",
    "[ thm_kvlpc ] the subspace @xmath1314 represents kirchhoff s voltage law for non - inductive loops ( kvlni for short ) .",
    "that is , its elements are precisely those branch voltage assignments on the circuit that satisfy the subset of kvl equations corresponding to the non - inductive loops .",
    "the equation @xmath1315 represents the condition that on every purely capacitive loop , the branch voltages @xmath1316 of the corresponding capacitors satisfy kvl .",
    "we call these the kvlpc equations ( kvl for purely capacitive loops ) , and they form a subset of the kvlni equations .",
    "let @xmath1317 be the basis of @xmath978 where @xmath1318 is associated to branch @xmath1309 of the circuit , and let @xmath1319 be its dual basis .",
    "recall that the branch voltage assignments on the circuit are elements of @xmath1320 , and @xmath1321 represents kirchhoff s voltage law in the sense that each element of @xmath1321 is a branch voltage assignment satisfying kvl .",
    "the kvl equations are linear equations on the branch voltages and are therefore represented by elements of @xmath978 .",
    "in fact , they are precisely the elements of @xmath1322 .    consider a maximal set of independent , non - inductive oriented loops on the circuit , labeled @xmath1323 .",
    "each loop gives rise to a linear equation on the corresponding branch voltages according to kvl .",
    "these kvl equations are represented by @xmath1324 , and are a subset of the full kvl equations for the circuit .",
    "that is , these linear equations hold on any branch voltage assignment that is compatible with kvl , and therefore @xmath1325 .",
    "note that each @xmath1326 does not involve any inductive branches ; that is , if @xmath1327 then @xmath1328 . also , the kvlni equations @xmath1329 can be seen as the kvl equations for the circuit that is obtained by removing the inductive branches from the given circuit .",
    "let us call this _ the non - inductive subcircuit _ , whose charge space @xmath1330 is a subspace of @xmath978 in a natural way .",
    "also , @xmath1331 is generated by @xmath1332 where @xmath1309 ranges over all non - inductive branches .",
    "let us denote @xmath1333 the kcl distribution for the non - inductive subcircuit .",
    "note that @xmath1334 , since any kcl - compatible current assignment on the non - inductive subcircuit corresponds to a kcl - compatible current assignment on the original circuit for which no current flows through the inductive branches .",
    "reciprocally , elements of @xmath1155 that are zero on the inductive branches can be regarded as elements of @xmath1335 .",
    "note that @xmath1329 are loop currents for the non - inductive subcircuit , and they form a basis of @xmath1335 .    for any @xmath1336 , @xmath1337 .",
    "then for each @xmath1338 , @xmath1339 .",
    "this is true in particular for @xmath1340 , so @xmath1341 .",
    "therefore @xmath1342 .",
    "in other words , each @xmath1329 , seen as a linear equation on @xmath1320 , holds on @xmath1343 .",
    "let us see that @xmath1344 is precisely the vector subspace of @xmath1320 defined by the equations @xmath1329 .",
    "let @xmath1345 be another equation that holds on @xmath1344 . then @xmath1346 .",
    "since all inductances are nonnegative , this implies that the components of @xmath123 corresponding to the inductive branches must be zero .",
    "also , @xmath1347 , therefore @xmath1348 .",
    "this means that @xmath123 is a linear combination of @xmath1329 .",
    "the equation @xmath1315 means that @xmath1349 for @xmath1350 .",
    "only those @xmath1351 corresponding to purely capacitive loops give a condition on @xmath1352 .",
    "the remaining @xmath1353 correspond to empty loops , so @xmath1354 amounts to the equation @xmath1355 .",
    "the third constraint submanifold @xmath33 is obtained from @xmath1312 by incorporating the equation @xmath1356 , which means that the currents on the branches of the purely capacitive loops satisfy the same kvlpc equations as the charges .",
    "it is clear that it must hold when we consider the dynamics , which includes the equation @xmath1357 .",
    "suppose that there exists at least one purely capacitive loop so that the algorithm does not stop at @xmath32 .",
    "then it is possible to show that @xmath1358 . in order to do that ,",
    "consider a purely capacitive loop , which by definition must involve at least one capacitor , and recall that all the capacitances are positive .",
    "the corresponding kvlpc equation is represented by @xmath1359 , whose components are @xmath1360 or @xmath31 . as in the proof of the previous theorem , @xmath1361 ,",
    "so it can be interpreted as a nonzero loop current , that is , a current that is @xmath1360 on all the branches of that loop ( depending on the relative orientation of the branches with respect to the loop ) and zero on the remaining branches .",
    "note that @xmath1362 does not satisfy kvlpc , since in particular @xmath1363 , where the last sum is over the branches in the chosen loop .",
    "therefore @xmath1364 and @xmath1358 .",
    "+ now we will prove the interesting fact that since inductances are greater than or equal to zero and capacitances are positive numbers or @xmath1365 the algorithm always stops at @xmath33 ( or earlier ) .",
    "we shall start by proving the following lemma .",
    "[ lemmafordeltaoneequaldeltatwo ] * ( a ) * @xmath1366 is equivalent to the condition that there exists @xmath1367 such that @xmath1368 .",
    "+ * ( b ) * the condition @xmath1369 is equivalent to the following condition : + * condition * @xmath1370    for any @xmath1371 there exist @xmath1372 such that the following hold : @xmath1373    equivalently , we can say that for each @xmath1371 there exists @xmath1374 such that @xmath1375 .",
    "+ * ( c ) * condition @xmath1370 implies that if @xmath1376 then @xmath1377 .",
    "the proof of * ( a ) * is immediate taking into account the definitions . to prove * ( b ) * take any given @xmath1374",
    ", then it satisfies the condition @xmath1378 , where @xmath1367 . by condition",
    "@xmath1370 there exists @xmath1379 such that @xmath1380 , and we can conclude that @xmath1381 , which shows that @xmath1382 . the converse can be easily verified .",
    "now we shall prove * ( c)*. since the inclusion @xmath1383 is immediate by construction we will only prove the converse .",
    "let @xmath1384 then , in particular , there exists @xmath1371 such that @xmath1385 . by condition",
    "@xmath1370 there exists @xmath1386 such that @xmath1387 which implies that @xmath1388 , that is , @xmath1389 , from which we can deduce that @xmath1390 .",
    "the following theorem gives a sufficient condition under which condition @xmath1370 in the previous lemma holds , which considers the standard physically meaningful case .",
    "also , we assume for simplicity that there are no empty branches . we should mention that it can be proven that even with empty branches , the algorithm stops at @xmath32 or @xmath33 .",
    "[ thm_positive_nu ] condition @xmath1370 in lemma [ lemmafordeltaoneequaldeltatwo ] holds if in every branch there is either a positive inductance or a non - infinite positive capacitance .",
    "condition @xmath1370 can be reformulated as follows :    for any @xmath1371 there exists @xmath1372 such that the following equalities are satisfied @xmath1391for all @xmath1392 .",
    "this formulation has the advantage that @xmath1393 is nonsingular .",
    "the basis @xmath1394 , @xmath1395 of the charge space @xmath978 defines naturally an euclidean metric by the condition @xmath1396 and an identification @xmath1397 by the condition @xmath1398 , @xmath1395 , in particular obtains @xmath1399 .",
    "the linear map @xmath1400 is self - adjoint and positive definite while @xmath55 is self - adjoint and positive semi - definite .",
    "system ( [ lemmadeltasuboneaprime])([lemmadeltasubonebprime ] ) can be written in the form @xmath1401where @xmath1402 is the orthogonal projection on @xmath1155 .",
    "one can choose an orthonormal basis of @xmath1155 and then the system of equations ( [ lemmadeltasuboneaprime])([lemmadeltasubonebprime ] ) can be written in matrix form .",
    "moreover we have an orthogonal decomposition @xmath1403 , where @xmath1404 and @xmath1405 are the image and the kernel of @xmath1406 .",
    "each vector @xmath1371 is decomposed as @xmath1407 .",
    "we can choose the basis in such a way that the block decomposition of the matrix representing @xmath1408 has the form @xmath1409,\\ ] ] where @xmath1410 and @xmath1411 is a diagonal matrix with positive eigenvalues .",
    "the map @xmath1412 also has a block decomposition , and since it is self - adjoint and positive definite , the blocks @xmath1413 and @xmath1414 are symmetric and positive definite matrices .",
    "we obtain the following system of equations , which is equivalent to ( [ lemmadeltasuboneaprime])([lemmadeltasubonebprime ] ) , @xmath1415   \\left [ \\begin{array}{c } \\delta_1^{(1)}\\\\ \\delta_1^{(2)}\\end{array}\\right ] & = \\left[\\begin{array}{cc } \\varphi^{(1,1)}&\\varphi^{(1,2)}\\\\ \\varphi^{(2,1)}&\\varphi^{(2,2 ) } \\end{array } \\right ]   \\left[\\begin{array}{c } \\delta^{(1)}\\\\ \\delta^{(2)}\\end{array}\\right]\\\\ % \\label{positiveinductancesand capacities2 } \\left[\\begin{array}{cc } \\nu^{(1,1)}&\\nu^{(1,2)}\\\\ \\nu^{(2,1)}&\\nu^{(2,2 ) } \\end{array } \\right ]   \\left [ \\begin{array}{c } \\delta_1^{(1)}\\\\ \\delta_1^{(2)}\\end{array}\\right ] - \\left[\\begin{array}{cc } \\varphi^{(1,1)}&\\varphi^{(1,2)}\\\\ \\varphi^{(2,1)}&\\varphi^{(2,2 ) } \\end{array } \\right ]   \\left[\\begin{array}{c } \\delta_0^{(1)}\\\\ \\delta_0^{(2)}\\end{array}\\right ] & = \\left[\\begin{array}{cc } \\varphi^{(1,1)}&\\varphi^{(1,2)}\\\\ \\varphi^{(2,1)}&\\varphi^{(2,2 ) } \\end{array } \\right ]   \\left[\\begin{array}{c } \\delta^{(1)}\\\\ \\delta^{(2)}\\end{array}\\right]\\end{aligned}\\ ] ] for given @xmath1416 , equation ( [ positiveinductancesand capacities1 ] ) fixes @xmath1417 and imposes no condition on @xmath1418 . using the fact that @xmath1411 and @xmath1414 are invertible we can find @xmath1419 and @xmath1418 to satisfy ( [ positiveinductancesand capacities2 ] ) .    as a conclusion , if ( and only if ) there are no purely capacitive loops in the circuit , then @xmath1420 and the final constraint submanifold is @xmath32 , defined by the conditions that @xmath1305 ( where some @xmath1421 might be zero ) and @xmath1311 satisfies kcl .",
    "otherwise , the final constraint submanifold is @xmath33 , defined by the conditions that @xmath1305 , @xmath1311 satisfies kcl , and @xmath1316 and @xmath1422 satisfy kvlpc . recall that @xmath1316 is the voltage of the capacitor in branch @xmath1309 , and the absence of a capacitor on branch @xmath1309 means @xmath1423 .",
    "the rest of the kvl equations , which involve the branch voltages @xmath1424 on the inductors , will appear when considering the dynamics . in this sense , the kvlpc equations can be regarded as `` static '' kvl equations .    the hypothesis that no capacitances or inductances are negative , besides being physically meaningful , is crucial to ensure that the algorithm stops at @xmath33 ( or @xmath32 ) .",
    "for example , for a circuit with one inductor @xmath1425 , one capacitor @xmath623 and a negative capacitor @xmath1426 , all of them in parallel , it stops at @xmath1286 .",
    "[ [ geometry - of - the - final - constraint - submanifold . ] ] geometry of the final constraint submanifold .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we know that the solution curves will have tangent vectors in @xmath1427 , where @xmath1428 or @xmath1429 depending on the case .",
    "assume the physically meaningful situation where @xmath1430 , @xmath1267 , @xmath1431 .",
    "the distribution @xmath1432 is constant and therefore integrable , and its integral leaves are preserved by the flow .",
    "denote the leaf through @xmath31 by @xmath1433 , so these leaves can be written as @xmath1434 , where @xmath1435 .",
    "each integral leaf @xmath1434 is a symplectic manifold with the pullback of the presymplectic form @xmath1436 , if and only if there are no empty loops .    as mentioned before , if there are no purely capacitive loops , then @xmath1428 , otherwise @xmath1429 .",
    "for the first case , using , we have @xmath1437 then @xmath1438 is a constant and therefore integrable distribution whose rank is @xmath1439 .",
    "write @xmath1440 for the pullback of the presymplectic form @xmath1436 to each integral leaf .",
    "let us compute @xmath1441 .",
    "consider @xmath1442 , where @xmath1443 are arbitrary .",
    "assume @xmath1444 , that is , @xmath1445 for any @xmath1446 .",
    "this means that @xmath1447 , but since they also belong to @xmath1155 then @xmath1448 .",
    "that is , @xmath1441 is defined by @xmath1449 , @xmath1450 .",
    "the subspace @xmath1451 is generated by the loop currents on the non - inductive loops ( theorem [ thm_kvlpc ] ) .",
    "since there are no purely capacitive loops , then it is generated by the loop currents on the empty loops . as a conclusion",
    ", @xmath1452 is symplectic if and only if there are no empty loops on the circuit .",
    "if there is at least one purely capacitive loop , then the final constraint submanifold is @xmath33 .",
    "then @xmath1453 again , @xmath1454 is a constant and therefore integrable distribution whose rank is @xmath1455 .",
    "write @xmath1456 for the pullback of the presymplectic form @xmath1436 to each integral leaf , and let us compute @xmath1457 .",
    "consider @xmath1458 , where @xmath1459 are arbitrary .",
    "assume @xmath1460 , that is , @xmath1445 for any @xmath1461 .",
    "this means that @xmath1462 . if there is an empty loop , represented by @xmath1463 , then @xmath1464 , @xmath1465 and @xmath1466",
    "also , @xmath1467 , so @xmath1468 is a nonzero element of @xmath1469 and @xmath1470 is not symplectic .",
    "if there are no empty loops , we apply the following argument to @xmath1471 , and the same conclusion holds for @xmath1472 . since @xmath1473 , then @xmath1474 , which means that the components of @xmath1475 corresponding to the inductive branches are zero , as we reasoned in the proof of theorem [ thm_kvlpc ] .",
    "also , @xmath1476 , so @xmath1477 , that is , it can be regarded as a branch current assignment on the non - inductive subcircuit , satisfying kcl .",
    "in addition , @xmath1478 satisfy kvlni , which means that @xmath1478 satisfy kvl for the non - inductive subcircuit .",
    "now we will apply the fact that the dynamics of a circuit with no inductors and no empty loops consists only of equilibrium points .",
    "indeed , kvl for such a circuit is a homogeneous linear system on the charges @xmath1479 of the capacitors , so it has a solution @xmath1480 . setting @xmath1481 and @xmath1482",
    ", we have that @xmath1311 satisfies kcl trivially .",
    "if there was a nonzero loop current @xmath1483 , then it would produce a change @xmath1484 in the charges of the capacitor on that loop .",
    "then they would no longer satisfy kvl for that loop , since @xmath1485 .",
    "then the currents must therefore be zero , that is , @xmath1486 .",
    "of course , this is not true if there are empty loops , which can have arbitrary loop currents . by the same reasoning , @xmath1487 , so @xmath1488 and @xmath1470 is symplectic .",
    "let us now write equations of motion in hamiltonian form , by working on a symplectic leaf .",
    "this means that the initial conditions must belong to that particular leaf .",
    "this is related to the comments on equations ( [ equation15 ] ) and ( [ sequationalgorithgn ] ) made before .",
    "an equation of motion in poisson form that is valid for all initial conditions in @xmath21 will be given in theorem [ thm321extended ] by the equations and .",
    "first , let us represent the kcl equations by @xmath1489 , in the sense that @xmath1490 represents the kcl equation corresponding to node @xmath1309 .",
    "the number @xmath1491 is the number of independent nodes ( usually the number of nodes minus one ) .",
    "as before , denote the kvlpc equations by @xmath1492 , where @xmath1493 is the number of independent purely capacitive loops . seeing each @xmath1494 as a row vector and each @xmath1351 as a column vector ,",
    "write @xmath1495,\\quad\\quad\\quad \\gamma=\\left[\\begin{array}{ccc } \\eta_1 & \\dots & \\eta_b \\end{array } \\right].\\ ] ]    the space @xmath1258 with the presymplectic form @xmath5 is embedded in @xmath1496 with the canonical symplectic form ( see appendix [ pontryagin_embedding ] ) , where the variables are @xmath51 . the integral leaf @xmath1497 , where @xmath1428 or @xmath1429 as before , and @xmath1498 , is defined as a subspace of @xmath1496 regularly by the equations @xmath1499 and the matrix of poisson brackets of these constraints is , in block form , @xmath1500,\\ ] ] where @xmath55 and @xmath807 stand for the diagonal matrices with @xmath1421 and @xmath1501 along their diagonals , respectively .    [ [ a - concrete - example . ] ] a concrete example .",
    "+ + + + + + + + + + + + + + + + + + +    we shall illustrate our method with the simple lc circuit studied in @xcite which is shown in figure [ circuitfigure ] .",
    "it is a @xmath1502-port lc circuit where the configuration space is @xmath1503 .",
    "we shall use the notation @xmath1504 , @xmath1505 , and @xmath1506 .",
    "the lagrangian of the lc circuit is @xmath1507 , @xmath1508 we will assume the physically meaningful case where @xmath1509 and @xmath1510 , @xmath1511 .",
    "then , by theorem [ thm_positive_nu ] , the cad algorithm will stop at most at @xmath33 .",
    "also , theorem [ thm_kvlpc ] gives a direct description of the specific equations that define @xmath32 , @xmath1312 and @xmath33 .",
    "this circuit has a purely capacitive loop , so @xmath1512 .",
    "however , the algorithm could also be applied for the case where negative values for @xmath1425 or @xmath1513 are allowed . for this particular circuit ,",
    "the algorithm stops at @xmath33 regardless of the signs of the inductance and capacitances .",
    "the kcl constraints @xmath1514 for the current @xmath1311 are @xmath1515 therefore the constraint kcl space is defined , for each @xmath1516 , by @xmath1517 where @xmath1518 on the other hand , the annihilator @xmath1519 of @xmath1155 is the constraint kvl space , defined , for each @xmath1516 , by @xmath1520 note that @xmath1521 is a basis of @xmath1519 .",
    "taking into account that the dirac structure @xmath1522 on @xmath1523 associated to the space @xmath1524 is , for each @xmath1525 , given by @xmath1526 and the corresponding energy @xmath1527 , is given by @xmath1528 , we can easily verify that the dirac dynamical system @xmath1529 is equivalent to the ide system that is given in coordinates by ( [ cnnhhooll1])([cnnhhooll4 ] ) , which gives @xmath1530 we now apply the constraint algorithm cad for dirac dynamical systems .",
    "we calculate the expressions of @xmath1531 to get @xmath1532 from now on we will consider the constant distribution @xmath1155 as a subspace of @xmath978 . as we have seen before @xmath1533 , so using ( [ kclconstcoord1])([kclconstcoord2 ] ) and the expression for @xmath55 we get @xmath1534 we could calculate @xmath1312 using the expression ( [ mdos ] ) .",
    "however , according to theorem [ thm_kvlpc ] , @xmath1312 adds one more constraint , corresponding to the kvl for the purely capacitive loop that involves capacitors @xmath1535 and @xmath1536 .",
    "then @xmath1537 as explained right after the proof of theorem [ thm_kvlpc ] , the final constraint submanifold @xmath33 adds the constraint @xmath1538 : @xmath1539 to solve the system we can simply parametrize @xmath33 , which has dimension @xmath1502 , for instance by taking some appropriate @xmath1502 of the @xmath1540 variables @xmath1541 as being independent parameters and then replace in equations ( [ idecircuiti])([idecircuitiii ] ) to obtain an ode equivalent to equations of motion .",
    "for instance , if we choose @xmath1542 , @xmath1543 , @xmath1544 , @xmath1545 , as independent variables we get the ode @xmath1546    we know that solutions should be tangent to @xmath1547 where , according to ( [ e_d1 ] ) , @xmath1548 is defined by the conditions @xmath1549 , that is , @xmath1550 therefore @xmath1551 is defined by ( [ deltaequation ] ) together with the equations defining @xmath1552 which are obtained by differentiating with respect to time the equations ( [ mtresej ] ) defining @xmath33 , that is , @xmath1553 then @xmath1551 is a constant and therefore integrable distribution of rank 2 .",
    "its integral leaves are preserved by the flow .",
    "one can check that the pullback of the presymplectic form @xmath1554 to each leaf is nondegenerate , so they are symplectic manifolds .",
    "denote @xmath1555 , so these leaves can be written as @xmath1470 .    for a given @xmath1556 ,",
    "say @xmath1557 we have that elements of the symplectic leaf @xmath1558 are characterized by the conditions defining @xmath33 plus the condition obtained by integrating with respect to time the conditions ( [ kclconstcoord1 ] ) and ( [ kclconstcoord2 ] ) , applied to @xmath1559 , that is @xmath1560    for simplicity , we will assume from now on that the conditions @xmath1561 are satisfied . while this is not the most general case , it is enough to illustrate the procedure .",
    "+ we can conclude that @xmath1558 has dimension @xmath1204 and in fact the projection @xmath1562 is simply the subspace of @xmath1563 defined by the conditions @xmath1564 and @xmath1565 .",
    "therefore one can use the variables @xmath1566 to parametrize @xmath1567 , and , in fact , we obtain @xmath1568 let @xmath1558 be defined by @xmath1569 , @xmath1570 , where we have chosen @xmath1571    we can calculate the matrix @xmath1572 as @xmath1573 , \\ ] ] which is invertible , with inverse @xmath1574 , then @xmath1575 .",
    "this means that @xmath1576 is a second class submanifold , or equivalently , that all the constraints are second class .",
    "in particular , @xmath1576 is a symplectic submanifold , and we will call the symplectic form @xmath154 .",
    "then we have two ways of writing equations of motion on this submanifold .",
    "on one hand , we can write the equations of motion on the symplectic manifold @xmath1558 in the form , @xmath1577 for this we are going to use the previous parametrization of @xmath1578 with coordinates @xmath1542 , @xmath1545 , so @xmath1579 . since the lagrangian is given by @xmath1580 in terms of the parametrization the energy @xmath1581 restricted to @xmath1558",
    "is @xmath1582 then the vector field @xmath1583 is given in coordinates @xmath1542 , @xmath1545 by @xmath1584 with @xmath1585 , for short .",
    "we remark that the previous equations can easily be deduced by elementary rules of circuit theory .",
    "namely , one can use the formulas for capacitors in parallel and series and replace the three capacitors by a single one .",
    "the resulting circuit is very easy to solve , and the corresponding system is equivalent to equations ( [ simplest1 ] ) and ( [ simplest2 ] ) .",
    "however , we must remark that this simplified system no longer accounts for the currents and voltages on the original capacitors .",
    "+ on the other hand , we can find the evolution of all the variables @xmath1586 using the extended energy ( [ extendedenergy ] ) rather than the total energy , since @xmath1558 is symplectic and using the last paragraph of remark [ physicalstate ] .",
    "namely , we will calculate the vector field @xmath1587 associated to the extended energy .",
    "we have @xmath1588 , @xmath1570 , where the column vector @xmath1589 $ ] is @xmath1590=\\left[0,\\,-\\frac{q_{c_1}}{c_1},\\,-\\frac{q_{c_2 } } { c_2},\\,-\\frac{q_{c_3}}{c_3 } , \\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0,\\,0\\right]^{t}.\\ ] ] for instance , we can calculate @xmath1591 and @xmath1592 as @xmath1593 the complete coordinate expression of @xmath254 is @xmath1594 note that this is not a hamiltonian vector field . however , if we use theorem [ theorem321 ] , we can write the equations of motion in terms of the dirac bracket and the abridged total energy corresponding to the chosen leaf @xmath1558 . in section [ sectionanextensionofetc ]",
    "we will return to lc circuits and show how to write equations of motion on @xmath21 without specifying any leaf _ a priori _ , by using an abridged total energy and the dirac bracket associated to adapted constraints .",
    "+ we remark that it is not always the case that there is uniqueness of solution . in fact , several branches of the circuit may be present with no capacitors or inductors , as a limit case . in the next section",
    "we show how to write a poisson bracket description of the solution .",
    "in sections [ section7 ] and [ mainresultsofdiracandgotaynester ] , under precise regularity conditions , we studied several geometric and algebraic objects related to the dirac theory of constraints like primary and final constraints , first class and second class constraints , dirac brackets , first class and second class constraint submanifolds .",
    "the notions of first class and second class depend only on the final constraint submanifold @xmath21 and they do not depend on the primary constraint submanifold or the hamiltonian , which are needed only to write equations of motion . then , as we have already said at the beginning of section [ subsectionv ] , in order to study those notions one can start with an abstract situation , given by a symplectic manifold @xmath512 and an arbitrary submanifold @xmath513 , to be thought of as the final constraint submanifold .    in this section , motivated by integrable nonholonomic mechanics and lc circuits theory , we extend those studies by replacing @xmath433 by a submanifold @xmath1595 regularly foliated by submanifolds @xmath433 .",
    "this means that @xmath1596 and the map @xmath1597 given by @xmath1598 iff @xmath562 is a submersion . to study the dynamics",
    ", one should consider a primary _ regularly foliated _ constraint submanifold @xmath1599 whose leaves @xmath795 satisfy the condition @xmath1600 , and an energy @xmath1601 .",
    "the meaning of @xmath1602 can be interpreted in connection with the constraint algorithm cad for a dirac dynamical system ( [ 11drracds ] ) on the manifold @xmath0 in the case in which the dirac structure @xmath943 is integrable , which gives a foliation of @xmath0 .",
    "we should compare @xmath1602 with the foliated submanifold @xmath21 appearing in remark [ importantremark ] , while @xmath1599 should be compared with @xmath0 as a submanifold of @xmath62 .",
    "the results in section [ subsectionequationsof motion ] can be extended for a certain kind of dirac dynamical systems .",
    "namely , let @xmath1603 as before .",
    "consider each leaf @xmath1604 endowed with the presymplectic form @xmath1605 obtained as the pull - back of @xmath48 .",
    "assume that the distribution @xmath1606 is regular and its dimension does not depend on @xmath623 .",
    "define the dirac structure @xmath943 on @xmath1607 by declaring that its presymplectic leaves are @xmath1608 .",
    "we will consider the dirac dynamical system for the case @xmath1609 , that is , @xmath1610 the results in section [ subsectionequationsof motion ] would correspond to the case in which the foliation of @xmath1602 consists of a single leaf .",
    "[ [ description - of - primary - and - final - foliated - constraint - submanifolds . ] ] description of primary and final foliated constraint submanifolds .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath60 be a symplectic manifold .",
    "we are going to describe the _ primary foliated constraint submanifold _ @xmath1599 and the _ final foliated constraint submanifold _ @xmath1602 of @xmath62 .",
    "we will assume that there is a one to one correspondence between the foliations such that for each leaf @xmath1611 the corresponding leaf of @xmath1602 is @xmath1612 .",
    "a motivation for this assumption comes from mechanics , where an energy on @xmath62 is given . in that context",
    ", each leaf @xmath1613 is the final constraint submanifold corresponding to the primary constraint submanifold @xmath1614 after applying a constraint algorithm .",
    "these leaves will be parametrized by a certain vector @xmath623 , and we will denote them by @xmath1604 and @xmath1615 respectively .",
    "we are going to work on a suitable neighborhood @xmath1616 of @xmath1607 in @xmath62 , where all these submanifolds can be defined regularly by equations , as we will describe next .    for convenience",
    ", we will work with a more general situation where @xmath1607 is a member of a _ family _ of primary foliated constraint submanifolds parameterized by a certain vector @xmath1617 and @xmath1602 is a member of a corresponding family of final foliated constraint submanifolds parameterized by a certain vector @xmath1618 . for @xmath1619 and @xmath1620",
    "we obtain @xmath1607 and @xmath1602 , respectively .",
    "let @xmath1621 be a generic point of @xmath1622 , where @xmath1623 .",
    ". then we assume the following definitions by equations ( regularly on @xmath1616 ) of the submanifolds @xmath1625 and @xmath1626 and their foliations by leaves @xmath1627 and @xmath1615 respectively , which satisfy @xmath1628 , namely , @xmath1629 since for each primary constraint submanifold @xmath1604 there is only one final constraint submanifold @xmath1615 , then @xmath1630 must be a function of @xmath1631 , and without loss of generality",
    "we will assume that this function maps 0 to 0 .",
    "then for fixed @xmath1617 , @xmath1632 is also fixed and one has , for each choice of @xmath1633 , one leaf @xmath1627 of @xmath1625 and the corresponding leaf @xmath1628 of @xmath1626 .",
    "[ assumptionfoliation ] from now we assume that our foliated submanifolds @xmath1599 and @xmath1602 are @xmath1625 and @xmath1626 for the choice @xmath1634 and @xmath1635 , respectively , while the leaves @xmath795 and @xmath433 are the leaves @xmath1627 and @xmath1615 respectively , for the choice @xmath1636 , and @xmath1637 varying arbitrarily , that is , @xmath1638 ( see figure  [ fig : foliation ] )",
    ".     is foliated by the submanifolds @xmath1639 , while @xmath1602 is foliated by @xmath1640 . here",
    "we depict the leaves for two values @xmath623 and @xmath1641 . ]    the case considered by dirac , studied in section [ mainresultsofdiracandgotaynester ] , corresponds to @xmath1642 .",
    "it is in this sense that our theory extends dirac s . in this case , the primary constraint @xmath1643 and the final constraint @xmath1602 have only one leaf .",
    "more precisely , this particular case has been studied in lemma [ mainlemma1section7 ] , with a different notation .",
    "our extension takes care of those dirac dynamical systems coming for instance from integrable nonholonomic systems or lc circuit theory .",
    "[ [ equations - of - motion - as - a - collection - of - hamiltons - equations . ] ] equations of motion as a collection of hamilton s equations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let us adopt the point of view that the dirac dynamical system ( [ diracdirac2 ] ) is a collection of gotay - nester systems , one for each leaf , namely @xmath1644 where @xmath1645 , for all @xmath1646 .",
    "then one can apply the theory developed in section [ subsectionequationsof motion ] leaf by leaf . for each @xmath1647 , the total hamiltonian defined in",
    "should be replaced by the total energy depending on @xmath623 , by definition , @xmath1648 and , for each such @xmath623 , the @xmath1649 , @xmath1650 must satisfy the conditions @xmath1651 , @xmath1652 , for each @xmath1653 or , equivalently , @xmath1654 for each @xmath1655 .",
    "this shows in particular the interesting fact that the set of solutions , which is an affine space , depends on @xmath37 but not on @xmath623 .",
    "we assume , as part of our regularity conditions , that the solutions @xmath1656 form a nonempty affine bundle @xmath1657 .",
    "since we are working locally , by shrinking @xmath1616 conveniently we can assume that this bundle is trivial .",
    "furthermore , we extend this bundle arbitrarily to a trivial affine bundle over @xmath1616 , which we continue to denote @xmath1658 .",
    "note that for each @xmath623 , the total energy can be seen as a function @xmath1659 .    for each section @xmath1660 of @xmath817",
    "one can define @xmath1661 , that is , @xmath1662 .",
    "one has an equation of motion on @xmath1616 , @xmath1663 which should be interpreted properly , as follows . in the definition of @xmath1664 , @xmath37 and @xmath623",
    "are independent variables . for a given @xmath1665 ,",
    "let @xmath1666 ; then @xmath1667 is a function of @xmath37 and @xmath1668 this means that equation ( [ c - equationofmotion ] ) should not be naively interpreted as hamilton s equation , and therefore the algorithms devised by dirac and gotay - nester can not be generalized in a direct way for the foliated case .",
    "in fact , even though the variable @xmath623 is a function of @xmath37 , it should be considered a constant in order to calculate the vector field at the point @xmath37 .",
    "note that , by construction , the condition @xmath1669 is satisfied , which means that the leaves @xmath1670 of @xmath1602 are preserved by the motion , as expected .",
    "for any given solution @xmath24 of equations of motion ( [ wizardequationofmotion ] ) there exist uniquely determined @xmath1671 , @xmath1650 such that @xmath1672 on the other hand , for any given time - dependent section @xmath1673 , @xmath1650 of @xmath817 one has a time - dependent vector field @xmath1674 whose integral curves are solutions to the equations of motion",
    ". one can show that under the strong regularity conditions that we assume in this paper , all the solutions of the equations of motion can be represented in this way , at least locally .",
    "summarizing , the vector fields obtained from are not in general hamiltonian vector fields with respect to the canonical bracket , as we have indicated before .",
    "now we will see how to recover the hamiltonian character of the equation of motion .",
    "we are going to write it as hamilton s equation in terms of a certain poisson bracket whose symplectic leaves are isomorphic to @xmath1616 .    [ [ equations - of - motion - in - terms - of - a - poisson - bracket . ] ] equations of motion in terms of a poisson bracket .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let us consider an extended poisson manifold , namely the product poisson manifold @xmath1675 with the canonical poisson bracket @xmath1676 on @xmath1616 and the @xmath31 poisson bracket on @xmath1677 .",
    "let @xmath1678 be defined by @xmath1679 . given a section @xmath1660 of @xmath817 one can define an energy function @xmath1680 as @xmath1681 .",
    "consider its corresponding hamiltonian vector field @xmath1682 on @xmath1683 with respect to the poisson bracket @xmath1684 , where @xmath1685 is defined in .",
    "we remark that even though the first component can not be interpreted in general as a hamiltonian vector field on @xmath1616 , as we have observed before , @xmath1686 is hamiltonian on the extended poisson manifold .    consider the function @xmath1687 defined on @xmath1616 . clearly , @xmath1688 is a submanifold of @xmath1689 diffeomorphic to @xmath1616 .",
    "since @xmath1690 preserves @xmath1615 for each @xmath623 , it is straightforward to prove that @xmath1686 preserves @xmath1691 , which for each @xmath623 is a copy of the level set @xmath1692 embedded in @xmath1693 , and therefore @xmath1686 preserves @xmath1694 , which is a copy of @xmath1602 .",
    "consider the evolution equation for a quantity @xmath148 on @xmath1693 given by @xmath1695 note that this is an equation in poisson form on @xmath1693 , not on @xmath1696 .",
    "note that for @xmath1697 and @xmath891 , then @xmath1698 and we recover the situation in dirac s theory , where hamilton s equations of motion are written in a neighborhood of the final constraint submanifold in @xmath99 rather than on the constraint submanifold itself .",
    "[ [ local - equations - of - motion - in - poisson - form - with - respect - to - the - dirac - bracket . ] ] local equations of motion in poisson form with respect to the dirac bracket .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as we have remarked above , the equations of motion in terms of the canonical bracket for the foliated case are not naive extensions of the dirac or gotay - nester procedures .",
    "a similar situation occurs with the equation @xmath1699^*$ ] in @xcite , page 42 . as we will show next",
    ", we can extend this equation to the foliated case by using adapted constraints and the abridged total energy .    in the definition of @xmath1700 and @xmath1615",
    "take @xmath1701 .",
    "then we can apply the procedure of section [ subsectionequationsof motion ] with @xmath1702 and @xmath1703 , and obtain second class constraints @xmath1704 among @xmath798 , @xmath1705 adapted to @xmath1706 and also we can choose some primary constraints among @xmath1707 , say w.l.o.g .",
    "@xmath1708 , @xmath1709 .",
    "observe that here @xmath1710 has the same meaning as in section [ subsectionequationsof motion ] , this time considering the constraints @xmath1711 .",
    "then the equations of motion on @xmath1712 can be written in the form ( [ eq : poisson_dirac_evolution_thm ] ) .",
    "now , for any small enough @xmath623 , which defines @xmath1615 , one can readily see that @xmath1713 are second class constraints adapted to @xmath1604 where @xmath1714 are the components of @xmath623 corresponding to the choice @xmath1715 .",
    "this implies immediately that the dirac bracket for @xmath1615 does not depend on @xmath623 . on the other hand ,",
    "each @xmath1716 , @xmath1709 , is a primary constraint for @xmath1700 .    using the previous facts and the fact that the @xmath1717 are arbitrary ( even time - dependent ) parameters ,",
    "as it happens with the @xmath887 in equation ( [ eq : poisson_dirac_evolution_thm ] ) , one can conclude that the equation of motion on each @xmath1615 is given by @xmath1718 sum over @xmath1709 .",
    "this means in particular that each @xmath1615 is preserved by the motion , or that the hamiltonian vector fields @xmath1719 defined on @xmath551 , are tangent to the @xmath1615 .",
    "note that @xmath1720 is the abridged total energy @xmath1721 for @xmath1712 and @xmath1722 as defined in ( [ abridged_total_energy ] ) .",
    "in conclusion , using adapted constraints , the abridged total energy and the dirac bracket yields a very simple procedure for writing the equations of motion , because one only needs to write the abridged total energy for one leaf , say @xmath1723 , and gives the equation of motion for all nearby leaves .",
    "we have proven the following theorem , which extends theorem [ theorem321 ] .",
    "[ thm321extended ] let @xmath60 be a symplectic manifold and let @xmath1724 be given primary and final foliated constraint submanifolds , with leaves @xmath1604 and @xmath1725 , respectively , as described by ( [ defofc])([cals ] ) .",
    "assume that all the hypotheses of theorem [ theorem321 ] are satisfied for the submanifolds @xmath1726 .",
    "in addition , suppose that the number @xmath848 appearing in assumption [ lambda ] is the same for all @xmath1615 for @xmath623 close enough to @xmath31 .",
    "from the validity of assumption [ 2s_constant ] for @xmath1722 , it is immediate to see that the number @xmath108 is also the same for all @xmath1604 for @xmath623 close enough to @xmath31 . choose second class constraints @xmath1727 adapted to @xmath1722 and also @xmath1728 , @xmath1709 , as in theorem [ theorem321 ] .",
    "let @xmath1729 be an energy function , and consider the dirac dynamical system .",
    "define the abridged total energy @xmath1730 for @xmath1712 and @xmath1722 as in theorem [ theorem321 ] .",
    "then , each @xmath1731 has an open neighborhood @xmath551 such that the vector field @xmath1732 ( equation ) defined on @xmath551 , when restricted to the final foliated constraint submanifold @xmath1733 , represents equations of motion of the dirac dynamical system on @xmath1733 .",
    "moreover , the evolution of the system preserves the leaves @xmath1734 .",
    "in addition , equation gives equations of motion on each @xmath1734 .",
    "since @xmath1732 is tangent to @xmath1734 , then the evolution of a function @xmath374 on @xmath1734 is given by for any @xmath148 such that @xmath1735 .",
    "also , each @xmath1734 is contained in a unique symplectic leaf of the dirac bracket , defined by @xmath1736 .",
    "@xcite , wrote the equation @xmath1737 which represents the dynamics on the final constraint submanifold , in terms of the total hamiltonian and the dirac bracket .",
    "this equation does not gives the correct dynamics for the case of foliated constraint submanifolds . as we have seen , for the foliated case , one has , instead a similar equations of motion ( [ eq : poisson_dirac_evolution_thmfoliated ] ) in terms of the dirac bracket and the abridged total energy @xmath1721 .",
    "[ [ the - concrete - example - of - an - lc - circuit - of - section - sectionexamples - revisited . ] ] the concrete example of an lc circuit of section [ sectionexamples ] revisited .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    consider the symplectic leaf @xmath433 of @xmath33 defined parametrically by equations ( [ parametrizationofsymplleaf1])([parametrizationofsymplleaf5 ] ) .",
    "the parameter space carries the canonical symplectic form @xmath1738 , which coincides with the pullback of the canonical symplectic form on @xmath1739 to the parameter space .",
    "since the matrix @xmath1740 is invertible , all constraints are second class constraints .",
    "the number @xmath1741 in equation ( [ eq : poisson_dirac_evolution_thmfoliated ] ) is @xmath31 , then the abridged total energy is simply the energy @xmath3 .",
    "then it is easy to calculate the dirac bracket as the canonical bracket on the parameter space of the functions ( [ parametrizationofsymplleaf1])([parametrizationofsymplleaf5 ] ) .",
    "let @xmath1742 , then the matrix of dirac brackets of these variables can be written in block form as @xmath1743\\ ] ] where @xmath1744 % q_c1   \\frac{c_1}{(c_1 + c_3)l } &   \\frac{c_1 ^ 2}{(c_1 + c_3)^2",
    "l } &   \\frac{c_1}{(c_1 + c_3)l } &    \\frac{c_1 c_3}{(c_1 + c_3)^2 l } &   \\frac{c_1}{(c_1 + c_3 ) } \\\\[6pt ] % q_c2   \\frac{1}{l } &   \\frac{c_1}{(c_1 + c_3)l } &   \\frac{1}{l } &   \\frac{c_3}{(c_1 + c_3)l } & 1   \\\\[6pt ] % q_c3   \\frac{c_3}{(c_1 + c_3)l } &   \\frac{c_1 c_3}{(c_1 + c_3)^2 l } &   \\frac{c_3}{(c_1 + c_3)l } &    \\frac { c_3 ^ 2}{(c_1 + c_3)^2",
    "l } & \\frac{c_3}{(c_1 + c_3 ) } \\end{array}\\right].\\ ] ]    the evolution equations for the vector @xmath1745 with initial condition belonging to @xmath33 , that is , satisfying ( [ mtresej ] ) : @xmath1746 , is given by the product of the matrix @xmath1747 by the vector @xmath1748",
    "we have shown that dirac s work on constrained systems can be extended for cases where the primary constraint has a given foliation .",
    "this extends the applicability of the theory for dirac dynamical systems , like lc circuits where the constraints may come from singularities of the lagrangian and , besides , from kirchhoff s current law . throughout the paper",
    "we combine ideas of an algebraic character from dirac s theory with some more geometrically inspired ideas from gotay - nester work .",
    "in particular , we use dirac brackets adapted to the foliation as well as a constraint algorithm for dirac dynamical systems ( cad ) , which is an extension of the gotay - nester algorithm .",
    "the results were proven locally and under regularity conditions .",
    "it is our purpose to study in the future the globalization of the results of the paper as well as the singular cases , using ide techniques , with applications .",
    "this paper has been inspired by jerry marsden s invaluable participation in part of it .",
    "we thank the following institutions for providing us with means to work on this paper : universidad nacional del sur ( projects pgi 24/l075 and pgi 24/zl06 ) ; universidad nacional de la plata ; agencia nacional de promocin cientfica y tecnolgica , argentina ( projects pict 2006 - 2219 and pict 2010 - 2746 ) ; conicet , argentina ( projects pip 20102012 11220090101018 and x553 ecuaciones diferenciales implcitas ) ; european community , fp7 ( project irses `` geomech '' 246981 ) .",
    "there is a canonical inclusion @xmath1749 . in addition , consider the canonical two - forms @xmath1750 and @xmath1751 on @xmath18 and @xmath1752 respectively , the canonical projection @xmath1753 , and define the presymplectic two - form @xmath1754 on @xmath1755 . then the inclusion preserves the corresponding two - forms , that is , @xmath1756 .",
    "if @xmath1757 and @xmath1758 are the tangent projections , we can consider the dual tangent rhombic @xmath1759_{\\tau_{tq}}\\ar[dr]^{t\\tau_q}&\\\\ tq\\ar[dr]_{\\tau_q}&&tq\\ar[dl]^{\\tau_q}\\\\ & q&}\\ ] ] define @xmath1749 by @xmath1760 , @xmath1761 for @xmath1762 . here",
    "@xmath1763 denotes an element in the pontryagin bundle over the point @xmath1764 .",
    "note that the following diagram commutes .",
    "@xmath1765^\\varphi\\ar[d]_{\\operatorname{pr}_{tq}}&t^*tq\\ar[d]^{\\pi_{tq}}\\\\ tq\\ar[r]^{\\operatorname{id}_{tq}}&tq } \\ ] ] let us see that @xmath55 is an injective vector bundle map from the bundle @xmath1766 to the cotangent bundle @xmath1767 , over the identity of @xmath1196 .",
    "the last part of this assertion follows from the commutative diagram above .",
    "first , if @xmath1768 then both sides are in the same fiber @xmath1769 , so @xmath1770 .",
    "also , for all @xmath1771 we have @xmath1772 or @xmath1773 since @xmath1757 is a submersion , we have @xmath1774 and @xmath55 is injective .      for",
    "the second part of the lemma , let us recall the definition of the canonical one - form on @xmath1776 . for @xmath1777 , @xmath1778 is an element of @xmath1779 such that for @xmath1780 , @xmath1781 where @xmath1782 is the cotangent bundle projection .    with a similar notation , the canonical one - form @xmath1783",
    "is given by @xmath1784 pulling back these forms to the pontryagin bundle by @xmath55 and the projection @xmath1753 , we obtain the same one - form . indeed , for @xmath1785",
    ", we get on one hand @xmath1786 and on the other hand @xmath1787 however , the following diagram commutes @xmath1788^\\varphi\\ar[d]_{\\operatorname{pr}_{t^*q}}\\ar[drr]_{\\operatorname{pr}_{tq } } & & t^*tq\\ar[d]^{\\pi_{tq}}\\\\ t^*q\\ar[dr]_{\\pi_q}&&tq\\ar[dl]^{\\tau_q}\\\\ & q & } \\ ] ] so @xmath1789 and therefore @xmath1790 . taking ( minus ) the differential of this identity",
    ", we obtain @xmath1756 .",
    "ralph abraham and jerrold  e. marsden .",
    "_ foundations of mechanics_. benjamin / cummings publishing co. inc .",
    "advanced book program , reading , mass .",
    "isbn 0 - 8053 - 0102-x .",
    "second edition , revised and enlarged , with the assistance of tudor ratiu and richard cushman .",
    "vladimir  i. arnold .",
    "_ mathematical methods of classical mechanics _ , volume  60 of _ graduate texts in mathematics_. springer - verlag , new york , second edition , 1989 .",
    "isbn 0 - 387 - 96890 - 3 . translated from the russian by k. vogtmann and a. weinstein .",
    "p.  balseiro , m.  de  len , j.  c. marrero , and d.  martn  de diego .",
    "the ubiquity of the symplectic hamiltonian equations in mechanics .",
    "_ j. geom .",
    "_ , 10 ( 1):0 134 , 2009 .",
    "issn 1941 - 4889 .",
    "doi : 10.3934/jgm.2009.1.1 .",
    "url http://dx.doi.org/10.3934/jgm.2009.1.1 .",
    "mara barbero - lin and miguel  c. muoz - lecanda .",
    "constraint algorithm for extremals in optimal control problems .",
    "methods mod .",
    "_ , 60 ( 7):0 12211233 , 2009 .",
    "issn 0219 - 8878 .",
    "doi : 10.1142/s0219887809004193 .",
    "url http://dx.doi.org/10.1142/s0219887809004193 .",
    "guido blankenstein and tudor  s. ratiu . singular reduction of implicit hamiltonian systems .",
    "_ , 530 ( 2):0 211260 , 2004 .",
    "issn 0034 - 4877 .",
    "doi : 10.1016/s0034 - 4877(04)90013 - 4 .",
    "url http://dx.doi.org/10.1016/s0034-4877(04)90013-4 .    anthony  m. bloch .",
    "_ nonholonomic mechanics and control _ , volume  24 of _ interdisciplinary applied mathematics_. springer - verlag , new york , 2003 .",
    "isbn 0 - 387 - 95535 - 6 . with the collaboration of j. baillieul , p. crouch and j. marsden , with scientific input from p. s. krishnaprasad , r. m. murray and d. zenkov , systems and control .",
    "anthony  m. bloch and peter  e. crouch .",
    "representations of dirac structures on vector spaces and nonlinear l - c circuits . in _ differential geometry and control ( boulder ,",
    "co , 1997 ) _ , volume  64 of _ proc . sympos .",
    "pure math .",
    "_ , pages 103117 .",
    "soc . , providence , ri , 1999 .",
    "a.  v. borisov and i.  s. mamaev . on the history of the development of the nonholonomic dynamics .",
    ". chaotic dyn .",
    "_ , 70 ( 1):0 4347 , 2002",
    ". issn 1560 - 3547 .",
    "doi : 10.1070/rd2002v007n01abeh000194 .",
    "url http://dx.doi.org/10.1070/rd2002v007n01abeh000194 .",
    "henrique bursztyn .",
    "dirac structures and applications .",
    "la reconqute de la dynamique par la gomtrie aprs lagrange .",
    "conference at ihes , march 2010 .",
    "url http://www.ihes.fr/document?id=2396&id_attribute=48 . retrieved july 2012",
    "henrique bursztyn and marius crainic .",
    "dirac geometry , quasi - poisson actions and @xmath1791-valued moment maps .",
    "_ j. differential geom .",
    "_ , 820 ( 3):0 501566 , 2009 .",
    "issn 0022 - 040x .",
    "url http://projecteuclid.org/getrecord?id=euclid.jdg/1251122545 .",
    "f.  cantrijn , j.  f. cariena , m.  crampin , and l.  a. ibort . reduction of degenerate lagrangian systems .",
    "_ j. geom .",
    "_ , 30 ( 3):0 353400 , 1986 .",
    "issn 0393 - 0440 .",
    "doi : 10.1016/0393 - 0440(86)90014 - 8 .",
    "url http://dx.doi.org/10.1016/0393-0440(86)90014-8 .",
    "j.  f. cariena , j.  gomis , l.  a. ibort , and n.  romn .",
    "canonical transformations theory for presymplectic systems .",
    "_ j. math .",
    "_ , 260 ( 8):0 19611969 , 1985 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.526864 .",
    "url http://dx.doi.org/10.1063/1.526864 .",
    "jos  f. cariena and manuel  f. raada .",
    "blow - up regularization of singular lagrangians . _ j. math .",
    "_ , 250 ( 8):0 24302435 , 1984 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.526450 .",
    "url http://dx.doi.org/10.1063/1.526450 .",
    "jos  f. cariena and manuel  f. raada .",
    "lagrangian systems with constraints : a geometric approach to the method of lagrange multipliers .",
    "_ j. phys .",
    "a _ , 260 ( 6):0 13351351 , 1993 .",
    "issn 0305 - 4470 .",
    "url http://stacks.iop.org/0305-4470/26/1335 .",
    "jos  f. cariena and manuel  f. raada .",
    "comments on the presymplectic formalism and the theory of regular lagrangians with constraints .",
    "_ j. phys .",
    "a _ , 280 ( 3):0 l91l97 , 1995 .",
    "issn 0305 - 4470 .",
    "url http://stacks.iop.org/0305-4470/28/l91 .    jos  f. cariena , carlos lpez , and narciso romn - roy .",
    "origin of the lagrangian constraints and their relation with the hamiltonian formulation .",
    "_ j. math .",
    "_ , 290 ( 5):0 11431149 , 1988 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.527955 .",
    "url http://dx.doi.org/10.1063/1.527955 .",
    "hernn cendra and mara etchechoury .",
    "desingularization of implicit analytic differential equations .",
    "_ j. phys .",
    "a _ , 390 ( 35):0 1097511001 , 2006 .",
    "issn 0305 - 4470 .",
    "doi : 10.1088/0305 - 4470/39/35/003 .",
    "url http://dx.doi.org/10.1088/0305-4470/39/35/003 .",
    "hernn cendra , jerrold  e. marsden , and tudor  s. ratiu .",
    "geometric mechanics , lagrangian reduction , and nonholonomic systems . in _",
    "mathematics unlimited2001 and beyond _ , pages 221273 .",
    "springer , berlin , 2001 .",
    "hernn cendra , jerrold  e. marsden , sergey pekarsky , and tudor  s. ratiu .",
    "variational principles for lie - poisson and hamilton - poincar equations .",
    "j. _ , 30 ( 3):0 833867 , 11971198 , 2003 .",
    "issn 1609 - 3321 .",
    "hernn cendra , jerrold  e. marsden , sergey pekarsky , and tudor  s. ratiu .",
    "variational principles for lie - poisson and hamilton - poincar equations .",
    "j. _ , 30 ( 3):0 833867 , 11971198 , 2003 .",
    "issn 1609 - 3321 .",
    "\\{dedicated to vladimir igorevich arnold on the occasion of his 65th birthday}.    hernn cendra , alberto ibort , manuel de  len , and david martn  de diego .",
    "a generalization of chetaev s principle for a class of higher order nonholonomic constraints . _ j. math .",
    "_ , 450 ( 7):0 27852801 , 2004 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.1763245 .",
    "url http://dx.doi.org/10.1063/1.1763245 .",
    "leon  o. chua and j.  d. mcpherson . explicit topological formulation of lagrangian and hamiltonian equations for nonlinear networks .",
    "_ ieee trans .",
    "circuits and systems _ , cas-21:0 277286 , 1974 .",
    "issn 0098 - 4094 .",
    "luis  a. cordero , c.  t.  j. dodson , and manuel de  len .",
    "_ differential geometry of frame bundles _ , volume  47 of _ mathematics and its applications_. kluwer academic publishers group , dordrecht , 1989 .",
    "isbn 0 - 7923 - 0012 - 2 .",
    "jorge corts , manuel de  len , juan  c. marrero , d.  martn  de diego , and eduardo martnez .",
    "a survey of lagrangian mechanics and control on lie algebroids and groupoids .",
    "methods mod .",
    "_ , 30 ( 3):0 509558 , 2006 .",
    "issn 0219 - 8878 .",
    "doi : 10.1142/s0219887806001211 .",
    "url http://dx.doi.org/10.1142/s0219887806001211 .",
    "jorge corts , manuel de  len , juan  carlos marrero , and eduardo martnez .",
    "nonholonomic lagrangian systems on lie algebroids .",
    "_ discrete contin .",
    "_ , 240 ( 2):0 213271 , 2009 .",
    "issn 1078 - 0947 .",
    "doi : 10.3934/dcds.2009.24.213 .",
    "url http://dx.doi.org/10.3934/dcds.2009.24.213 .",
    "ted courant and alan weinstein . beyond poisson structures . in _",
    "action hamiltoniennes de groupes .",
    "troisime thorme de lie ( lyon , 1986 ) _ , volume  27 of _ travaux en cours _ ,",
    "pages 3949 .",
    "hermann , paris , 1988 .",
    "mike crampin and tom mestdag .",
    "the cartan form for constrained lagrangian systems and the nonholonomic noether theorem .",
    "methods mod .",
    "_ , 80 ( 4):0 897923 , 2011 .",
    "issn 0219 - 8878 .",
    "doi : 10.1142/s0219887811005452 .",
    "url http://dx.doi.org/10.1142/s0219887811005452 .",
    "mike crampin and tom mestdag .",
    "reduction of invariant constrained systems using anholonomic frames .",
    "_ j. geom .",
    "_ , 30 ( 1):0 2340 , 2011 .",
    "issn 1941 - 4889 .",
    "doi : 10.3934/jgm.2011.3.23 .",
    "url http://dx.doi.org/10.3934/jgm.2011.3.23 .",
    "manuel de  len and david  m. de  diego . on the geometry of non - holonomic lagrangian systems . _ j. math .",
    "_ , 370 ( 7):0 33893414 , 1996 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.531571 .",
    "url http://dx.doi.org/10.1063/1.531571 .",
    "manuel de  len and paulo  r. rodrigues .",
    "_ methods of differential geometry in analytical mechanics _ , volume 158 of _ north - holland mathematics studies_. north - holland publishing co. , amsterdam , 1989 .",
    "isbn 0 - 444 - 88017 - 8 .",
    "manuel de  len , david  martin de  diego , and paulo pitanga . a new look at degenerate lagrangian dynamics from the viewpoint of almost - product structures . _",
    "a _ , 280 ( 17):0 49514971 , 1995 .",
    "issn 0305 - 4470 .",
    "url http://stacks.iop.org/0305-4470/28/4951 .",
    "m.  delgado - tllez and a.  ibort . on the geometry and topology of singular optimal control problems and their solutions .",
    "_ discrete contin .",
    "_ , 0 ( suppl.):0 223233 , 2003 .",
    "issn 1078 - 0947 .",
    "dynamical systems and differential equations ( wilmington , nc , 2002 ) .",
    "mark  j. gotay and james  m. nester .",
    "presymplectic lagrangian systems .",
    "i. the constraint algorithm and the equivalence theorem . _",
    "h. poincar sect .",
    "a ( n.s . ) _ , 300 ( 2):0 129142 , 1979 .",
    "issn 0020 - 2339 .",
    "mark  j. gotay and james  m. nester .",
    "generalized constraint algorithm and special presymplectic manifolds . in _ geometric methods in mathematical physics",
    "nsf - cbms conf .",
    "lowell , lowell , mass . , 1979 ) _ , volume 775 of _ lecture notes in math .",
    "_ , pages 78104 .",
    "springer , berlin , 1980 .",
    "mark  j. gotay and jdrzej niatycki . on the quantization of presymplectic dynamical systems via coisotropic imbeddings .",
    "_ , 820 ( 3):0 377389 , 1981/82 .",
    "issn 0010 - 3616 .",
    "url http://projecteuclid.org/getrecord?id=euclid.cmp/1103920596 .",
    "mark  j. gotay , james  m. nester , and george hinds .",
    "presymplectic manifolds and the dirac - bergmann theory of constraints . _ j. math .",
    "_ , 190 ( 11):0 23882399 , 1978 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.523597 .",
    "url http://dx.doi.org/10.1063/1.523597 .",
    "j.  grabowski , m.  de  len , j.  c. marrero , and d.  martn  de diego .",
    "nonholonomic constraints : a new viewpoint .",
    "_ j. math . phys .",
    "_ , 500 ( 1):0 013520 , 17 , 2009 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.3049752 .",
    "url http://dx.doi.org/10.1063/1.3049752 .",
    "xavier grcia and josep  m. pons .",
    "constrained systems : a unified geometric approach .",
    "_ internat .",
    "j. theoret .",
    "_ , 300 ( 4):0 511516 , 1991 .",
    "issn 0020 - 7748 .",
    "doi : 10.1007/bf00672895 .",
    "url http://dx.doi.org/10.1007/bf00672895 .",
    "xavier grcia and josep  m. pons . a generalized geometric framework for constrained systems .",
    "_ differential geom .",
    "_ , 20 ( 3):0 223247 , 1992 .",
    "issn 0926 - 2245 .",
    "doi : 10.1016/0926 - 2245(92)90012-c .",
    "url http://dx.doi.org/10.1016/0926-2245(92)90012-c .",
    "alberto ibort , manuel de  len , giuseppe marmo , and david martn  de diego . non - holonomic constrained systems as implicit differential equations .",
    "sem . mat .",
    "torino _ , 540 ( 3):0 295317 , 1996 .",
    "issn 0373 - 1243 .",
    "geometrical structures for physical theories , i ( vietri , 1996 ) .",
    "alberto ibort , manuel de  len , juan  c. marrero , and david martn  de diego .",
    "dirac brackets in constrained dynamics .",
    "_ fortschr .",
    "_ , 470 ( 5):0 459492 , 1999 .",
    "issn 0015 - 8208 .",
    "doi : 10.1002/(sici)1521 - 3978(199906)47:5<459::aid - prop459>3.0.co;2-e .",
    "url http://dx.doi.org/10.1002/(sici)1521-3978(199906)47:5<459::aid-prop459>3.0.co;2-e[http://dx.doi.org/10.1002/(sici)1521-3978(199906)47:5<459::aid-prop459>3.0.co;2-e ] .",
    "david iglesias , juan  carlos marrero , david martn  de diego , eduardo martnez , and edith padrn .",
    "reduction of symplectic lie algebroids by a lie subalgebroid and a symmetry lie group .",
    "_ sigma symmetry integrability geom .",
    "methods appl .",
    "_ , 3:0 paper 049 , 28 , 2007 .",
    "issn 1815 - 0659 .",
    "doi : 10.3842/sigma.2007.049 .",
    "url http://dx.doi.org/10.3842/sigma.2007.049 .",
    "olga krupkov . a geometric setting for higher - order dirac - bergmann theory of constraints . _ j. math .",
    "_ , 350 ( 12):0 65576576 , 1994 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.530691 .",
    "url http://dx.doi.org/10.1063/1.530691 .",
    "giuseppe marmo , giovanna mendella , and wodzimierz  m. tulczyjew . constrained hamiltonian systems as implicit differential equations . _",
    "a _ , 300 ( 1):0 277293 , 1997 .",
    "issn 0305 - 4470 .",
    "doi : 10.1088/0305 - 4470/30/1/020 .",
    "url http://dx.doi.org/10.1088/0305-4470/30/1/020 .",
    "eduardo martnez .",
    "lie algebroids in classical mechanics and optimal control .",
    "_ sigma symmetry integrability geom .",
    "methods appl . _ , 3:0 paper 050 , 17 pp .",
    "( electronic ) , 2007 . issn 1815 - 0659 .",
    "doi : 10.3842/sigma.2007.050 .",
    "url http://dx.doi.org/10.3842/sigma.2007.050 .",
    "eduardo martnez .",
    "variational calculus on lie algebroids .",
    "_ esaim control optim .",
    "_ , 140 ( 2):0 356380 , 2008 .",
    "issn 1292 - 8119 .",
    "doi : 10.1051/cocv:2007056 .",
    "url http://dx.doi.org/10.1051/cocv:2007056 .",
    "b.  m. maschke , a.  j. van  der schaft , and p.  c. breedveld . an intrinsic hamiltonian formulation of network dynamics : nonstandard poisson structures and gyrators .",
    "_ j. franklin inst .",
    "_ , 3290 ( 5):0 923966 , 1992 .",
    "issn 0016 - 0032 .",
    "doi : 10.1016/s0016 - 0032(92)90049-m .",
    "url http://dx.doi.org/10.1016/s0016-0032(92)90049-m .",
    "b.  m. maschke , a.  j. van  der schaft , and p.  c. breedveld . an intrinsic hamiltonian formulation of the dynamics of lc - circuits .",
    "_ ieee trans .",
    "circuits systems i fund .",
    "theory appl .",
    "_ , 420 ( 2):0 7382 , 1995 .",
    "issn 1057 - 7122 .",
    "doi : 10.1109/81.372847 .",
    "url http://dx.doi.org/10.1109/81.372847 .",
    "giovanna mendella , giuseppe marmo , and wodzimierz  m. tulczyjew .",
    "integrability of implicit differential equations .",
    "_ j. phys .",
    ", 280 ( 1):0 149163 , 1995 .",
    "issn 0305 - 4470 .",
    "url http://stacks.iop.org/0305-4470/28/149 .",
    "luc moreau and dirk aeyels . a novel variational method for deriving lagrangian and hamiltonian models of inductor - capacitor circuits .",
    "_ siam rev .",
    "_ , 460 ( 1):0 5984 ( electronic ) , 2004 .",
    "issn 0036 - 1445 .",
    "doi : 10.1137/s0036144502409020 .",
    "url http://dx.doi.org/10.1137/s0036144502409020 .          f.  leon pritchard . on implicit systems of differential equations .",
    "_ j. differential equations _ , 1940 ( 2):0 328363 , 2003 .",
    "issn 0022 - 0396 .",
    "doi : 10.1016/s0022 - 0396(03)00191 - 8 .",
    "url http://dx.doi.org/10.1016/s0022-0396(03)00191-8 .",
    "patrick  j. rabier and werner  c. rheinboldt . a geometric treatment of implicit differential - algebraic equations .",
    "_ j. differential equations _ , 1090 ( 1):0 110146 , 1994 .",
    "issn 0022 - 0396 .",
    "doi : 10.1006/jdeq.1994.1046 .",
    "url http://dx.doi.org/10.1006/jdeq.1994.1046 .",
    "ray skinner and raymond rusk .",
    "generalized hamiltonian dynamics .",
    "i. formulation on @xmath1792 .",
    "_ j. math .",
    "_ , 240 ( 11):0 25892594 , 1983 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.525654 .",
    "url http://dx.doi.org/10.1063/1.525654 .",
    "ray skinner and raymond rusk .",
    "generalized hamiltonian dynamics .",
    "ii . gauge transformations . _ j. math .",
    "_ , 240 ( 11):0 25952601 , 1983 .",
    "issn 0022 - 2488 .",
    "doi : 10.1063/1.525655 .",
    "url http://dx.doi.org/10.1063/1.525655 .",
    "a.  j. van  der schaft .",
    "implicit hamiltonian systems with symmetry . _ rep . math .",
    "_ , 410 ( 2):0 203221 , 1998 .",
    "issn 0034 - 4877 .",
    "doi : 10.1016/s0034 - 4877(98)80176 - 6",
    ". url http://dx.doi.org/10.1016/s0034-4877(98)80176-6 .",
    "a.  j. van  der schaft and b.  m. maschke . on the hamiltonian formulation of nonholonomic mechanical systems .",
    "_ , 340 ( 2):0 225233 , 1994 .",
    "issn 0034 - 4877 .",
    "doi : 10.1016/0034 - 4877(94)90038 - 8 .",
    "url http://dx.doi.org/10.1016/0034-4877(94)90038-8 .",
    "hiroaki yoshimura and jerrold  e. marsden .",
    "dirac structures in lagrangian mechanics .",
    "i. implicit lagrangian systems .",
    "_ j. geom .",
    "_ , 570 ( 1):0 133156 , 2006 .",
    "issn 0393 - 0440 .",
    "doi : 10.1016/j.geomphys.2006.02.009 .",
    "url http://dx.doi.org/10.1016/j.geomphys.2006.02.009 .",
    "hiroaki yoshimura and jerrold  e. marsden .",
    "dirac structures in lagrangian mechanics .",
    "ii . variational structures .",
    "_ j. geom .",
    "_ , 570 ( 1):0 209250 , 2006 .",
    "issn 0393 - 0440 .",
    "doi : 10.1016/j.geomphys.2006.02.012 .",
    "url http://dx.doi.org/10.1016/j.geomphys.2006.02.012 ."
  ],
  "abstract_text": [
    "<S> this paper extends the gotay - nester and the dirac theories of constrained systems in order to deal with dirac dynamical systems in the integrable case . </S>",
    "<S> integrable dirac dynamical systems are viewed as constrained systems where the constraint submanifolds are foliated , the case considered in gotay - nester theory being the particular case where the foliation has only one leaf . </S>",
    "<S> a constraint algorithm for dirac dynamical systems ( cad ) , which extends the gotay - nester algorithm , is developed . </S>",
    "<S> evolution equations are written using a dirac bracket adapted to the foliations and an abridged total energy which coincides with the total hamiltonian in the particular case considered by dirac . </S>",
    "<S> the interesting example of lc circuits is developed in detail . </S>",
    "<S> the paper emphasizes the point of view that dirac and gotay - nester theories are dual and that using a combination of results from both theories may have advantages in dealing with a given example , rather than using systematically one or the other . </S>"
  ]
}