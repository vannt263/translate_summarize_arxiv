{
  "article_text": [
    "accretion into black holes is believed to account for a wide variety of astrophysical phenomena , from solar - mass black holes in x - ray binaries , to supermassive black holes in active galactic nuclei .",
    "the basic theory of black hole accretion was laid out more than thirty years ago in a number of now - classic papers ( e.g. novikov & thorne 1972 ; shakura & sunyaev 1973 ; lynden - bell and pringle 1974 ) . since then , theoretical progress has been steady , but perhaps at a slower rate than might have been hoped .",
    "the problem is complex , involving time - dependent , three - dimensional dynamics of magnetized plasmas in the relativistic potential of kerr black holes .",
    "solutions are impossible to obtain analytically beyond simplified cases that rely upon time - stationarity and spatial symmetry . because of this",
    ", numerical experiments must play an increasingly important role in driving theory .",
    "the importance of numerical simulations in the investigation of such complex physics has long been recognized , but until recently the necessary computational hardware was not available .",
    "we are now in a position to pursue full 3d simulations with general relativistic mhd codes .",
    "again , the basics were laid out thirty years ago by wilson ( 1972 ) who pioneered both hydrodynamic and magnetohydrodynamic ( mhd ) two - dimensional simulations of black hole accretion ( wilson 1975 ; 1977 ; 1978 ) . since then there have been a significant number of efforts by a number of groups to develop accretion simulations for both newtonian and relativistic gravitational fields , and for both hydrodynamics and magnetohydrodynamics .",
    "this paper details our current effort to develop a fully general relativistic mhd accretion code .    why focus on general relativistic mhd ?",
    "in fact , for many applications newtonian gravity ( or a pseudo - newtonian mock - up of a black hole ) is sufficient . in some important cases ,",
    "however , it is not .",
    "the detailed physics of gas interacting with a black hole provides , in principle , a rare test of strong - field general relativity , but only if we understand the unique properties of accretion in the fully relativistic case .",
    "distinctive and astrophysically interesting effects are expected from the kerr metric , including those due to the lack of a stellar surface , the presence of an innermost stable circular orbit , and the dragging of inertial frames .",
    "the need to include mhd in an accretion simulation is also now quite clear .",
    "magnetic fields play an essential role in the outward transport of angular momentum in accretion disks through the action of the magnetorotational instability ( mri ; balbus & hawley 1998 ) .",
    "this , in turn , means the simulations must be three - dimensional , for only in three dimensions can there be a self - sustaining ( and accretion - sustaining ) mhd dynamo .    in this paper",
    "we describe an algorithmic approach to the three - dimensional equations of general relativistic mhd that is based upon techniques first developed for axisymmetric hydrodynamics around black holes ( hawley , smarr & wilson 1984a , 1984b ; hereafter hswa and hswb ) .",
    "the hydrodynamic portion of the code was recently tested and employed in three - dimensional simulations in the kerr metric by de villiers & hawley ( 2002 ) .",
    "here we cast the equations of relativistic mhd in a form that is compatible with the hsw formulation .",
    "we will describe how those equations are evolved numerically .",
    "we will also discuss a suite of tests suitable for relativistic codes , and show how our code performs against those tests .",
    "it is important to recognize that the development of numerical algorithms in any area of physics with few analytic solutions , and even fewer experimental observations , is likely to be difficult .",
    "progress will be made only by exploring a variety of approaches .",
    "such a situation necessarily precludes the development of only one numerical algorithm , or even a single code implementation of a promising algorithm .",
    "some approaches will have strengths for certain applications , but it is unlikely that one numerical technique will be optimal for all problems . in any case , experience gained , both with what works and what does not , will be essential as we work toward developing a consensus within the community . with this in mind ,",
    "our own efforts have concentrated on extending the established general relativistic hydrodynamic approach of hsw , since our main area of interest , that of accretion flows , has been well handled ( in the hydrodynamic case ) by this solver , and by similar algorithms designed to perform newtonian mhd simulations .",
    "our test suite has been developed in conjunction with gammie , mckinney , & tth ( 2002 ) , who use an alternative scheme for general relativistic mhd .",
    "the plan of this paper is as follows . in ",
    "2 we write the equations of general relativistic mhd in the form that they will be solved in the code . in ",
    "3 we describe the numerical implementation of our algorithm . in ",
    "4 we describe the one - dimensional minkowski ( special relativistic ) test problems . in  5 we describe the test problems in the kerr and schwarzschild metrics , and present our test results .",
    "the summary and conclusions are presented in  6 .",
    "we wish to study the evolution of a magnetized fluid in the background spacetime metric of a kerr black hole .",
    "we work in boyer - lindquist coordinates , for which the line element has the form , @xmath1 in keeping with misner , thorne , & wheeler ( 1973 ) , we use the metric signature @xmath2 , along with geometrodynamic units where @xmath3 ; the black hole mass is unity , @xmath4 .",
    "the determinant of the 4-metric is @xmath5 , and @xmath6 where @xmath7 is the lapse function , @xmath8 , and @xmath9 is the determinant of the spatial @xmath10-metric .",
    "the state of the relativistic test fluid at each point in the spacetime is described by its density , @xmath11 , internal energy , @xmath12 , @xmath13-velocity @xmath14 , and isotropic pressure , @xmath15 , which is related to the first two scalars via the equation of state of an ideal gas , @xmath16 , where @xmath9 is the adiabatic exponent .",
    "the equations of general relativistic mhd are the law of baryon conservation , @xmath17 where @xmath18 is the covariant derivative , the conservation of stress - energy , @xmath19 where @xmath20 is the energy - momentum tensor for the fluid , and maxwell s equations , @xmath21 where @xmath22 is the electromagnetic field strength tensor , @xmath23 is the current @xmath13-vector , and @xmath24 the charge density .",
    "the dual tensor is defined as @xmath25 where @xmath26 $ ] is the contra - variant form of the levi - civita tensor .",
    "maxwell s equations are supplemented by the equation of charge conservation @xmath27 .",
    "the energy - momentum tensor consists of perfect fluid and electromagnetic parts , @xmath28 , and has the form @xmath29 following lichnerowicz ( 1967 ) and anile ( 1989 ) , we define the magnetic induction and the electric field in the rest frame of the fluid , @xmath30 we adopt the ideal mhd limit and assume infinite conductivity ( the flux - freezing condition ) , wherein the electric field in the fluid rest frame is zero , i.e. , @xmath31 .",
    "we combine the definition of the magnetic induction ( [ bdef.2 ] ) with ( [ dual.2 ] ) and the condition for infinite conductivity to obtain @xmath32 where @xmath33 $ ] .",
    "the orthogonality condition @xmath34 follows directly from ( [ bdef.2 ] ) and the anti - symmetry of @xmath22 .    using these results , it is possible to rewrite the electro - magnetic portion of the energy - momentum tensor as @xmath35 where @xmath36 , and @xmath37 .",
    "the induction equation ( [ maxwell.2 ] ) is solved using the equivalent form @xmath38 working directly with @xmath39 replaces covariant derivatives with simple coordinate derivatives .",
    "this is the basis for the constrained transport ( ct ) formulation of evans & hawley ( 1988 ; hereafter eh88 ) for the induction equation . in ct",
    "we make the identification @xmath40 where @xmath41 are the ct magnetic field variables . with @xmath42 for one of the indices in ( [ ctinduction ] ) we get the evolution equations for @xmath41 , while permuting over the spatial indices yields @xmath43 which is the familiar divergence - free condition .",
    "the ct magnetic field is considered the fundamental expression of the magnetic field for evolution in the induction equation .",
    "equation ( [ fmunudef.2 ] ) relates the ct field to the field @xmath44 ( or @xmath45 ) which is fundamental in the definition of @xmath46 .",
    "the induction equation ( [ maxwell.2 ] ) can also be rewritten by substituting definitions , @xmath47 by expanding this equation using the product rule and applying the orthogonality condition ( [ bnorm ] ) , we obtain the identity @xmath48 proofs of the results for ( [ fmunudef.2 ] ) , ( [ tmunuem ] ) , and ( [ max2.b ] ) can be found in appendix a.    in preparation for discretizing these equations we list the specific variables that will be used in the code .",
    "first , the transport velocity ( also known as the coordinate velocity ) @xmath49 is defined @xmath50 where @xmath51 , and @xmath52 is the relativistic gamma - factor , which can be expressed as @xmath53^{-1/2},\\ ] ] a result which follows directly from the definition of transport velocity and the normalization condition on the @xmath13-velocity , @xmath54    the magnetic field of the fluid is described by two sets of variables , the constrained transport ( ct ) magnetic field , @xmath55 , and magnetic field @xmath13-vector @xmath56 .",
    "the latter is fundamental to the definition of the total four momentum , @xmath57 and the normalization condition @xmath58}^2 , \\ ] ] which is algebraically equivalent to ( [ vnorm ] ) .",
    "finally , we define auxiliary density and energy functions @xmath59 and @xmath60 .",
    "the set of variables @xmath61 , @xmath62 , @xmath63 , @xmath55 , @xmath64 , and @xmath65 will be those on which the numerical scheme is built .",
    "since we are working in a coordinate basis , we also record here the identities for the divergence of a four - vector and a tensor @xmath66 @xmath67      the equation of baryon conservation ( [ barcons ] ) is unaltered by the presence of magnetic fields , and can be expanded in terms of the code variables to read ( keeping in mind that the metric is stationary ) , @xmath68    the equation of energy conservation is derived by contracting ( [ tmncons ] ) with @xmath69 , @xmath70 by using identity ( [ bident ] ) and the law of baryon conservation ( [ barcons ] ) , we recover the local energy conservation law @xmath71 which is unaffected by the presence of magnetic fields in the ideal mhd limit and corresponds to an equation of entropy conservation . applying the definition for the auxiliary energy function @xmath62 , the energy equation is rewritten as follows : @xmath72 which is the same as in hsw .",
    "the momentum conservation equations follow from @xmath73 using the definition of momentum @xmath74 the first term in the preceding expression can be rewritten as @xmath75 and simplified to @xmath76 , and also using @xmath77 , which holds for any symmetric tensor , we rewrite the momentum equation as @xmath78 to obtain the final form of the equations , multiply ( [ mom.2 ] ) by the lapse @xmath7 , split the @xmath79 index into its space ( @xmath80 ) and time ( @xmath42 ) components , and restrict @xmath81 to the spatial indices ( @xmath82 ) only : @xmath83 the @xmath81 index can be restricted to the spatial indices because the equation that arises from @xmath84 for the time components of momentum and magnetic fields is redundant , corresponding to a total energy conservation equation . in our formalism",
    ", we solve equation ( [ enfinal ] ) separately for the internal energy .",
    "the time component of @xmath63 is obtained from the normalization condition on the momentum ( [ momnorm ] ) , and on the relations between components of the magnetic field .",
    "we note that there are alternate ways to write this equation that , while analytically equivalent , correspond to significant differences in numerical implementation .",
    "one is to evolve directly the total stress energy @xmath85 and solve algebraically for the primitive variables .",
    "this approach is taken by koide , shibata , & kudoh ( 1999 ) , komissarov ( 1999 ) , and gammie , mckinney & tth ( 2002 ) .",
    "yet another alternative is to write the divergence of the electromagnetic stress - energy tensor in the form @xmath86 ( the familiar @xmath87 force from newtonian mhd ) and regard it as a source term for the hydrodynamic momentum evolution ; this approach was used by wilson ( 1978 ) .",
    "the equations of energy and momentum conservation have been expressed in terms of the magnetic field @xmath13-vector @xmath45 since this yields expressions structurally compatible with the existing hydrodynamic equations .",
    "this has important advantages in the numerical implementation of these equations .",
    "however , the induction equation is evolved with the constrained transport ( ct ) approach of eh88 using the variables @xmath88 .",
    "the practical consequence is that we must translate between the two sets of variables .",
    "working with the second of maxwell s equations , ( [ maxwell.2 ] ) , we have previously identified the space - space components of @xmath39 with the ct field @xmath41 .",
    "it is easy to show that we obtain the same result using ( [ max2.b ] ) , @xmath89 by splitting the above equation into two pieces and defining the ct magnetic field as @xmath90 it is possible to write @xmath91 the starting point for the eh88 ct scheme . in addition , the time - space components of @xmath92 can be obtained by applying the condition of infinite conductivity , @xmath31 , to obtain @xmath93 these can be identified with @xmath94 , the ct electromotive forces ( emfs , eh88 ) .    the divergence - free character of the magnetic field is maintained by evolving the induction equation using these ct variables .",
    "hence the magnetic induction @xmath56 is derived from the ct magnetic field .",
    "we obtain the spatial components using ( [ fmunudef.3 ] ) . to obtain @xmath95",
    ", we use the definition of the magnetic induction ( [ bdef.2 ] ) , @xmath96 and we expand this definition and substitute for the faraday tensor .",
    "this allows us to obtain the time - component of the magnetic field , @xmath97 this relationship can also be obtained from the orthogonality condition ( [ bnorm ] ) . using this result and the relations in ( [ fmunudef.3 ] ) we obtain , after some algebra , a useful expression for @xmath98 , @xmath99",
    "the advantage of this form is that it guarantees that @xmath98 is positive .",
    "the derivation is supplied in appendix a.",
    "the grmhd code evolves time - explicit , operator - split , finite difference forms of equations ( [ masscons ] ) , ( [ enfinal ] ) , ( [ mom.3 ] ) , and ( [ ct.3b ] ) .",
    "variables are placed on a fixed spatial grid using boyer - lindquist coordinates .",
    "they are advanced in time over a timestep size @xmath100 that remains fixed for the duration of the simulation , and is determined by the extremal light - crossing time for a grid zone , as described in hswb .",
    "the evolution algorithm is a three - dimensional generalization of the solver described in hswb extended to include the contribution of magnetic fields .",
    "the hydrodynamic portion of the solver was described in de villiers and hawley ( 2002 ) .",
    "one timestep consists of three sequential sub - steps : the induction step , the transport step , and finally the source step .",
    "the induction step updates the magnetic field vector @xmath55 using the constrained transport framework of eh88 .",
    "this is discussed in greater detail below .",
    "after the update , the ct field is transformed to the magnetic field in the fluid rest frame , @xmath101 .",
    "velocities @xmath64 are computed using the normalization condition during the source step .",
    "three versions of grmhd have been used in development and testing : ( 1 ) a 1d version with minkowski metric to do alfvn and shock wave tests , described here in  4 , ( 2 ) a 2d axisymmetric version in the kerr metric to perform the tests described in  5 , and ( 3 ) the full 3d production version of the code .",
    "the 3d version of the code uses message passing parallelism with domain decomposition , where the global grid is partitioned into subgrids , with each subgrid assigned to a processor .",
    "data on each subgrid are evolved independently during a timestep and data on subgrid boundaries are exchanged when required through message - passing calls .",
    "this results in a highly scalable code that exhibits good speedup over the full range of practically realizable subgrids .",
    "the transport step , as its name implies , handles the transport terms in the continuity , energy , and momentum equations , @xmath102}_{transport } = -{1 \\over \\sqrt{\\gamma}}\\ ,   \\partial_i\\left[\\sqrt{\\gamma}\\,{\\cal{x}}\\,v^i\\right ]   \\ , , \\ ,   \\left({\\cal{x } } \\equiv d , e , s_j\\right).\\ ] ] other than the modified definition of the inertia , these expressions are completely analogous to those in hswb .",
    "the source step handles the remaining terms in the energy and momentum equations .",
    "the energy terms @xmath103}_{source } = -p\\,\\partial_{t } w -   { p\\over\\sqrt{\\gamma}}\\,\\partial_{i}\\left[\\sqrt{\\gamma}\\,w\\,v^i\\right]\\ ] ] are evolved as described in hswb .",
    "the momentum source terms contain new elements , namely @xmath104}_{source } =   -\\alpha\\,\\partial_t\\left[b_j\\,b^t\\right]+    { \\partial_i \\left[\\sqrt{\\gamma}\\,\\alpha\\,b_j\\,b^i\\right ] \\over     \\sqrt{\\gamma } }    -\\left[{s_\\epsilon\\,s_\\mu \\over s^t}-    \\alpha\\,b_\\mu\\,b_\\epsilon\\right]\\ ,    { \\partial_j g^{\\mu\\,\\epsilon } \\over 2}-    \\alpha\\,\\partial_j\\left[p+{{\\|b\\|}^2",
    "\\over 2}\\right].\\ ] ] in the following expressions , superscript indices for the current time step are understood .",
    "the spatial differencing of some value @xmath105 is shown in compact form through the shift operator @xmath106 ; any averaging of zone- and face - centered quantities that may be required to properly center calculations is done as described in hswb .",
    "the time derivative of the magnetic fields is evaluated from the newly - obtained values from the induction step , and stored values from the previous time step , @xmath107 .\\ ] ] the magnetic gradient term discretizes readily , @xmath108 as does the pressure gradient term , @xmath109 finally , the accelerations due to gradients in the metric , @xmath110\\ ,    \\partial_j\\,g^{\\mu\\,\\epsilon}.\\ ] ] are computed using @xmath111 and @xmath112 obtained from @xmath113 using momentum normalization ( [ momnorm ] ) ; the metric derivatives , @xmath114 , are evaluated analytically over the whole grid and stored in memory at the beginning of the simulation .    in the source step , after the pressure gradient and acceleration terms have been computed , the transport velocity @xmath115 , and the lorentz factor @xmath116 are obtained using velocity normalization . to guarantee that the normalization is well - behaved in evacuated zones , we work with the momenta @xmath117 rather than applying the normalization condition directly to the velocities .",
    "although the two normalizations are analytically equivalent , use of the momentum protects against numerical rounding errors that cause spurious floating point exceptions when extremely tenuous material is moving at velocities close to that of light .",
    "the source step also includes an artificial viscosity in both the energy and momentum equations to provide a mechanism to increase the entropy of the fluid in shocks .",
    "the artificial viscosity is unchanged from hswb , except for modifying the definition of the inertia to include the magnetic energy .",
    "the ct framework of eh88 is based on two basic ideas : the use of @xmath39 as the fundamental variable so that the induction equation reduces to simple partial derivatives , and a staggered - grid centering of terms so that the numerical divergence of the ct magnetic field is constrained to be zero .",
    "the ct magnetic field component @xmath41 is located on the @xmath82 face of a zone ( a cube in three dimensions ) , and the ct emfs , @xmath118 , that are differenced to evolve @xmath41 are located on the zone edges that define the @xmath82 face .    the ct formalism imposes no stringent conditions on exactly how the emfs are computed .",
    "eh88 noted that some of the magnetic field variables appear in the discretrized equations for the emfs in the guise of transport terms , requiring that they be upwinded for stability , while others appeared as shear terms , apparently requiring no special treatment .",
    "eh88 used simple space - centered differencing for those terms , but stone & norman ( 1992 ) found that this prescription is inadequate .",
    "the results from simple alfvn pulse propagation tests where the alfvnic velocity exceeds that of the background fluid found substantial undamped dispersion error , resulting in excessive zone - to - zone noise .",
    "stone & norman ( 1992 ) proposed to calculate the ct emfs by solving a one dimensional analytic linear alfvn wave equation to obtain improved values of @xmath41 and @xmath119 in the construction of the emfs .",
    "this approach became known as the method of characteristics constrained transport ( mocct ) . since then several variants have been proposed ( e.g. hawley & stone 1995 ; clarke 1996 ) to further improve the computation of newtonian mhd .",
    "while the traditional approach to moc does not carry over readily to gr mhd , it is nevertheless possible to address the problem by using the same motivation that underlies mocct . instead of using an analytic alfvn wave solution we use a numerical solution of the simplified one - dimensional induction and momentum equations to obtain the improved emfs .",
    "our implementation of ct for the grmhd code is accomplished as follows .",
    "following the example of hawley & stone ( 1995 ) , the starting point for constructing , for instance , the @xmath120-emf , @xmath121 lies in obtaining the discretized solutions to the 1d incompressible mhd equations . on a staggered mesh",
    ", @xmath122 is located on zone edges in such a way that it is constructed from @xmath123- and @xmath124-components relocated in the @xmath124- and @xmath123-directions respectively . to take a specific example ,",
    "we would like obtain an edge - centered estimate @xmath125 to construct the above emf .",
    "we do this by solving the 1d linearized induction equation in the @xmath123-direction ( i.e. @xmath126 ) for small transverse ( @xmath124 ) perturbations .",
    "this simplified induction equation has the form , @xmath127 by applying the usual differencing we obtain for the left - hand side , @xmath128 where the overbar denotes the original eh88 upwinding .",
    "we can now readily obtain estimates of the starred quantity , @xmath129 , \\ ] ] where the factor of @xmath130 ensures proper time - centering of the starred quantity ( the starred values are centered between the @xmath131 and @xmath132 time levels ) .",
    "a similar approach can now be used to generate @xmath133 , and produce an improved estimate of @xmath122 .",
    "the procedure is just as easily applied to the other two emfs to complete the process for all ct variables .",
    "note that because of the fully covariant nature of the ct equations , this process applies to any coordinate system .    for consistency",
    ", we also need to evolve the linearized momentum equation for the transverse velocities .",
    "care must be taken in deriving these equations since , in contrast to the ct induction equation , metric terms are explicitly involved in the expressions . continuing with the example for @xmath122 , and regarding the @xmath123 direction to be either @xmath134 or @xmath135 , and @xmath124 a direction transverse to this , we obtain @xmath136 where , @xmath137 ( the details are found in appendix a. ) note that the above equations are similar to the newtonian results , but with the relativistic factors @xmath138 and @xmath139 . by simply applying the usual differencing ,",
    "however , we readily obtain expressions for an improved estimate of the transverse velocity , @xmath140 where the overbar denotes the edge - centered average , from which , @xmath141.\\ ] ]    in the kerr metric , the calculation in the @xmath142 direction is somewhat different due to the @xmath143 metric term . in this case",
    "we obtain @xmath144\\,v^y -   \\kappa\\,\\,{\\cal{b}}^\\phi\\partial_\\phi\\,{\\cal{b}}^y \\approx 0.\\ ] ] where @xmath138 and @xmath139 are unchanged and @xmath145    combined with the starred quantities for the ct variables , we now have a complete set of variables from which to construct the emfs .",
    "the first series of tests is designed to verify code performance in the special relativistic limit . for this purpose",
    "we use a one - dimensional version of the code and the minkowski metric .",
    "the tests include alfvn wave propagation , fast and slow magnetosonic shocks , rarefaction waves , and both relativistic and non - relativistic shock tubes .",
    "many of these tests have appeared previously in the literature in one form or another . in particular , komissarov ( 1999 ) ( hereafter referred to as k99 ) presented a series of challenging test problems for a special relativistic mhd godunov scheme , and stone _ et al . _",
    "( 1992 ) presented a test suite for newtonian mhd codes .",
    "our presentation will conform to the formats of these published results to facilitate comparison .",
    "the propagation of a linear alfvn wave is simple in conception , but , as demonstrated by stone & norman ( 1992 ) , can be quite revealing as a numerical test .",
    "the special relativistic alfvn wave includes the displacement current normally neglected in newtonian mhd .",
    "this is what limits wave speeds to less than @xmath146 .",
    "we consider a fixed background magnetic field @xmath147 in minkowski spacetime with constant fluid velocity @xmath148 and a small transverse perturbation with velocity @xmath149 and ct magnetic field @xmath150 .",
    "the induction and momentum equations for the perturbed quantities have the form given in equations ( [ alfind ] ) and ( [ alfvel ] ) .",
    "equation ( [ alfvel ] ) can be combined with the induction equation ( [ alfind ] ) by taking partial derivatives [ @xmath151 for the former and @xmath152 for the latter ] to get an equation for @xmath149 , @xmath153\\,v^y = 0\\ ] ] which describes the propagation of alfvn waves with speeds @xmath154 where @xmath155 .",
    "( the equation for @xmath150 can be obtained in a similar manner . )",
    "figure [ valfven ] plots @xmath156 as a function of the background velocity of the fluid ( @xmath148 ) for four values of @xmath157 and illustrates several key properties of the wave speeds : ( 1 ) for @xmath158 , waves move with equal and opposite speed ( for all @xmath157 ) ; ( 2 ) @xmath156 is constrained to the upper bound of @xmath159 ; ( 3 ) for a given @xmath157 , there is a @xmath160 that yields a stationary wave , @xmath161 ; ( 4 ) for @xmath162 , both waves move in the same direction , with @xmath163 lagging behind the main fluid flow , and @xmath164 leading ; ( 5 ) as @xmath165 , all wave speeds converge , @xmath166 .",
    "we describe four tests , listed in table [ 1dpulse ] , carried out in a periodic box of width @xmath167 . in each case",
    "the fluid has constant density @xmath168 and energy density @xmath169 .",
    "individual tests are distinguished by the amplitude of the @xmath123-component of the ct magnetic field @xmath147 , given here in terms of @xmath170 , and the amplitude of the background @xmath123-component fluid velocity @xmath148 .",
    "the waves are initialized with a square pulse in the transverse velocity @xmath149 with amplitude @xmath171 , namely @xmath172 the transverse magnetic field is initially zero , @xmath173 .",
    "table [ 1dpulse ] summarizes the results and figure [ v1pulse ] overlays @xmath149 for each test at time @xmath174 at three grid resolutions , @xmath175 , @xmath176 , and @xmath177 zones . in test",
    "alf2 the fast and slow pulses have wrapped around and re - entered the grid from the left , the fast pulse having done so twice . in alf4 , the fast pulse has also wrapped around while the slow pulse is stationary .",
    "( in this linear regime the pulses overlap cleanly provided that the spatial resolution is sufficiently high to minimize losses due to numerical diffusion . ) measuring from the center of each pulse ( originally at @xmath178 ) we verify that the observed pulse speeds agree with ( [ alfven.5 ] ) . with a stationary background , alf1 , the pulses separate from the initial perturbation with equal and opposite velocities and also with equal amplitudes such that @xmath179 . in a moving background , the splitting of the velocity pulses is no longer symmetrical , as is especially obvious in alf2 ( although @xmath179 still holds ) .",
    "the slow velocity pulse has a greater amplitude than the fast pulse .",
    "we find that the ratio of the velocity amplitudes scales inversely with their lorentz factors , @xmath180 it is easy to verify that this holds for each model in table [ 1dpulse ] .",
    "the pulses in the magnetic field variable , @xmath181 , on the other hand , are equal in magnitude and opposite in phase for all @xmath148 .",
    "the numerical values given in table [ 1dpulse ] can be verified by direct computation using results presented in appendix b.    .[1dpulse ] results of 1d alfvn pulse tests .",
    "[ cols= \" < , > , > , > , > , > , > , > , > , > , > \" , ]",
    "to validate the general relativistic aspects of the code we require code tests that involve magnetic fields and the kerr geometry .",
    "test problems with analytic solutions include one dimensional magnetized bondi inflow , and a two - dimensional bondi flow along a split monopole field ; in these tests the field does not affect the dynamics of the problem .",
    "we also perform a one - dimensional magnetized inflow test problem where the field does act dynamically ( gammie 1999 ) .",
    "finally , we have considered two - dimensional magnetized constant-@xmath0 tori that are subject to the magnetorotational instability .",
    "while there is no analytic solution to this problem , the results can be compared to those obtained in non - relativistic simulations .",
    "the analytic expressions for the hydrodynamic bondi solution of hswa are unchanged in the presence of a radial magnetic field ( see proof in appendix a ) .",
    "however , this result does not necessarily hold for a numerical solution to the bondi problem . a non - trivial test of the magnetic components of the code consists , therefore , in maintaining the equilibrium bondi solution for _ any _ magnitude of radial magnetic field .",
    "the magnetized bondi problem is set up in the schwarzschild metric ( @xmath182 ) .",
    "the radial grid extends from just outside the event horizon at @xmath183 to @xmath184 ; the critical point is at @xmath185 .",
    "grids of @xmath186 , @xmath187 , @xmath188 , @xmath175 , and @xmath176 points are used , and the magnetic field at the critical point is set to @xmath189 , and @xmath190 , where the @xmath157 parameter sets the grid - averaged ratio of gas to magnetic pressure",
    ". the bondi solution is generated in the initialization routine by a numerical root - finder on a logarithmically scaled grid of @xmath176 points .",
    "this solution is then sampled at the required resolution for the particular test run ( to ensure proper alignment of the coarser grids ) . to complete the test , the unmagnetic case is also presented .",
    "the solution is allowed to evolve to a time sufficient to allow numerical convergence on each grid ( @xmath191 ) .",
    "figure [ bondierror ] shows the results of spatial accuracy tests .",
    "the spatial accuracy of variable @xmath192 is obtained from the @xmath193 norm over an interval @xmath194 , @xmath195 where @xmath196 denotes the converged solution , and @xmath197 the original solution , as described above .",
    "different regions of the flow are dominated by numerical errors either from a particular routine in the numerical solver or a particular code variable . here , the bounds of integration were chosen to range from @xmath198 to @xmath199 , which represents a region of the flow where pressure error dominates .",
    "figure [ bondierror ] is for the variables @xmath200 , and is typical of error curves for all code variables .",
    "the code is clearly first - order accurate for these variables .    in the split monopole test ,",
    "we initialize a 2d @xmath201 grid with the radial bondi solution , but the radial magnetic field has opposite polarity above and below the equator , hence establishing a current sheet along the equator .",
    "this test is made into a numerical stability test by applying small enthalpy perturbations to the initial state ( without this , the code is simply a set of 1d radial tests ) .",
    "the test is repeated with increasingly large values of magnetic field , until the code breaks .",
    "there is no known analytic solution for the evolution of a current sheet , but it can be used as a probe of the code s stability in the presence of strong , fluctuating current sheets .",
    "the split monopole test was carried out with @xmath202 at the critical point , and a grid of @xmath203 scaled logarithmically in both the @xmath134 and @xmath135 coordinates , with an initial @xmath204 random enthalpy perturbation .",
    "the test was allowed to run to @xmath205 ( @xmath206 free - fall times ) . for @xmath207",
    ", the code variables show no visible change over the course of the run ; the enthalpy perturbations do not grow , nor do they trigger a numerical instability . for @xmath208 , the late - time solution shows evidence of reconnection at the equator near the horizon , and erratic behavior .",
    "the effective @xmath157 where reconnection occurs is of order @xmath209 .",
    "given the moderate resolution , the results are consistent with the spatial accuracy tests in that the region near the horizon requires high resolution in order to minimize numerical error .",
    "gammie ( 1999 ) describes a simplified 1d model for inflow from the inner edge of an accretion disk in the kerr geometry that serves as an excellent test problem for relativistic mhd .",
    "this solution is similar to the weber & davis ( 1967 ) rotating magnetized wind which was used as a test problem stone _",
    "the model assumes that the inflow is cold ( @xmath210 ) , time - steady , purely radial , confined to the equatorial plane , and initiated from the edge of an accretion disk located at the marginally stable orbit ( @xmath211 ) . at @xmath211",
    "the solution is assumed to satisfy the conditions @xmath212 and @xmath213 .",
    "the flow is characterized by a fast magnetosonic critical point .",
    "the numerical procedure to find a particular solution to this inflow is described in appendix d.    our test consists in replicating the solution described by gammie _",
    "( 2002 ) for a flow near a kerr black hole with @xmath214 ( @xmath215 , @xmath216 , @xmath217 ) , with @xmath218 , @xmath219 , @xmath220 , @xmath221 .",
    "the critical point for this test case is @xmath222 .",
    "figure [ g99m1a ] shows a plot of the solution for this test problem on a logarithmically scaled grid of @xmath176 points .",
    "the inner edge of the grid is at @xmath223 and the outer edge of the grid is at @xmath224 . in boyer - lindquist coordinates ,",
    "the event horizon can not be part of the computational domain because of the coordinate singularity . in the gammie inflow test , the marginally stable orbit , which is the formal outer boundary of the problem , is also excluded since the density is divergent as @xmath134 approaches @xmath211 from below .",
    "the plot overlays the late - time solution ( after @xmath225 time steps ) on the initial state , but the two curves are indistinguishable at the chosen plot scale .",
    "figure [ g99err ] shows the results of convergence tests carried out analogously to those for the bondi problem , with the range of integration going from @xmath226 to @xmath224 .",
    "here we have an example of a highly - resolved near - horizon region , and the convergence rate is close to second order .",
    "the final set of tests involve constant-@xmath0 disks ( @xmath227 , the specific angular momentum ) , solutions of the axisymmetric gr hydrodynamic equations described in hswa . here ,",
    "we add weak poloidal magnetic field loops that overlay the hydrodynamic solution ; this will trigger the mri .",
    "we quantify the strength of the magnetic field through the @xmath157-parameter , the ratio of the volume - averaged gas pressure to magnetic pressure .",
    "the initial magnetic field is obtained from the definition of @xmath92 in terms of the @xmath13-vector potential , @xmath228 , @xmath229 restricting the field to poloidal loops is done by using @xmath230 , where @xmath231 using ( [ avec.1 ] ) , it follows that @xmath232 and @xmath233 .",
    "this choice of @xmath234 produces poloidal field loops that coincide with isodensity contours .",
    "the constant @xmath235 is set by the input parameter @xmath157 .",
    "the constant @xmath236 sets a suitable minimum density within the disk , and it is chosen to keep the initial magnetic field away from the outer edge of the disk .    an axisymmetric ( 2d ) magnetized constant-@xmath0 torus",
    "was set up in both the schwarzschild and kerr metrics .",
    "for the schwarzschild case , the disk has a specific angular momentum @xmath237 , an initial pressure maximum at @xmath238 , and an orbital period at the pressure maximum of @xmath239 . for the kerr case , the black hole is maximally rotating , @xmath240 , and the disk has a prograde specific angular momentum @xmath241 , an initial pressure maximum at @xmath242 , and an orbital period at the pressure maximum of @xmath243 .",
    "this particular choice of parameters yields a disk that is similar to the schwarzschild case , although the equipotentials which define the overall disk structure are notably different , as can be seen in the left column of figure [ mri ] .",
    "for both tests the average field strength is @xmath244 , the initial state is perturbed with random @xmath204 enthalpy fluctuations .",
    "the simulations are run for @xmath206 orbits .",
    "the mri develops after a few orbits ( center column , fig .",
    "[ mri ] ) , and is soon fully developed ( right column , fig . [ mri ] ) . by the tenth orbit",
    ", the mri - induced turbulence has settled down considerably , as is to be expected since the imposition of axisymmetry precludes the development of the azimuthal modes which sustain the mri .",
    "the observed qualitative differences between the schwarzschild and kerr cases can be attributed to the different shapes of the potential cusp near the horizon .",
    "the density plots bear a strong resemblance to the previous axisymmetric mri studies of hawley ( 2000 ) in a pseudo - newtonian potential ; this indicates that the numerical solver is well behaved in the moderately strong gravitational fields that exist near the pressure maximum , where the implied code comparison is taking place .",
    "since mri studies are the main area of application of this code , it is reassuring that we can both trigger the mri in a general relativistic treatment of mhd , and that we qualitatively reproduce established results .",
    "( 2002 ) obtain similar results with their mri torus test .",
    "in this paper we document the development of a general relativistic mhd code that is a direct extension of the general relativistic hydrodynamic solver of hawley , smarr and wilson ( 1984b ) . as before ,",
    "the equations of relativistic mhd are written in a nonconservative form , supplemented here by the relativistic induction equation .",
    "the magnetic field is added to the definition of the inertia for the four momentum and the magnetic field adds several source terms to its evolution .",
    "the equations are evolved on a staggered grid using the time - explicit model of `` transport @xmath245 source . ''",
    "the induction equation is evolved using the constrained transport structure of eh88 .",
    "we implement a version of ct that is inspired by the method of characteristics technique employed in the popular zeus code ( stone & norman 1992 ) , yet is simpler to implement in a general relativistic framework .",
    "we have performed a number of 1d and 2d tests to validate the code and to note its limitations .",
    "the tests include a suite of non - relativistic and relativistic mhd shock tube tests , the fast and slow rarefaction and slow magnetosonic shock tests of komissarov ( 1999 ) , and simple alfvn pulse propagation .",
    "the formulation for these test and their results are documented to establish a basis for comparison against other existing and future codes .",
    "the main shortcoming of our code revealed by these tests is due to the already - known limitations of the artificial viscosity algorithm of the underlying hydrodynamic solver .",
    "improvements to this algorithm are an ongoing area of research , but is important to stress that these limitations do not pose an undue restriction on our main area of study : dynamical , mhd - driven accretion flows around spinning black holes .",
    "although the set of general relativistic black hole accretion test problems is limited , we have also verified that the code reproduces the standard results for bondi flow in the presence of magnetic fields , and have observed the triggering and evolution of the mri in thick accretion tori for both the kerr and schwarzschild black holes .",
    "the mri evolution can be compared qualitatively with pseudo - newtonian simulations ( e.g. hawley 2000 ) .",
    "one new test problem with an analytic solution is the magnetized gammie ( 1999 ) inflow test .",
    "this solution examines the behavior of a dynamically important magnetic field in the strong - field region of the kerr metric .",
    "the results of these tests provide evidence that this new solver is correctly reproducing magnetized flows outside the event horizon of a kerr black hole",
    ". this new gr mhd code should provide a valuable tool with which to study accretion flows in the kerr metric .",
    "some of the following proofs use two identities for contractions of the levi - civita tensor , @xmath246 @xmath247 and identities for the @xmath248-symbol , @xmath249 @xmath250    to prove ( [ fmunudef.2 ] ) , it is easiest to work backwards from the result .",
    "expand the right - hand side of ( [ fmunudef.2 ] ) using ( [ bdef.2 ] ) and ( [ dual.2 ] ) ; the resulting expression simplifies through identities ( [ levi.1 ] ) and ( [ delta3 ] ) , followed by the velocity normalization condition , infinite conductivity , and antisymmetry of @xmath22 : @xmath251    to prove ( [ tmunuem ] ) , expand the em component of tensor ( [ tmndef ] ) using ( [ fmunudef.2 ] ) , and simplify using identities ( [ levi.1])-([delta3 ] ) , followed by the velocity normalization condition , and orthogonality condition ( [ bnorm ] ) : @xmath252\\\\ \\nonumber   & = & -{1 \\over 4\\,\\pi }   \\left(g^{\\mu \\gamma}\\ , \\delta^{\\rho\\,\\sigma\\,\\nu}_{\\delta\\,\\epsilon\\,\\gamma}\\,b^{\\delta}\\,u^\\epsilon\\,b_{\\rho}\\,u_\\sigma- { g^{\\mu \\nu } \\over 2}\\,\\delta^{\\rho\\,\\sigma}_{\\delta\\,\\epsilon}\\,b^{\\delta}\\,u^\\epsilon \\,b_{\\rho}\\,u_\\sigma\\right)\\\\ \\nonumber   & = & -{1 \\over 4\\,\\pi }   \\left(-{g^{\\mu\\,\\nu}\\,b^{\\alpha}\\,b_{\\alpha } \\over 2}+ b^{\\mu}\\,b^{\\nu}-b^{\\alpha}\\,b_{\\alpha}\\,u^\\mu\\,u^\\nu\\right)\\\\ \\nonumber   & = &   { 1 \\over 2}\\,g^{\\mu\\,\\nu}\\,{\\|b\\|}^2+u^\\mu\\,u^\\nu\\,{\\|b\\|}^2 -b^{\\mu}\\,b^{\\nu}.\\end{aligned}\\ ] ]    to prove ( [ max2.b ] ) , the second of maxwell s equations , @xmath253 , can be rewritten by substituting definitions , and using identities ( [ levi.2 ] ) and ( [ delta2 ] ) : @xmath254 which simplifies , using ( [ delta2 ] ) , to @xmath255 .    to prove ( [ bsqdef ] ) , we begin with an identity derived from the expression for @xmath52 ( [ gred ] ) , @xmath256 or @xmath257 now expand @xmath258 , @xmath259 and substitute @xmath260 for the spatial components of the magnetic field . making use of the above identity , it follows that @xmath261\\,{(b^t)}^2 + 2\\,g_{t \\phi}\\left [ { { \\cal{b}}^\\phi \\over \\sqrt{4 \\pi}\\,w\\,\\sqrt{\\gamma}}+b^{t}\\,v^\\phi \\right]\\,b^t\\\\ \\nonumber & + & { 2 \\over \\sqrt{4 \\pi}\\,w\\,\\sqrt{\\gamma}}\\,\\left [    g_{rr}\\,{\\cal{b}}^r\\,v^r + g_{\\theta \\theta}\\,{\\cal{b}}^\\theta\\,v^\\theta+    g_{\\phi \\phi}\\,{\\cal{b}}^\\phi\\,v^\\phi \\right]\\,b^t\\\\ \\nonumber & + & { 1 \\over 4 \\pi\\,w^2\\,\\gamma } \\left[g_{rr}\\,{({\\cal{b}}^r)}^2 + g_{\\theta \\theta}\\,{({\\cal{b}}^\\theta)}^2 +    g_{\\phi \\phi}\\,{({\\cal{b}}^\\phi)}^2 \\right ] .\\end{aligned}\\ ] ] now substitute the expression for @xmath95 ( [ bdef.5 ] ) and simplify , noting that @xmath262 to get , after a few steps , expression ( [ bsqdef ] ) .    to derive ( [ alfvel ] ) we first obtain the components of the fluid - frame magnetic field , which are , to leading order , @xmath263 and also note the approximate value for @xmath52 , @xmath264 we then expand the momentum equation and substitute the expressions for @xmath265 and @xmath95 .",
    "the left - hand side of the momentum equation reads @xmath266 -   { g_{xx}\\,g_{yy}\\,{\\cal{b}}^x\\,{\\cal{b}}^y\\,v^x \\over   \\alpha\\,{\\left(\\sqrt{4\\,\\pi\\,\\gamma}\\right)}^2 } \\right ) \\\\",
    "\\nonumber   & \\approx &   { g_{yy}\\,(\\rho\\,h\\,w^2+{\\|b\\|}^2 ) \\over \\alpha } \\,\\partial_t\\,\\left(v^y\\right ) -   { g_{xx}\\,g_{yy}\\,{\\cal{b}}^x\\,v^x \\over \\alpha\\,{\\left(\\sqrt{4\\,\\pi\\,\\gamma}\\right)}^2}\\ ,   \\partial_t\\,\\left({\\cal{b}}^y\\right ) .\\end{aligned}\\ ] ] recall that @xmath123 stands for either @xmath134 or @xmath135 , and @xmath124 stands for a transverse direction , either @xmath134 , @xmath135 , or @xmath142 .    as for the left hand side , we neglect the purely geometric terms and retain only @xmath267    combine these results and replace @xmath268 with the results for the induction equation , @xmath269 by regrouping these terms and substituting the approximate expressions for @xmath52 and @xmath258 given above , equation ( [ alfvel ] ) follows immediately . a similar procedure yields expression ( [ alfvel_phi ] ) for transverse velocities when @xmath270 .    to prove that the bondi solution is unchanged by the presence of a radial magnetic field , we revisit the calculations presented in hswa",
    "we are looking for a time - independent purely radial solution to the equations of grmhd in the presence of a constant ct radial magnetic field @xmath271 in the schwarzschild metric .",
    "we will work with the more general formalism of equations ( [ barcons ] ) and ( [ tmncons ] ) .    the equation of continuity ( [ barcons ] ) is not dependent on magnetic fields , so @xmath272 leads to the same conserved quantity as in the hydrodynamic case , @xmath273 the energy - flux conservation equation is the @xmath42-component of ( [ tmncons ] ) , @xmath274 and contains an explicit dependence on the magnetic field .",
    "however , by expanding the @xmath275 component of the energy momentum tensor , @xmath276 and using equations ( [ fmunudef.3 ] ) and ( [ bdef.5 ] ) to obtain the fluid - frame magnetic field , @xmath277 we obtain after simple substitutions @xmath278 clearly , the magnetic contributions cancel ( this is simply restating the general result that there is no net force due to magnetic fields parallel to the direction of motion ) .",
    "we therefore recover the hydrodynamic expression , @xmath279 which leads to the same conserved quantities as in the hydrodynamic case , @xmath280 and @xmath281",
    "to prove ( [ alfgam ] ) , we used the method of characteristics .",
    "we write the momentum and induction equations as a matrix equation , @xmath282 where @xmath283 and @xmath284 \\ , , \\ , b = \\left [ \\matrix {   1 & \\chi    \\cr   0 & 1    \\cr   } \\right ] \\ , , \\,\\chi = -{\\eta^2 v^x\\over { \\cal b}^x\\ , ( 1+\\eta^2 ) } .\\ ] ] subject to the initial state @xmath285 we obtain the eigenvalues from the roots of @xmath286 , which are simply the expressions for @xmath156 , ( [ alfven.5 ] ) .    to solve this system , we seek a matrix @xmath15 such that @xmath287 where @xmath288 and @xmath289 .",
    "the rows of matrix @xmath15 satisfy @xmath290 .",
    "it is straightforward to show that the matrix @xmath15 has the form , @xmath291 \\ , , \\ , \\zeta =   { { \\cal b}^x ( 1+\\eta^2)\\over \\eta\\,\\sqrt{\\eta^2 + w^{-2 } } } .\\ ] ] we obtain the results @xmath292 which yield @xmath293 as discussed in the text , the velocity amplitudes are clearly asymmetrical , except for the case where @xmath158 , and the magnetic field amplitudes are always equal , but opposite in sign .",
    "it is easy to show that the ratio of the velocity amplitudes is indeed the ratio of the gamma factors , @xmath294 .",
    "it is also possible to verify by direct computation that the amplitudes of the pulses given in the text agree with the above formulas .",
    "relativistic mhd shocks have been discussed by anile ( 1989 ) and komissarov ( 1999 ) .",
    "their work builds upon the monograph of lichnerowicz ( 1967 ) who systematically developed the relations for gr mhd shock invariants .",
    "we summarize here the relevant results from lichnerowicz , translating symbols to our own notation .",
    "we use these results to construct our shock tests .",
    "mhd shocks are discontinuities in one or more of the mhd variables whose propagation through spacetime lies on a hypersurface @xmath295 .",
    "it is useful in the analysis of these shocks to construct a @xmath13-vector @xmath296 normal to @xmath295 .",
    "shocks can be characterized by invariant scalar and @xmath13-vector quantities  the jump conditions  which are derived readily from the equations of grmhd .",
    "mhd shocks can be assigned to one of two categories , tangential and non - tangential , and this classification hinges on whether the invariants have non - zero projections onto the normal @xmath296 .",
    "slow and fast magnetosonic shocks are examples of non - tangential shocks , so it is this type of shock that is of interest here .",
    "the analysis of non - tangential shocks was shown by lichnerowicz to reduce to the study of five scalar quantities , @xmath11 , @xmath297 , @xmath298 , @xmath299 , and @xmath98 which are related through five positive - definite scalar invariants ( derivable from the jump conditions ) , @xmath300 & = & 0 , \\\\",
    "\\label{shkinvarb } \\left[{\\cal{b}}\\right ] & = & \\left[h \\",
    ", \\eta \\right ] = 0,\\\\ \\label{shkinvarh } \\left[{\\cal{h}}\\right ] & = & \\left[{\\eta^2 \\over { \\cal{a}}^2}-    { \\|b^2\\| \\over \\rho^2}\\right ] = 0,\\\\ \\label{shkinvarl } \\left[{\\cal{l}}\\right ] & = & \\left[\\alpha + { q \\over { \\cal{a}}^2}\\right ]   = 0,\\\\ \\label{shkinvark } \\left[{\\cal{k}}\\right ] & = & \\left [    \\left(\\rho^2+{\\cal{a}}^2\\right )   { h^2 \\over \\rho^2}+    k^2 \\left ( 2\\,{h \\over \\rho } - { \\cal{h } } \\right)\\right ] = 0 , \\end{aligned}\\ ] ] where @xmath301 = { \\cal{x}}_{+ } - { \\cal{x}}_{-}$ ] indicates the change in a quantity @xmath302 across the shock , and @xmath303    magnetosonic shocks are characterized by the parameter @xmath7 .",
    "the determination as to whether a magnetosonic wave is fast or slow hinges on the sign of the pre- and post - shock values of parameter @xmath7 .",
    "physically realizable shocks are characterized by @xmath304 .",
    "a slow shock has @xmath305 and a fast shock has @xmath306 .    to construct an initial state ,",
    "we solve the scalar invariants using the mathematica findroot function .",
    "first , we postulate a left state in the rest frame of the shock , where the normal vector @xmath296 has an especially simple expression ( @xmath307 ) .",
    "next , we set up the scalar invariants as a system to be solved by the findroot function , supplying an initial guess for the right state .",
    "this is an iterative procedure , requiring adjustments to the initial guess .",
    "once a solution is found , it is possible to construct a moving shock by repeating the above process with a small non - zero shock speed , for which the normal vector now has the form @xmath308 .",
    "once a solution is found the process is repeated , gradually increasing the shock speed and using the previous converged right state as a starting point for the solution at the new shock speed .",
    "this is a pragmatic solution to a problem that has a high degree of complexity , and it allows us to set up a family of closely related shock solutions to aid in testing .    given that the findroot function has converged on a right state , it is possible to compute the parameter @xmath7 , and classify the shock .",
    "it is also prudent to verify that the left and right states are true solutions by verifying that they satisfy the shock invariants by direct computation .",
    "once this is done , the left and right states can be transferred directly to a numerical grid .",
    "the magnetized gammie inflow is characterized by three conserved quantities , @xmath309,\\\\ f_e & = & -2\\,\\pi\\,r^2\\,{t^r}_{t } = -2\\,\\pi\\,r^2\\,\\left [ \\rho\\,u^r\\,u_t+{g^{rr}\\,g^{\\theta \\theta } \\over 4\\,\\pi}\\ ,   f_{r \\theta}\\,f_{t \\theta } \\right],\\end{aligned}\\ ] ] which are readily derived from the equations of baryon and momentum conservation .",
    "note that gammie writes @xmath310 . from the induction equation ,",
    "@xmath311 we obtain @xmath312 , and @xmath313 which follows from the boundary condition .",
    "infinite conductivity ( @xmath314 ) yields @xmath315 finally , the velocity normalization condition yields @xmath316 where the mix of upper and lower indices was made to coincide with code variables .",
    "the critical point is a saddle point in the two - dimensional parameter space of the energy function @xmath317 .",
    "it is apparent that @xmath318 as given above is not a simple function of these parameters , and it is necessary to substitute the other expressions in order to obtain the desired form for @xmath318 .",
    "since the resulting expression for @xmath318 is quite lengthy , we will only sketch the procedure .",
    "the process of substitution and elimination described here was carried out using mathematica .",
    "first , the conserved quantity @xmath319 is used to obtain @xmath320 .",
    "next , the conserved quantity @xmath321 is used to isolate @xmath322 , @xmath323\\,{1 \\over \\rho u^r}.\\ ] ] now substitute the expressions for @xmath324 and @xmath325 expressed in terms of @xmath326 and @xmath327 , to yield an expression of the form @xmath328 where @xmath329 and @xmath330 are expressions involving the constants @xmath321 , @xmath319 , @xmath331 , and @xmath332 , as well as @xmath333 and metric terms . now substitute this expression for @xmath322 in the velocity normalization condition and",
    "`` solve '' the resulting quadratic for @xmath327 , denote this solution @xmath334 to emphasize that there are two distinct roots .",
    "finally , take the conserved quantity @xmath318 and substitute the expression for @xmath325 ( expressed in terms of @xmath326 and @xmath327 ) and then perform a final substitution for @xmath326 and @xmath327 by @xmath334 . simplify the resulting expression , which has the desired functional form : @xmath335 .",
    "the critical point must satisfy the conditions @xmath336 and the conserved quantity @xmath318 must also satisfy the constraint at the outer boundary @xmath337 these three conditions allow us to solve for @xmath338 , @xmath339 , and @xmath321 .    in order to find the critical point , we will eventually use the findroot function of mathematica , but we first need to obtain a rough location for the saddle point . to do this ,",
    "we produce a coarse contour plot over the range @xmath340 and a large range of @xmath333 , say @xmath341 for a given choice of root of @xmath334 . if the contour plot does not show evidence of a saddle point , we choose the other root .",
    "figure [ fesurf ] illustrates this for our specific test problem .",
    "the saddle point is shown to lie near @xmath342 .",
    "this is then used as an initial guess for the mathematica findroot function , from which the parameters used in the test were obtained .    to generate an initial state within our code",
    ", we apply a numerical root - finder to the energy function @xmath335 ( coded using the mathematica fortranform command ) , and generate a numerical solution for @xmath333 ( using the parameters in the text ) .",
    "once @xmath333 is found , we construct @xmath327 and @xmath322 using the algebraic expressions obtained from mathematica ( also coded using fortranform ) .",
    "once these variables have been initialized the remainder of the code variables can be obtained in a straightforward manner .",
    "anile , a.  m. 1989 , relativistic fluids and magnetofluids ( cambridge : cambridge university press ) balbus , s.  a. , & hawley , j.  f. 1998 , rev .",
    "phys . , 70 , 1 brio , m. , & wu , c.  c. 1988 , j. comput .",
    "phys . , 75 ,",
    "400 clarke , d.  a. 1996 , apj , 457 , 291 de villiers , j.  p. & hawley , j.  f. 2002 , apj , 577 , 866 evans , c.  r. & hawley , j.  f. 1988 , apj , 332 , 659 ( eh88 ) gammie , c.  f. 1999 , apj , 522 , l57 gammie , c.  f. , mckinney , j. , & toth , g. 2002 , apj , submitted hawley , j.  f. 2000 , apj , 528 , 462 hawley , j.  f. & stone , j.  m. 1995 , comput .",
    "comm . , 89 , 127 hawley , j.  f. , smarr , l.  l. , & wilson , j.  r. , 1984a , apj , 277 , 296 ( hswa ) hawley , j.  f. , smarr , l.  l. , & wilson , j.  r. , 1984b , apjs , 55 , 211 ( hswb ) koide , s. , shibata , k. , & kudoh , t. 1999 , apj , 522 , 727 komissarov , s. s. 1999 , mnras , 303 , 343 ( k99 ) komissarov , s. s. 2002 , astro - ph/0209213 .",
    "lichnerowicz , a. 1967 , relativistic magnetohydrodynamics ( new york : benjamin ) lynden - bell , d. & pringle , j.e .",
    "1974 mnras 168 , 603 misner , c.  w. , thorne , k.  s. , & wheeler , j.   a , 1973 , gravitation ( san francisco : w.h .",
    "freeman ) norman , m.  l. & winkler , k .- h .",
    "a. 1986 in astrophysical radiation hydrodynamics , k .- h .",
    "a. winkler & m.  l. norman eds .",
    "( dordrecht : reidel ) , 449 novikov , i.d . & thorne , k .",
    "s. 1973 in black holes  les astres occlus , c. de witt ed .",
    "( new york : gordon and breach ) , 346 ryu , d. , & jones , t.  w. 1995 , apj , 442 , 228 ( rj95 ) shakura , n.  i. & sunyaev , r.  a. 1973 , a&a 24 , 337 stone , j.  m. , hawley , j.  f. , evans , c.  r. , & norman , m.  l. 1992 , apj , 388 , 415 stone , j.  m. & norman , m.  l. 1992 , apjs , 80 , 753 weber , e.  j. , & davis , l. 1967 , apj , 148 , 217 wilson , j. r. 1972 , apj , 173 , 431 wilson , j. r. 1975 , seventh texas symposium on relativistic astrophysics eds : p.g .",
    "bergmann , e.j .",
    "fenyves , and l. motz , ann .",
    "sci.,262 , 123 wilson , j. r. 1977 , in proceedings of the marcel grossman meeting ed .",
    "r. ruffini ( amsterdam : north holland , 1977 ) , 393 wilson , j. r. 1978 , proceedings of international school of physics fermi course lxv , ed .",
    "r. giacooni and r. ruffini ( amsterdam : north holland ) , 644"
  ],
  "abstract_text": [
    "<S> this paper describes the development and testing of a general relativistic magnetohydrodynamic ( grmhd ) code to study ideal mhd in the fixed background of a kerr black hole . </S>",
    "<S> the code is a direct extension of the hydrodynamic code of hawley , smarr , and wilson , and uses evans and hawley constrained transport ( ct ) to evolve the magnetic fields . </S>",
    "<S> two categories of test cases were undertaken . </S>",
    "<S> a one dimensional version of the code ( minkowski metric ) was used to verify code performance in the special relativistic limit . </S>",
    "<S> the tests include alfvn wave propagation , fast and slow magnetosonic shocks , rarefaction waves , and both relativistic and non - relativistic shock tubes . a series of one- and two - dimensional tests were also carried out in the kerr metric : magnetized bondi inflow , a magnetized inflow test due to gammie , and two - dimensional magnetized constant-@xmath0 tori that are subject to the magnetorotational instability . </S>"
  ]
}