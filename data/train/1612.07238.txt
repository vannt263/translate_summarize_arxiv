{
  "article_text": [
    "while deterministic reaction - diffusion models have been successfully applied to explain various spatiotemporal phenomena such as pattern formation , and to gain insight into nonequilibrium phase transitions , it is now widely appreciated that spatiotemporal fluctuations in the concentration of chemical species play an essential role .",
    "such internal or thermodynamic fluctuations , which arise from both reaction and diffusion processes , have molecular origin ; microscopically , those processes occur through the movement and collision of individual molecules under thermal fluctuations . hence , the deterministic macroscopic description eventually fails at smaller scales where the fluctuations are significant , and a stochastic mesoscopic description is needed .",
    "examples include fluctuation - induced instabilities  @xcite , reversal of direction of front propagation  @xcite , violation of the law of mass action  @xcite , long - time tails in kinetics  @xcite , emergence of new steady states  @xcite and patterns  @xcite , and acceleration of pattern formation  @xcite .",
    "due to a small number of proteins involved in cellular functions  @xcite , processes in cell biology are good examples  @xcite where the stochastic reaction - diffusion description provides an indispensable modeling tool  @xcite .",
    "a microscopic picture of reaction - diffusion , dating back to smoluchowski  @xcite , assumes that molecules undergo independent brownian motions and reactions can occur only when two molecules are close to each other .",
    "based on this picture , the particle - based approach to simulate a reaction - diffusion system tracks the trajectories of diffusing molecules and uses the intermolecular distance to determine whether a reaction occurs .",
    "exact sampling of the smoluchowski model can be performed by first - passage kinetic monte carlo type algorithms  @xcite ; approximate reactive brownian dynamics using a fixed time step size forms another class of algorithms  @xcite .",
    "while molecular schemes , such as molecular dynamics ( md ) and direct simulation monte carlo ( dsmc ) , can be used for reaction - diffusion problems  @xcite , they are computationally even more expensive .",
    "hybrid methods combining particle and coarse - grained descriptions , either using operator splitting  @xcite or domain decomposition  @xcite , have also been proposed .    for the mesoscopic description of a reactive system ,",
    "the master equation approach is commonly used . for a well - mixed (",
    "i.e. , spatially homogeneous ) system , the time evolution of the system ( i.e. , the number of molecules of each chemical species ) is described by the chemical master equation ( cme ) .",
    "exact sampling of the cme can be performed by the stochastic simulation algorithm ( ssa ) of gillespie  @xcite , whereas the tau leaping method  @xcite can be employed as an approximate algorithm with a given time step size .",
    "several variants of these methods have been proposed  @xcite . for a spatially inhomogeneous system ,",
    "the time evolution of the system is commonly described by the reaction - diffusion master equation ( rdme ) , which is also known as the multivariate master equation  @xcite . in this approach ,",
    "the system is divided into homogeneous subsystems or cells and the number of molecules of each chemical species in each cell is tracked .",
    "changes in the molecule numbers occur either through hopping events of a molecule between adjacent cells or though chemical reactions within a cell .",
    "hopping events correspond to diffusive transport and are treated as first - order reactions . since the rdme is a spatial extension of the cme , exact sampling of the rdme can be performed by ssa - type algorithms  @xcite , which are called inhomogeneous ssa ( issa ) .    while conceptually simple and still widely used  @xcite , the traditional approach of solving the rdme by issa has the computational issue that the method becomes prohibitively slow as the number of molecules or cells increases .",
    "since the cell volume should be chosen sufficiently small to ensure homogeneity over each cell , large , finely - resolved grids are required for two- or three - dimensional problems .",
    "as the spatial resolution increases , the time interval between successive events becomes very short due to rapid diffusive transfer , and hopping events greatly outnumber reaction events , which slows down issa  @xcite .",
    "several approaches have been proposed to improve the performance of stochastic sampling of the rdme , such as the next subvolume method  @xcite and its parallel simulation version  @xcite .",
    "various implementations of the tau leaping method in a spatial context  @xcite , and the time - dependent propensity for diffusion method  @xcite , have also been proposed . a more aggressive approach to reduce the computational cost by avoiding",
    "the sampling of the individual diffusion events is to split diffusion and reaction in each time step and to treat diffusion in a more efficient manner .",
    "various sampling methods for diffusion have been proposed , including the gillespie multi - particle method  @xcite , the multinomial simulation algorithm  @xcite , the adaptive hybrid method on unstructured meshes  @xcite , and the diffusive finite - state projection algorithm  @xcite .    in this paper",
    ", we propose a fluctuating hydrodynamics ( fhd ) approach for numerical simulation of stochastic reaction - diffusion systems . to incorporate the effects of thermal fluctuations in a fluid , in fhd",
    "one assumes that the dynamics of the fluid can be described by the usual hydrodynamic equations ( e.g. , the navier  stokes equations ) , augmenting each dissipative flux with a stochastic flux  @xcite .",
    "those stochastic fluxes are modeled by spatiotemporal gaussian white noise ( gwn ) and the resulting governing equations are written as stochastic partial differential equations ( spdes ) .",
    "fhd was originally developed for equilibrium fluctuations by landau and lifshitz  @xcite and its validity has been justified for nonequilibrium systems  @xcite through the theory of coarse graining  @xcite .",
    "various extensions and generalizations of the theory have been developed and successfully applied to fluctuation - induced phenomena .",
    "recent work by the authors has focused on fhd models of hydrodynamic transport  @xcite in binary fluid mixtures  @xcite , multiphase flows  @xcite , multispecies fluid mixtures  @xcite , multispecies reactive mixtures  @xcite , and electrolytes  @xcite .",
    "compared to our previous work  @xcite , where the coupling effects of fluid hydrodynamic and chemical fluctuations have been investigated , here we focus on reaction and diffusion and neglect all other hydrodynamic processes ( advection , viscous dissipation , thermal conduction , and cross term effects ) . rather than using a langevin description ( i.e. , based on gaussian fluctuations ) of chemistry , which is only valid in the limit of vanishing fluctuations  @xcite , here we employ a more accurate description of reactions based on poisson fluctuations . as pointed out in ref .",
    "@xcite , even though a formal spde description is employed , the actual interpretation of fhd always requires the notion of a _ coarse - graining _ over a certain length scale .",
    "the fhd equations are discretized using a finite volume approach  @xcite that represents the solution in terms of the average over cells , which provides an effective coarse - graining .",
    "therefore , reactions can be treated in a similar manner to the rdme approach when the spdes are spatially discretized , and integrated in time using ssa or a weakly second - order tau leaping method  @xcite .",
    "the key difference between the fhd and rdme descriptions lies in the more efficient treatment of fast diffusion .",
    "a number of approximate numerical methods for the rdme  @xcite are based on operator splitting using first - order lie or second - order strang splitting  @xcite . in appendix",
    "[ appendix_rdme_based_schemes ] we review and discuss in more detail a split scheme that uses multinomial diffusion sampling  @xcite for diffusion and ssa for reactions .",
    "these rdme - based schemes use a time step size @xmath0 comparable to the hopping time scale @xmath1 with @xmath2 being the spatial dimension , @xmath3 being the grid spacing , and @xmath4 being a typical diffusion coefficient . even though @xmath5 is much larger than the mean duration between successive events in issa , using @xmath0 comparable to @xmath5",
    "is still very restrictive for large @xmath4 or small @xmath3 . in our fhd formulation ,",
    "we treat diffusion implicitly using backward euler or crank  nicolson , so that the time step size can be significantly larger than the hopping time scale .    while the development of numerical schemes for stochastic reaction - diffusion systems described by spatiotemporal gwn dates back to the 1990s  @xcite , much of the prior work has not been guided by numerical analysis or extensive experience from deterministic computational fluid dynamics ( cfd ) . with the help of well - established techniques for numerical solution of pdes and spdes",
    ", we construct numerical schemes in a systematic manner to ensure accuracy is maintained for a large time step size .",
    "to this end , we employ two - stage ( i.e. , predictor - corrector ) runge  kutta temporal integrators  @xcite . rather than using operator splitting , we treat reaction and diffusion together in each stage in a manner that is second - order weakly accurate for general linearized fhd equations .",
    "the construction of these schemes is guided by a stochastic accuracy analysis of the static structure factor for linearized fhd  @xcite .",
    "the fhd approach inherently outperforms the rdme approach as the number of molecules per cell increases in exactly the same way that multinomial diffusion outperforms diffusion by hopping , or tau leaping outperforms ssa .",
    "in fact , the computational cost of fhd methods does not significantly change as the magnitude of the fluctuations changes .",
    "this is an obvious advantage of the fhd approach since the macroscopic limit can not be efficiently simulated by the rdme approach .",
    "however , the validity of the fhd approach can not be taken for granted when there are only a small number of molecules in each cell , since in fhd the number of molecules in each cell is a continuous real - valued variable , rather than a discrete nonnegative integer variable as in the rdme .",
    "we investigate this issue carefully and propose techniques to improve the accuracy of the fhd description for the case of a small number of molecules per cell , making our numerical schemes robust even for large fluctuations . in particular , we develop a spatial discretization that significantly mitigates nonnegativity of the species number densities and closely reproduces the poisson thermodynamic equilibrium distribution for the number of molecules in a cell .",
    "the rest of the paper is organized as follows .",
    "section  [ sec_background ] presents the background for our approach , including the fhd description of reaction - diffusion systems and linearized analysis in a gaussian approximation .",
    "section  [ sec_spatial_discretization ] explains how the fhd reaction - diffusion equations can be spatially discretized using a finite - volume approach .",
    "section  [ sec_temporal_integrators ] presents temporal integrators for the spatially discretized equations that handle diffusion using existing fhd techniques , and treat reactions using ssa or second - order tau leaping .",
    "section  [ sec_numerics ] presents simulation results of several reaction - diffusion systems . in section  [ subsec_schlogl_res ] , for testing and validation of our numerical schemes , we use a one - species schlgl model  @xcite . in section",
    "[ subsec_bpm ] , to compare our methods to each other and to rdme - based methods , we study two - dimensional turing - like pattern formation in the three - species baras  pearson  mansour ( bpm ) model  @xcite . in section  [ subsec_lemarchand_ab ] , to demonstrate the ability of our approach to scale to larger systems , we present numerical simulation results for three - dimensional front propagation in a two - species model  @xcite . in section  [ sec_conclusions ] , we offer some concluding remarks and suggest future research directions .",
    "in section  [ subsec_fhd_description ] , we present the continuous - time continuous - space fhd description of reaction - diffusion systems . here , we assume that fluctuations in chemistry are described by gwn ( i.e. , langevin type ) . a more accurate description of chemistry based on poisson fluctuations is incorporated in the continuous - time discrete - space description in section  [ sec_spatial_discretization ] . in sections",
    "[ subsec_struct_factor ] and [ subsec_schlogl_bg ] , we introduce the structure factor and the schlgl reaction - diffusion model , respectively .",
    "as one of the criteria for the development and analysis of numerical schemes , later in the paper we investigate how accurately a numerical scheme produces the structure factor for the schlgl model .    in this section ,",
    "we introduce several gwn vector and scalar random fields and denote them by @xmath6 and @xmath7 , respectively , with additional superscripts to distinguish the different fields .",
    "we assume that any two distinct processes are independent and that the noise intensity of each process is normalized , @xmath8 and @xmath9 .",
    "similarly , we denote gwn vector and scalar random processes by @xmath10 and @xmath11 , respectively , and assume @xmath12 and @xmath13 .",
    "we consider a reaction - diffusion system having @xmath14 species undergoing @xmath15 reactions in @xmath2-dimensional space . by denoting the number density of species @xmath16 by @xmath17 ,",
    "the equations of fhd for @xmath18 are written formally as the spdes  @xcite @xmath19 where @xmath20 is the diffusion coefficient of species @xmath16 , @xmath21 is the propensity function indicating the rate of reaction @xmath22 , and @xmath23 is the stoichiometric coefficient of species @xmath16 in reaction @xmath22 . in the macroscopic limit of vanishing fluctuations , eq .",
    "approaches the deterministic reaction - diffusion pde ( law of large numbers ) , @xmath24 we explain below how the diffusion and reaction parts are obtained by considering the diffusion - only ( i.e. , no - reaction ) and reaction - only ( i.e. , well - mixed ) cases .",
    "the diffusion - only spde @xmath25 can be justified by considering a microscopic system where each molecule @xmath26 undergoes independent brownian motion , @xmath27 in this _ formal _ derivation  @xcite , one defines the instantaneous number density field @xmath28 and uses ito s rule to obtain eq .  .",
    "this equation can also be obtained from the diffusion portion of the general multispecies fhd equations  @xcite , given by nonequilibrium statistical mechanics  @xcite , by assuming a dilute solution and considering only solute species .",
    "in addition , the linearized version of eq .   can be obtained from the multivariate master equation model ( i.e. , diffusion by hopping ) near the macroscopic limit  @xcite .",
    "however , although relations to those equations reaffirm eq .",
    "near the macroscopic limit , it is important to note that eq .   is formally exact even in the case where fluctuations are large , since it is simply a rewriting of eq .",
    ", in a representation in which the particle numbering ( identity ) is lost  @xcite .",
    "we note that the fhd equations   and are not mathematically well - defined because the solution needs to be interpreted as a distribution ( or a generalized function ) , and the square root of a distribution is not well - defined in general .",
    "the linearized fhd equation does not suffer from such an issue and is well - defined ; the problems arise due to the multiplicative noise in eq .  .",
    "however , even though eq .   is ill - defined , it is formally consistent with the law of large numbers ( given by the deterministic reaction - diffusion equation  ) , the central limit theorem ( given by the linearized fhd equations  ) , and large deviation theory for a collection of brownian walkers . in this sense ,",
    "eq .   is a meaningful _ representation _ of the physical model that is useful in constructing _ well - defined _ mesoscopic descriptions via spatial discretization of the formal spdes .",
    "compared to obtaining a mesoscopic model by directly coarse - graining the microscopic model , the spatial discretization of the spde is easier in general , and can be done in a systematic manner  @xcite .      to see how the reaction part of eq .",
    "is obtained , consider a well - mixed system with volume @xmath29 . by assuming that the time evolution of @xmath30 follows the cme",
    ", we express the change over the infinitesimal time interval @xmath31 as follows  @xcite : @xmath32 where @xmath33 denotes a poisson random variable having mean @xmath34 .",
    "note that eq .",
    "is equivalent to the cme if interpreted in the ito sense .",
    "the specific form of the chemical rate function @xmath21 that we use in this work is described in section  [ subsec_treatments ] .",
    "henceforth , we will formally write eq .   in the differential form , @xmath35 for a more mathematically precise representation , see refs .",
    "@xcite .",
    "the chemical langevin equation ( cle )  @xcite is obtained under the assumption that the mean number of reaction occurrences is large  @xcite .",
    "that is , the assumption enables one to replace @xmath33 by a gaussian random variable having the same mean and variance , to give the cle @xmath36.\\ ] ] since reaction is assumed to be local , the reaction part of eq .",
    "is obtained from spatial extension of eq .  .",
    "one of the important conclusions of our previous work  @xcite was that the langevin description is not consistent with equilibrium statistical mechanics .",
    "alternative formulations based on a langevin diffusion description  @xcite that are consistent at thermodynamic equilibrium fail to correctly model relaxation toward equilibrium  @xcite . instead",
    ", in order to correctly capture both small fluctuations and large deviations in equilibrium and non - equilibrium contexts , one must retain a description of chemical reactions as a markov jump process . that is , one must describe reactions using a stochastic differential equation driven by poisson rather than gaussian noise .      the structure factor ( spectrum )",
    "@xmath37 is the variance of the fourier mode of the number density of species @xmath16 , @xmath38 where we have assumed a periodic domain of volume @xmath39 , and defined @xmath40 , where the brackets @xmath41 denote the equilibrium average .",
    "here we derive an analytic expression of the structure factor from the linearized fhd equation .",
    "we assume that there is only one species , @xmath42 , and drop the subscript @xmath16 for species , to write eq .",
    "as @xmath43 where @xmath44 and we have expressed fluctuations arising from all reactions by a single gwn field @xmath45 . at a spatially uniform stable steady state , @xmath46 fluctuates around mean number density @xmath47 , where @xmath48 and @xmath49 .",
    "the linearization of eq .   around this equilibrium state",
    "is given by the central limit theorem , @xmath50 where @xmath51 is the effective reaction rate near equilibrium and @xmath52 .",
    "the fourier transform of eq .",
    "gives @xmath53 since eq .   has the form of the ornstein  uhlenbeck equation  @xcite , the structure factor is easily obtained as @xmath54 where @xmath55 denotes the penetration length . from eq .",
    ", we observe that there are two limiting cases . in the small wave number limit @xmath56 , @xmath57 becomes @xmath58 and does not depend on diffusion .",
    "in fact , the result @xmath59 is also obtained from the cme assuming the whole system is well - mixed . on the other hand , in the large wave number limit @xmath60 ,",
    "@xmath57 becomes @xmath61 , which is the result for the diffusion - only system .",
    "hence , fluctuations are reaction - dominated at a length scale larger than @xmath62 and are diffusion - dominated at a length scale smaller than @xmath62 .",
    "we also observe that if the system is in detailed balance at its steady state , i.e. , it is in thermodynamic equilibrium , then @xmath63 and @xmath64 , consistent with a product poisson distribution with mean number density @xmath61 .",
    "therefore , in true thermodynamic equilibrium the statistics of the fluctuations are independent of any kinetic parameters , as they must be according to equilibrium statistical mechanics  @xcite . in particular , the presence of the reactions does not change the poisson statistics of the state of thermodynamic equilibrium . in section  [ subsec_schlogl_res ] , we use this property to judge the quality of numerical schemes .",
    "the schlgl model  @xcite is given by the chemical reactions for species @xmath65 , @xmath66 hence , we have @xmath42 , @xmath67 , @xmath68 , @xmath69 , @xmath70 , and @xmath71 . due to the cubic nonlinearity of @xmath72 ,",
    "the well - mixed system exhibits several kinds of distributions depending on the values of the rate constants .",
    "if detailed balance is satisfied , that is , @xmath73 and @xmath74 , the system is in thermodynamic equilibrium and the distribution follows poisson statistics with mean number density @xmath75 .",
    "otherwise , depending on the number of real roots of @xmath76 , the system exhibits a monostable distribution ( for a single positive root ) or a bistable distribution ( for three positive roots )  @xcite .",
    "the structure factor of the spatially extended schlgl model can be calculated from eq .  .",
    "as expected from the fact that the equilibrium distribution of the system follows poisson statistics , @xmath77 in the case of thermodynamic equilibrium .",
    "note , however , that having a monostable distribution does _ not _ imply thermodynamic equilibrium .",
    "the structure factor of the out - of - equilibrium monostable case is not flat but exhibits a transition near @xmath78 . for the bistable case exhibiting metastability ,",
    "the linearized theory is still applicable if one looks at fluctuations around one of the two peaks .",
    "however , in this work we focus on the equilibrium and out - of - equilibrium cases where @xmath72 has a single positive root .",
    "in this section , we discuss spatial discretization of the fhd equation using a finite - volume approach  @xcite that converts the spde into stochastic ordinary differential equations ( sodes ) for the cell number density @xmath79 .",
    "we develop numerical schemes to solve these sodes in section  [ sec_temporal_integrators ] . in section",
    "[ subsec_spatial_discretization_diff_only ] , we first discretize the diffusion - only spde  . in section  [ subsec_spatial_discretization_react_diff ] , we add reactions and present the continuous - time discrete - space description of the reaction - diffusion system . in section  [ subsec_treatments ] , we discuss techniques to handle a small number of molecules per cell .    for simplicity , in this paper",
    "we only consider periodic systems .",
    "however , our methods can be straightforwardly generalized to standard types of physical boundary conditions ( dirichlet , neumann or robin ) . in particular",
    ", since chemistry is local and does not require boundary conditions , one can rely on methods we have developed in prior work without chemistry ; see , for example , the discussion in ref .",
    "@xcite .      due to the lack of regularity of @xmath80 in eq .",
    ", pointwise values of @xmath17 are not physically meaningful .",
    "hence , we consider instead the spatial average of @xmath17 over a cell .",
    "we partition the system domain @xmath81 into cells of volume @xmath82 and denote the cell number density of species @xmath16 in cell @xmath83 as @xmath84 we denote the face of a cell using the index @xmath85 . if two contiguous cells have indices @xmath86 and @xmath87 ( with @xmath88 being the unit vector along the @xmath89-axis ) , the face @xmath85 shared by the cells is denoted by @xmath90 .",
    "finite - volume spatial discretization in two dimensions .",
    "the cell - averaged number density @xmath79 is associated with the circles , and the face - averaged stochastic diffusive flux is associated with the crosses .",
    "the stochastic diffusive flux between the two cells having the red circles at center is depicted by the blue arrow.,width=192 ]    to obtain a spatial discretization of eq .",
    "that ensures discrete fluctuation - dissipation balance  @xcite , we use the standard second - order discrete laplacian operator for the deterministic diffusion part @xmath91 and introduce a staggered grid for the stochastic diffusive flux term @xmath92 , see fig .",
    "[ fig_cell ] . for @xmath93 , a formally second - order spatial discretization of eq .",
    "is written as @xmath94 the spatial average of @xmath17 over the interval of length @xmath3 around face @xmath95 is approximated by @xmath96 , whereas that of @xmath97 is modeled by @xmath98 . to close the equation ,",
    "@xmath96 is approximated by an average of @xmath99 and @xmath100 , that is , @xmath101 .",
    "natural candidates for the averaging function @xmath102 would be the pythagorean means : the arithmetic , geometric , and harmonic means .",
    "we choose a modified arithmetic average for @xmath102 described in section  [ subsec_treatments ] , for reasons detailed in appendix  [ appendix_averaging_function ] .",
    "generalization of the spatial discretization   to higher dimensions is straightforward . for each face , a gwn process @xmath103 is defined and @xmath104 is calculated from the cell number densities of the two cells sharing the face by using the averaging function @xmath102 , see fig .",
    "[ fig_cell ] . by introducing notations @xmath105 , @xmath106 , and @xmath107 , we express the resulting sodes for @xmath108 as @xmath109 with the understanding that @xmath110 denotes the standard @xmath111-point discrete laplacian operator , and @xmath112 denotes a discrete divergence operator .      by combining eqs .   and",
    "we obtain the spatial discretization of the reaction - diffusion fhd equations as a system of ito sodes , @xmath113 in eq .",
    "fluctuations in the reaction rate are modeled as gwn , while in eq .",
    "we assume poisson fluctuations . since the latter fluctuations are consistent with discrete nature of reactions based on the cme , the description in eq .",
    "is physically more accurate .",
    "in fact , it has been shown that the cle description can give physically incorrect results since it is _ not _ consistent with a gibbs  boltzmann or einstein equilibrium distribution , even for the case of a single well - mixed cell  @xcite .",
    "as shown above , the inclusion of poisson fluctuations for reaction , however , requires the notion of a mesoscopic cell and thus can be realized only after the spde is spatially discretized .",
    "the choice of appropriate cell size is a delicate issue for the rdme and fhd descriptions .",
    "an upper bound on the cell size is given by the penetration depth due to the underlying assumption that each cell is homogeneous and reactions occur within a cell .",
    "in fact , there is not only an upper bound of the cell size for a valid description but also a lower bound .",
    "this can be seen by considering the fact that bimolecular reactions would become increasingly infrequent as the cell size decreases  @xcite .",
    "several criteria for choosing the cell size have been proposed based on physical arguments  @xcite and mathematical analysis  @xcite .",
    "for a small value of the cell size , corrections in the rate constants of bimolecular reactions have been proposed  @xcite .",
    "however , these corrections do not fix the underlying problem which comes from the fact that reactions are treated as a purely local process with no associated spatial length scale . in microscopic ( particle ) models of reaction - diffusion such as the smoluchowski  @xcite model or the doi model  @xcite , a microscopic reactive distance appears and controls the reaction rate for diffusion - limited reactions . by introducing a reactive distance into the model , and relaxing the restriction that a reaction should occur among the molecules in the same cell",
    ", a modified convergent rdme having well - defined limiting behavior for small cell size can be developed  @xcite , and could be combined with our fhd description of diffusion .      the spatially discretized fhd equations   or are well defined but suffer from two issues that we now address .",
    "first , the number of molecules in a cell ( i.e. , @xmath114 ) is not an integer .",
    "second , the cell number density can become negative . when there are a small number of molecules per cell in the system , the behavior of the fhd description   depends sensitively on the averaging function @xmath115 and the propensity functions @xmath116 , that appear in the multiplicative noise terms .",
    "hence , we carefully modify the form of @xmath115 and @xmath116 for negative or very small densities in order to greatly reduce the chances of producing future negative densities .    in section [ subsec_schlogl_res ] , we demonstrate that the arithmetic mean produces more accurate results for the equilibrium distribution than the other pythagorean means .",
    "based on the analysis given in appendix  [ appendix_averaging_function ] , we use the following modification to the arithmetic mean : @xmath117 where @xmath118 is a smoothed heaviside function .",
    "the smoothed heaviside function @xmath119 is introduced to ensure the continuity of @xmath115 at @xmath120 or @xmath121 . as explained in appendix  [ appendix_averaging_function ] , this averaging function guarantees nonnegativity for the diffusion - only system   in the continuous - time description . in our simulations , we find this modification greatly reduces the occurrence of negative density while closely matching the true equilibrium distribution , noting that in our formulation the stochastic diffusive flux is _ continuously _ turned off at @xmath122 or @xmath123 .",
    "we also note that the smoothing is based on the number of molecules in a cell and if both cells have at least one molecule ( i.e. , @xmath124 ) , @xmath115 becomes exactly the arithmetic mean .",
    "as shown in appendix  [ appendix_averaging_function ] , the local modification near @xmath125 does not cause any noticeable unphysical behavior for @xmath124 . in section  [ sec_numerics ] , we demonstrate that our numerical schemes based on eq .",
    "work very well even for a small number of molecules per cell .    for the propensity functions @xmath21",
    ", we use the following correction to the law of mass action , which is usually included in the rdme description : if the deterministic rate expression contains @xmath126 ( or @xmath127 , @xmath128 ) , replace it by @xmath129 ( or @xmath130 , @xmath128 ) . with this correction , at thermodynamic equilibrium ,",
    "the mean reaction rate becomes equal to the one calculated from the deterministic rate expression with the mean number density .",
    "this can be seen from the fact that if @xmath131 follows poisson statistics with mean @xmath132 , @xmath133 and @xmath134 .    when reactions are combined with an fhd treatment of diffusion , number densities are no longer restricted to nonnegative integers and special treatment is required to make reaction rates nonnegative and physically sensible for small numbers of molecules . in this work",
    ", we evaluate the rate @xmath21 by using continuous - range number densities @xmath135 ( i.e. , without trying to round @xmath136 to integers ) and ensure that each term in the rate of each reaction is nonnegative .",
    "for example , we take the rate expression of the schlgl model ( see section  [ subsec_schlogl_bg ] ) to be @xmath137 where @xmath138 .",
    "in this section , we develop temporal integrators for the spatially discretized fhd equation  .",
    "our goal is twofold .",
    "first , we construct numerical methods that allow for a large time step size even in the presence of fast diffusion . by treating diffusion implicitly , the severe restriction on time step size can be bypassed .",
    "second , we construct methods that maintain accuracy even if the time step size is much larger than the diffusive hopping time . since it is quite difficult to achieve second - order weak accuracy for general multiplicative noise  @xcite , our goal here is to ensure second - order accuracy where possible . in the limit",
    "in which the number of molecules per cell is very large and one can replace random numbers by their means , our schemes reduce to standard second - order schemes for deterministic reaction - diffusion pdes . for linearized fhd ,",
    "our midpoint tau leaping - based schemes are second - order weakly accurate , and all midpoint schemes reproduce at least second - order accurate static correlations , i.e. , structure factors .",
    "we build on previous work by some of us  @xcite and propose two ( semi- ) implicit schemes as an alternative numerical method to conventional rdme methods .",
    "we mainly consider the case where diffusion is much faster than reaction and molecules on average diffuse more than a cell length per time step ( i.e. , @xmath139 ) .",
    "we focus here on _ unsplit _ schemes that do not rely on operator splitting .",
    "this is because we found that unsplit schemes give notably more accurate structure factors than corresponding split schemes in our case .",
    "in addition , including other transport processes ( e.g. , advection ) and handling boundary conditions  @xcite to second order is not straightforward for split schemes .",
    "it is convenient to introduce dimensionless numbers , @xmath140 and @xmath141 , which measure how fast diffusion and reaction are relative to the given time step size @xmath0 , respectively . for the single - species equation  ,",
    "assuming @xmath142 , we define @xmath143 where @xmath22 is the chemical relaxation rate appearing in the linearized equations  .",
    "hence , we can express the well - mixed condition ( i.e. , the penetration depth @xmath144 ) as @xmath145 .",
    "in addition , the numerical stability condition of a scheme can also be given in terms of @xmath140 and @xmath141 .",
    "that is , if reaction and/or diffusion are treated explicitly in a scheme , values of @xmath140 and/or @xmath141 larger than a stability threshold cause numerical instability . for @xmath145 , the stability limit",
    "is mainly determined by fast diffusion : @xmath146 note that the stability limit becomes severe for large diffusion coefficients and small grid spacing and worsens with increasing dimension .",
    "in section  [ subsec_fhd_based_schemes ] , we present several numerical schemes for the fhd equation  , including two implicit schemes , and analyze the temporal orders of accuracy for the structure factors using the linearized analysis described in appendix  [ appendix_linearized_eqn_analysis ] . in section  [ subsec_struct_factor_analysis ] , we analyze the stochastic accuracy of the numerical schemes for large @xmath0 by investigating the structure factor of the one - dimensional schlgl model at different wavenumbers .",
    "since analysis for the nonlinear equations is lacking at present , we numerically justify the handling of multiplicative noise in section  [ subsec_schlogl_res ] .      the simplest method for integrating eq .   in time is the _ euler  maruyama tau leaping _ ( emtau ) scheme , @xmath147 where superscripts denote the point in time at which quantities are evaluated , e.g. , @xmath148 and @xmath149 , and we have used the compact notation for spatial discretization introduced in section  [ subsec_spatial_discretization_react_diff ] . here , @xmath150 has been replaced by @xmath151 , where @xmath152 denotes a collection of standard random gaussian variables sampled independently for each species on each grid face at each time step .",
    "that is , the stochastic diffusive flux of species @xmath16 on face @xmath85 at time step @xmath153 is proportional to @xmath154 .",
    "we also construct numerical schemes where reactions are treated by ssa , which is an exact ( exponential ) integrator for reactions .",
    "we denote by @xmath155 the ( random ) change in the number density of species @xmath16 for a cell with initial state @xmath135 obtained from ssa over at time interval @xmath156 ( in the absence of diffusion ) .",
    "we can then write the _ euler  maruyama ssa _",
    "( em - ssa ) scheme as @xmath157    the emtau scheme is _ explicit _ in the sense that all terms on the right - hand side of eq .   can be evaluated without knowing @xmath158 .",
    "however , a simple analysis shows that the time step size is constrained by a stability condition ( for derivation , see eq .  )",
    "@xmath159 which reduces to condition   for @xmath145 .",
    "since the em - ssa scheme treats reactions using an exponential integrator , it is only subject to the stability limit   without a restriction on @xmath140 .",
    "the stability limit imposed by fast diffusion can be overcome by using standard _",
    "implicit _ methods such as the second - order implicit midpoint or crank  nicolson method , which gives a system of linear equations for @xmath158 : @xmath160 the linear system   can be solved efficiently iteratively using multigrid relaxation  @xcite ; for @xmath161 , solving the linear system is not much more expensive than a step of a second - order explicit time stepping scheme .",
    "note , however , that scheme   is only first order accurate overall for reaction - diffusion systems .",
    "hence , in addition to improved _ stability _ , it is important to develop higher - order schemes to improve _",
    "accuracy_. note that this is not as simple as replacing tau leaping in eq .   with ssa as in eq .",
    "; this would still be only first - order accurate even in the deterministic limit .",
    "here we construct numerical schemes based on the second - order temporal integrators for the linearized equations of fhd developed in refs .",
    "those temporal integrators are second - order accurate in the weak sense for additive noise , and are used here as the basis for handling diffusion . in order to add reactions into diffusion - only schemes , we consider two types of sampling methods , tau leaping and ssa . for tau leaping ,",
    "we use the weakly second - order tau leaping method  @xcite ; a similar two - stage scheme has been originally proposed for the cle  @xcite to achieve second - order weak accuracy .",
    "here we combine predictor - corrector midpoint schemes proposed in ref .",
    "@xcite ( for diffusion ) and the second - order tau leaping method ( for reaction ) . owing to similar two - stage structures of those schemes",
    ", they fit together in a rather natural manner .",
    "in addition , since the resulting schemes still fit the framework of the implicit - explicit algorithms analyzed in ref .",
    "@xcite , they are second - order weakly accurate for additive noise and an additional order of accuracy ( i.e. , third order ) is gained for the structure factor .",
    "we also develop midpoint schemes that use ssa instead of tau leaping for reactions . unlike tau leaping - based schemes",
    ", the ssa - based schemes do not suffer from instability even in the presence of rapid reactions .",
    "the use of ssa may also help to prevent the development of negative densities , which is one of the main numerical issues for large fluctuations .",
    "hence , while ssa - based numerical schemes are computationally more expensive , they work better than tau leaping - based schemes when reactions are fast or when the number of molecules is small .",
    "the ssa - based schemes we propose here belong to a class of exponential runge ",
    "kutta schemes , and we construct them to ensure second - order deterministic accuracy , as well as second - order accuracy for the structure factor ; a detailed analysis of their weak accuracy is at present missing even for linearized fhd .      as a prelude to constructing two - stage implicit methods , we first consider improving the accuracy of the explicit emtau scheme   by using an explicit two - stage runge  kutta ( predictor - corrector ) approach . by combining the explicit midpoint predictor - corrector scheme from refs .",
    "@xcite ( for diffusion ) and the midpoint tau leaping scheme from refs .",
    "@xcite ( for reaction ) , we obtain the _ explicit midpoint tau leaping _ ( exmidtau ) scheme :    [ exmidtau ] @xmath162    where the superscripts @xmath163 and @xmath164 indicate that the terms correspond to the first and second half of the time step , respectively . that is , @xmath165 ( and similarly for @xmath166 and other random increments ) denotes the _ same _ random number in both predictor and corrector stages , and is only sampled once per time step . following refs .",
    "@xcite , the mean reaction rate for the second half step is corrected to @xmath167 , where @xmath168 .    for the magnitude of the stochastic diffusive fluxes over the second half of the time step , we consider the following three options for the face average value @xmath169 :    [ midpoint_stoch_flux_type ] @xmath170    while all options are consistent with the ito interpretation , the effect of this choice on accuracy requires a nonlinear analysis that is not available at present .",
    "the option   is used in ref .",
    "@xcite and shown to lead to second - order weak accuracy for fhd equations linearized around a time - dependent macroscopic state .",
    "the option   is inspired by the midpoint tau leaping scheme  @xcite .",
    "however , it does not actually lead to second - order weak accuracy for multiplicative noise because the fluctuating diffusion equation does not have the simple noise structure that the cle has  @xcite . for all our simulations , we use option  , as justified by numerical results in section  [ subsec_schlogl_res ] .    the reactions can also be treated using ssa , to give the _ explicit midpoint ssa _ ( exmidssa ) scheme    [ exmidssa ] @xmath171    here the predictor stage  + is a split reaction - diffusion step , but the corrector is not split .",
    "note that two @xmath172 appearing in eqs .   and are the same random increment computed using ssa .",
    "in other words , the ssa algorithm is called once for each half of the time step ; this has the same computational cost as calling ssa once to compute @xmath173 in the em - ssa scheme  .    since both exmidtau and exmidssa schemes treat diffusion explicitly , they are subject to stability limits .",
    "the exmidtau scheme has the same stability limit   as the emtau scheme , whereas the exmidssa scheme is subject to the same limit   as the em - ssa scheme .",
    "the exmidtau scheme with the option   is an instance of the explicit midpoint scheme analyzed in ref .",
    "@xcite for weak noise ( i.e. , linearized fhd ) , and therefore achieves second - order weak accuracy for linearized fhd and gives third - order accurate equilibrium structure factors . on the other hand ,",
    "the exmidssa scheme gives only second - order accurate structure factors .",
    "here we present two implicit midpoint schemes , where diffusion is treated implicitly based on the implicit midpoint predictor - corrector scheme  @xcite . by treating reactions using the second - order midpoint tau leaping scheme  @xcite , we obtain the _ implicit midpoint tau leaping scheme _ ( immidtau ) scheme :    [ immidtau ] @xmath174    where the three options for @xmath169 are given in eq .  .",
    "when ssa is used for the reactions , we obtain the _ implicit midpoint ssa scheme _ ( immidssa ) scheme ,    [ immidssa ] @xmath175    in the corrector stage , both schemes treat diffusion using the crank  nicolson method since this gives the most accurate structure factors for diffusion - only systems  @xcite . for the predictor step to the midpoint",
    ", we have chosen to use backward euler for diffusion because this was found to be optimal using the structure factor analysis discussed in more detail in section  [ subsec_struct_factor_analysis ] .",
    "we point out again that the difference in how reactions are included in the immidtau and immidssa schemes stems from the fact that ssa is an exponential integrator whereas the midpoint tau leaping method is only a second - order integrator .",
    "this difference must be taken into account when analyzing the accuracy of ssa - based schemes both in the deterministic limit and in structure factor analysis . like the explicit midpoint schemes in section  [ subsubsec_exmid ] , for linearized fhd ,",
    "the immidtau scheme is second - order weakly accurate and gives a third - order accurate structure factor , whereas the immidssa scheme gives only a second - order accurate structure factor .",
    "since diffusion is treated implicitly in both schemes , they are _ not _ subject to a stability limit depending on @xmath141 . however , due to the explicit treatment of reactions , the immidtau is subject to the stability condition @xmath176 .",
    "the immidssa scheme is unconditionally linearly stable and has no stability restrictions on @xmath140 and @xmath141 but can be considerably more expensive for systems with large numbers of molecules .",
    "a key element of this work that distinguishes it from our previous work based on cle @xcite is that here we replaced the gwn in the chemical noise with poisson noise , and used a weakly second - order tau leaping method  @xcite to account for the non - gaussian nature of the chemical fluctuations .",
    "it is important to note that poisson noise does not have a continuous range limit , i.e. , the poisson distribution remains integer - valued even as the number of molecules per cell becomes very large .",
    "although it is tempting to replace the poisson distribution with a gaussian distribution , this changes the large deviation functional and therefore we recommend using tau leaping even in the case of weak fluctuations ; we note that sampling from a poisson distribution can be done with a cost essentially independent of the mean using well - designed rejection monte carlo methods . because of the use of poisson variates , which can not be split into a mean and a fluctuation like a gaussian variate can , there is no strict `` deterministic limit '' for our fhd discretizations . while the handling of diffusion degenerates to a standard second - order deterministic scheme in the absence of the noise , the chemical noise is always present and increments or decrements the number of molecules by integer numbers .",
    "analyzing the accuracy of temporal integrators for stochastic differential equations is notably nontrivial , especially if driven by multiplicative noise .",
    "as mentioned above , because of the multiplicative noise , all of our midpoint schemes are formally only first - order weakly accurate . however , traditional weak - order accuracy is not the most important goal in fhd simulations . as first argued in ref .",
    "@xcite and then elaborated in refs .",
    "@xcite , for fhd it is more important to attain _ discrete fluctuation - dissipation balance _ and higher - order accuracy for the spectrum of the equilibrium fluctuations .    here , we analyze the accuracy of our numerical schemes by investigating the structure factor @xmath177 for the one - dimensional linearized fhd equation  .",
    "the analytic expression for @xmath177 produced by a given scheme can be obtained as a function of @xmath3 and @xmath0 following the procedure described in appendix  [ appendix_linearized_eqn_analysis ] . of specific interest to us",
    "is how accurately the implicit schemes reproduce @xmath177 at large wavenumbers corresponding to length scales comparable to @xmath3 ( i.e. , @xmath178 ) when diffusion is the fastest process , @xmath179 .",
    "this is because incorrect diffusive dynamics at grid scales for @xmath180 can lead to gross errors in the magnitude of the fluctuations at large wavenumbers .",
    "errors in the structure factor arise from two sources : spatial and temporal discretization . as explained in appendix  [ appendix_linearized_eqn_analysis ]",
    ", the predominant contribution of spatial discretization is to replace @xmath181 with the symbol of the standard discrete laplacian . in one dimension ,",
    "this simply amounts to replacing @xmath153 in the continuum expressions with the modified wavenumber @xmath182 defined by @xmath183 note that exactly the same expression applies to the rdme , where diffusion is simulated by lattice hops . in order to focus our attention on temporal integration errors",
    ", we will plot discrete structure factors as a function of @xmath182 instead of @xmath153 , which effectively removes the spatial errors .",
    "discrete structure factors @xmath184 for the exmidtau , immidtau , exmidssa , and immidssa schemes for the one - dimensional linearized fhd equation   with @xmath185 ( e.g. , an out - of - equilibrium monostable schlgl model ) .",
    "note that different values of @xmath141 are chosen for the explicit schemes ( @xmath186 ) and the implicit schemes ( @xmath187 ) and @xmath140 is chosen as @xmath188 .",
    "the exact continuum result   is depicted by the dotted line . ]",
    "figure  [ fig_sk_analysis_fhd ] illustrates how @xmath177 deviates from the exact result   at different wavenumbers for large @xmath0 .",
    "we compare @xmath177 obtained from the four schemes by using values @xmath189 , @xmath190 for the explicit schemes , and @xmath191 and @xmath192 for the implicit schemes .",
    "note that these values correspond to a case where the time step size is chosen as half of the stability limit @xmath193 for the explicit schemes and , it is increased by factor of 20 ( @xmath194 ) for the implicit schemes . as described below",
    ", the accuracy at diffusion - dominated scales @xmath195 and reaction - dominated scales @xmath196 largely depend on how diffusion ( i.e. , explicit or implicit ) and reaction ( i.e. , tau leaping or ssa ) are treated , respectively .    as the time step size approaches the diffusive stability limit , @xmath197 in one dimension , the explicit schemes become inaccurate and eventually numerically unstable at the largest wavenumbers , as seen in the figure for @xmath198 . due to the small values of @xmath140 , both schemes give accurate results for reaction - dominated scales . note , however , that the ssa - based schemes give exact @xmath199 and they are in general more accurate at reaction - dominated scales than the corresponding tau leaping - based schemes .",
    "hence , we see that , for @xmath200 , the accuracy of the explicit schemes is largely affected by numerical instability arising from diffusion .",
    "on the other hand , both implicit schemes give fairly good @xmath177 in the overall range of @xmath153 even though @xmath0 is twenty times larger and @xmath187 .",
    "as expected , the immidssa scheme is more accurate for reaction - dominated scales @xmath56 , for which the immidtau scheme shows some errors because of the relatively large value of @xmath191 .",
    "however , for intermediate scales @xmath201 , the immidtau scheme is more accurate because it attains third - order accuracy for static covariances .    at diffusion - dominated scales",
    "@xmath195 , both implicit schemes give accurate results .",
    "this is not accidental , for we have selected these schemes from a family of schemes parameterized in ref .",
    "@xcite exactly for this reason .",
    "specifically , the treatment of diffusion in both schemes is based on the implicit midpoint scheme ( crank  nicolson ) , which gives the exact @xmath177 in the absence of reactions  @xcite .",
    "in addition , reaction is incorporated in a way that maintains fluctuation - dissipation balance for @xmath195 even for relatively large values of @xmath140 . for small @xmath140 , the time integration error of the immidtau scheme for the structure factor at the maximum wavenumber @xmath202",
    "is estimated as @xmath203 where @xmath204 is the structure factor in the absence of temporal integration errors ( see appendix  [ appendix_linearized_eqn_analysis ] ) .",
    "hence , for a given value of @xmath140 , @xmath177 gives accurate results at @xmath60 for large @xmath141 .",
    "for the immidssa scheme , @xmath141 in the numerator is replaced by @xmath205 and a similar stable behavior for large @xmath141 is observed . by expanding @xmath206 for small @xmath0",
    ", we also see that the error is @xmath207 for the immidtau scheme , whereas it is @xmath208 for the immidssa except at thermodynamic equilibrium ( i.e. , except when @xmath209 ) , where it is third - order accurate .",
    "we perform numerical simulations for the following three stochastic reaction - diffusion systems . in section  [ subsec_schlogl_res ] , we use the equilibrium schlgl model in one , two , and three dimensions to validate our numerical methods . the analysis in section  [ subsec_struct_factor_analysis ] assumed additive noise , reflecting a large number of molecules per cell . here",
    "we present numerical results demonstrating that the methodology continues to work when there are a small number of molecules per cell and the effects of multiplicative noise are significant .",
    "in particular , we show that our numerical methods , including the modified arithmetic - mean averaging function discussed in section  [ subsec_treatments ] , accurately reproduce the poisson statistics that characterize the thermodynamic equilibrium distribution . in sections  [ subsec_bpm ] and [ subsec_lemarchand_ab ] , we study the effects of fluctuations on chemical pattern formation . in section  [ subsec_bpm ] ,",
    "we test our numerical methods on a time - dependent problem : two - dimensional turing - like pattern formation in the three - species bpm model  @xcite .",
    "we investigate how accurately both time - transient and steady state behavior are captured for the immidtau and immidssa schemes when a large time step size is used .",
    "we consider the case where the populations of chemical species have different orders of magnitude , which is a frequently encountered situation where a conventional rdme - based method may not work efficiently .",
    "we demonstrate that the immidtau scheme scales very well with an increasing number of molecules per cell so that even the deterministic limit of vanishing fluctuations can be explored . in section  [ subsec_lemarchand_ab ]",
    ", we demonstrate the scalability to large systems and computational efficiency of our fhd approach by presenting a three - dimensional numerical simulation of chemical front propagation in a two - species model  @xcite . as a reference method for comparison",
    ", we use an rdme - based method , as proposed in appendix  [ appendix_rdme_based_schemes ] , which is constructed via a standard operator splitting technique by combining multinomial diffusion sampling  @xcite and ssa .",
    "such a split scheme is notably more efficient than issa when there are a large number of molecules per cell , and becomes an exact sampling method for the rdme in the limit @xmath210 .",
    "this rdme - based scheme works with nonnegative integer populations and reproduces correct fluctuations at thermodynamic equilibrium",
    ". however , diffusion imposes the same restriction   on @xmath0 , and the split scheme produces only a first - order accurate structure factor in general .    in order to set a desired magnitude of fluctuations without changing any other system parameters",
    ", we introduce a factor @xmath211 , which scales the cell volume @xmath212 .",
    "hence , @xmath211 can be interpreted as the surface cross section in one dimension and the thickness of a system in two dimensions , and as a rescaling of the number density in three dimensions .",
    "since the number of molecules in a cell is @xmath114 , the larger @xmath211 is , the more molecules in a cell there are and the weaker the fluctuations become .      in this section ,",
    "we test the numerical schemes constructed in sections  [ sec_spatial_discretization ] and [ sec_temporal_integrators ] on the schlgl reaction - diffusion model , first introduced in section  [ subsec_schlogl_bg ] .",
    "simulation parameters are chosen to correspond to a system in thermodynamic equilibrium , so that the equilibrium fluctuations are poisson and the structure factor @xmath213 is constant , both with and without ( i.e. , diffusion only ) chemical reactions . specifically , we set the rate constants as @xmath214 ( see eq .  ) , which gives @xmath215 and @xmath216 .",
    "we set the diffusion coefficient @xmath217 and the grid spacing to unity for @xmath218 , and thus @xmath219 .",
    "we consider the case where the mean number of molecules per cell is 10 by setting @xmath220 .",
    "@ @ plus 1fil minus @skip static fluctuations of the spatially discretized fhd equation   at thermodynamic equilibrium .",
    "( left ) structure factors @xmath184 calculated by using different averaging functions @xmath115 .",
    "the solid lines depict the results from the equilibrium schlgl model ( @xmath221 ) , whereas the dotted lines are from the corresponding diffusion - only system .",
    "note that the exact result for both systems is @xmath222 independent of @xmath182 , which corresponds to poisson equilibrium fluctuations .",
    "( right ) empirical histograms @xmath223 of the number of molecules per cell for the schlgl model ( red circles ) and the diffusion - only system ( blue crosses ) , computed using the arithmetic mean averaging function . for comparison , we show the correct poisson distribution @xmath224 and its gaussian approximation @xmath225 .",
    "the inset shows the errors @xmath226 with error bars corresponding to two standard deviations.,title=\"fig : \" ]    prior to evaluating the different temporal integration strategies , we first focus our attention on the continuous - time discrete - space fhd equation   to establish a baseline for comparison and to evaluate the effectiveness of the choice of averaging function  . to eliminate temporal integration errors we use the emtau scheme   with a very small time step size @xmath227 ; results from the other fhd schemes are similar for sufficiently small @xmath0 .",
    "the left panel of fig .",
    "[ fig_schlogl_sk_rho ] shows the structure factors @xmath177 computed for @xmath228 grid cells in one dimension for the arithmetic , geometric , and harmonic mean ( am , gm , hm ) averaging functions @xmath102 . the correct flat spectrum is accurately reproduced by the modified am averaging function  . on the other hand , the gm and hm averaging functions give smaller @xmath177 at diffusion - dominated scales @xmath229 .",
    "this can be also observed from the diffusion - only system for all wavenumbers , as theoretically explained in appendix  [ appendix_averaging_function ] .",
    "henceforth , we use the modified am averaging function  .    the right panel of fig .",
    "[ fig_schlogl_sk_rho ] shows that using the am averaging function , the correct poisson distribution for the number @xmath230 of molecules in a cell is accurately reproduced for both reaction - diffusion and diffusion - only systems at thermodynamic equilibrium . from the equilibrium number density distribution @xmath231",
    ", we construct a discrete distribution for integer number of molecules @xmath230 per cell , @xmath232 and compare it with a poisson distribution @xmath224 with mean @xmath233 , as well as a gaussian distribution @xmath225 having the same mean and variance as @xmath224 .",
    "the agreement of @xmath223 and @xmath224 is remarkable in the sense that fhd was originally proposed to account for only second moments of ( small ) gaussian fluctuations . since @xmath224 is significantly different from @xmath225 for @xmath234",
    ", we confirm that our spatially discretized fhd equation   describes ( large ) poisson fluctuations faithfully .      in order to investigate time integration errors of our numerical schemes , we compare the numerical equilibrium distribution for a given time step size @xmath0 with the target poisson distribution @xmath224 by using the following measures .",
    "first , we compute the kullback - leibler ( kl ) divergence ( distance ) , @xmath235 second , we compute the probability of negative number densities , @xmath236 third , we compute the correlation coefficient @xmath237 between neighboring cells , @xmath238}}}{{{\\mathrm{var}\\left[n\\right]}}}.\\ ] ] note that all three measures should be zero at thermodynamic equilibrium , as they would be for rdme .     @ @ plus 1fil minus @skip deviations from the correct equilibrium distribution @xmath224 as @xmath0 increases for the four midpoint schemes applied to the one - dimensional schlgl model at thermodynamic equilibrium .",
    "the left panel shows the kl divergence  , the middle panel shows the probability of negative density  , and the right panel shows the correlation coefficient   between neighboring cells .",
    "the red and green solid lines denote the immidtau and exmidtau schemes , respectively , whereas the blue and purple dotted lines denote the immidssa and exmidssa schemes , respectively .",
    "the arrows denote the stability limit @xmath193 of the explicit schemes , see eq .  .",
    "the error bars correspond to two standard deviations.,title=\"fig : \" ]    we considered the three options for the stochastic flux amplitude @xmath169 in eq .  .",
    "for @xmath237 , the three options give similar values within standard errors of estimation . for @xmath239 and @xmath240 , option",
    "gives the largest values ( i.e. , least accurate ) and option   the smallest ( not shown ) .",
    "based on this result , we will adopt and use it for all of the simulations .",
    "figure  [ fig_schlogl_time_intg_err ] shows how these measures deviate from zero as @xmath0 increases for @xmath241 cells in one dimension for the different schemes .",
    "as expected , for small values of @xmath0 , all schemes give similar values .",
    "@xmath239 converges to a small value , which is consistent with the good agreement between @xmath223 and @xmath224 seen in the right panel of fig .",
    "[ fig_schlogl_sk_rho ] .",
    "@xmath240 is observed to converge to zero as @xmath242 , which demonstrates the effectiveness of the approach described in section  [ subsec_treatments ] and agrees with the analysis in appendix  [ appendix_averaging_function ] .",
    "also , no correlation between neighboring cells is observed for small @xmath0 within statistical errors , which is consistent with the flat spectrum @xmath177 shown in the left panel of fig .",
    "[ fig_schlogl_sk_rho ] .",
    "as @xmath0 approaches the explicit stability limit @xmath193 , rapid worsening is observed in both explicit schemes in all three measures .",
    "while @xmath240 and @xmath237 behave similarly for both schemes , @xmath239 remains small for larger values of @xmath0 for the exmidssa scheme compared to the exmidtau scheme .",
    "for both implicit schemes , it can be clearly seen that not only is the diffusion instability bypassed but also the accuracy is well maintained for large @xmath0 . for comparable accuracy , an order of magnitude larger time step size than the explicit schemes can be chosen .",
    "the immidtau scheme gives smaller @xmath239 than the immidssa scheme if @xmath0 is smaller than a certain value .",
    "this is consistent with the observation that the former scheme has a higher temporal order of accuracy in @xmath177 .",
    "however , due to inaccurate handling of reactions by tau leaping for large @xmath0 , the immidtau scheme eventually gives larger @xmath239 .",
    "for @xmath240 and @xmath237 , similar behavior is observed .",
    "similar behavior is observed for higher spatial dimensions @xmath243 and @xmath244 ( not shown ) .",
    "however , for a given target accuracy tolerance , we find that a smaller time step size should be chosen , which is inversely proportional to the dimensionality @xmath2 .",
    "this should not come as a surprise since the explicit stability limit @xmath245 , see eq .  .",
    "therefore , we conclude that @xmath0 can be chosen an order of magnitude larger for the implicit schemes than for the explicit schemes _ independent _ of the spatial dimension .      in this section ,",
    "we investigate pattern formation in the three - species baras  pearson  mansour ( bpm ) model  @xcite , @xmath246 we choose the rate constants so that the deterministic reaction - only system attains a limit cycle as its stable attractor , and we choose the diffusion coefficients so that a turing - like pattern forms in the reaction - diffusion system  @xcite . specifically , we set @xmath247 , @xmath248 , @xmath249 , @xmath250 , @xmath251 , @xmath252 and @xmath253 , @xmath254 .",
    "we note that on the limit cycle , number densities of the three species oscillate in significantly different ranges : @xmath255 , @xmath256 , and @xmath257 . for a physical domain with side lengths @xmath258 , we use three spatial resolutions with grid sizes @xmath259 , @xmath260 , and @xmath261 cells . for the initial number densities ,",
    "we choose a point on the limit cycle @xmath262 and generate the initial number of molecules of each species @xmath16 in each cell from a poisson distribution with mean @xmath263 .",
    "we use our implicit schemes in order to bypass the stiff stability limit imposed by the fast diffusion of @xmath264 molecules . to obtain _ reference fhd results _ having minimal time integration errors",
    ", we use the immidtau scheme with @xmath265 . to test the importance of fluctuations , a deterministic version of the immidtau scheme",
    "is used with @xmath265 , with random initial conditions generated from a poisson distribution corresponding to thickness @xmath220 .     @ @ plus 1fil minus @skip two types of steady - state turing - like patterns observed in the two - dimensional bpm model with @xmath266 cells and @xmath267 .",
    "snapshots of @xmath268 are obtained at @xmath269 from fhd ( left two panels ) and rdme ( right two panels ) simulations with a small time step size .",
    "panels  ( a ) and ( c ) show a hexagonal structure ( with 12 dots ) , whereas panels  ( b ) and ( d ) exhibit a monoclinic structure ( with 11 dots).,title=\"fig : \" ]    figure  [ fig_bpm_final ] shows snapshots of a final turing pattern formed for @xmath267 and @xmath266 cells .",
    "while the pattern is qualitatively correct , the quantitative behavior of our fhd formulation may be questioned since the mean number of @xmath270 molecules in a cell can be as low as @xmath271 at small @xmath272 in this case . to confirm the fhd description applies even for relatively small numbers of molecules per cell , we compare the fhd results to reference rdme results obtained using the ssa/2+mn+ssa/2 scheme   with @xmath273 .",
    "we find that the fhd reference simulations are qualitatively very similar to the rdme reference simulations over a wide range of thicknesses @xmath211 , as we illustrate in fig .",
    "[ fig_bpm_final ] . for our setup , after the initial formation of a disordered pattern of dots with low concentration of @xmath264 molecules ( blue dots in fig  [ fig_bpm_final ] ) , the dots split and merge and diffuse to eventually form a stable regular pattern ; note that the final patterns are nearly periodic lattice structures but their geometry is affected to some extent by the finite size of the domain . for @xmath267 , by @xmath269 , almost all samples had formed a steady pattern .",
    "most samples formed a hexagonal ( 12 dots , see panels  ( a ) and ( c ) in fig  [ fig_bpm_final ] ) , and a few formed a monoclinic ( 11 dots , see panels  ( b ) and ( d ) in fig .  [ fig_bpm_final ] ) lattice of dots , for both fhd and rdme .",
    "note that while fhd simulations using the immidtau scheme are equally efficient independent of @xmath211 , rdme simulations become prohibitively expensive for large @xmath274 due to the very large number of @xmath264 molecules ( as many as @xmath275 ) in the system . for weaker fluctuations , @xmath276",
    ", fhd simulations reveal that the annealing of the lattice defects takes much longer and we see several disordered or defective patterns even at @xmath269 ( not shown ) .",
    "therefore , not only do fluctuations accelerate the formation of the initial ( disordered ) pattern , but they also appear to accelerate the annealing of the defects .     @ @ plus 1fil minus @skip turing - like pattern formation in the two - dimensional bpm model with @xmath266 cells .",
    "( left )  spatially - averaged density @xmath277 of species @xmath264 for domain thickness @xmath267 and @xmath220 ( rdme results ) , as well as deterministic reaction - diffusion started from random initial conditions corresponding to @xmath220 .",
    "( right )  snapshots of @xmath268 for @xmath220 at four different times @xmath272 at which @xmath277 attains a local minimum , indicated by circles in the left panel.,title=\"fig : \" ]    since the formation of the pattern is driven by an instability , it is itself a random process and a proper quantitative comparison between the different methods requires a careful statistical analysis of an ensemble of trajectories . in order to capture the time transient behavior of pattern formation , illustrated in the right panel of fig .  [ fig_bpm_turing ] , we calculate the spatially - averaged density @xmath278 . in the left panel ,",
    "we compare sample trajectories of @xmath277 for @xmath267 and @xmath220 for rdme ( similar results are obtained for fhd ) and for deterministic reaction - diffusion .",
    "while @xmath277 initially oscillates as in the limit cycle , as the turing - like pattern begins to form , the oscillation amplitude decays and @xmath277 eventually attains a steady value . by comparing @xmath267 and 10 , we see that larger fluctuations facilitate faster pattern formation , as observed in prior work  @xcite by us and others . by comparing rdme results for thickness @xmath220 with",
    "deterministic reaction - diffusion started from the same initial condition , we see that the effect of fluctuations on pattern formation is _ not _ just due to random initial conditions .",
    "@ @ plus 1fil minus @skip ( left )  scatter plots of the decay onset time @xmath279 and the steady spatial average density @xmath280 for several values of the cell thickness @xmath211 and two grid resolutions . rdme and fhd results",
    "are compared for @xmath267 and @xmath220 , whereas only the fhd results ( using the immidtau scheme ) are shown for @xmath281 and @xmath276 since rdme simulations are prohibitively expensive .",
    "( right )  average values @xmath282 of @xmath280 over 16 samples for the immidtau and immidssa schemes with @xmath266 cells as a function of time step size @xmath0 , for cell thicknesses @xmath211 of 0.1 , 1 , and 10 . for comparison ,",
    "the rdme results for @xmath273 are shown on the left with error bars corresponding to two standard deviations .",
    "error bars are omitted for the implicit schemes ; they are comparable to the rdme results .",
    "note that @xmath283 are normalized by the average values @xmath284 for deterministic reaction - diffusion started with random initial conditions corresponding to @xmath220.,title=\"fig : \" ]    we generate 16 sample trajectories for each set of parameter values , fit each realization of @xmath277 using seven fitting parameters @xmath285 to @xmath286 and compare the distributions of the fitting parameters .",
    "note that @xmath279 and @xmath280 correspond to the decay onset time and the steady spatial average density , respectively . in the left panel of fig .",
    "[ fig_bpm_comp ] , we compare the empirical distributions of @xmath287 from the rdme and fhd results for different values of the thickness @xmath211 and spatial resolutions . for each value of @xmath211 , we observe that distributions obtained from different methods and/or resolutions coincide . for @xmath267 and @xmath220 , we reconfirm that the rdme approach produces statistically very similar results for three resolutions and the fhd results are statistically indistinguishable from the rdme results .",
    "it is quite remarkable that fhd works even for @xmath267 and @xmath261 cells , which can have as low as 0.3 molecules per cell at small @xmath272 , and this demonstrates the robustness of our treatment for a small number of molecules per cell . as the magnitude of the fluctuations increases ( i.e. , as @xmath211 decreases ) , the pattern begins to form earlier ( i.e. , @xmath279 decreases ) , as already seen in fig .",
    "[ fig_bpm_turing ] , while the steady spatial average density @xmath280 becomes smaller .",
    "in addition , while the variance of @xmath279 does not change significantly as @xmath211 varies , the variance of @xmath280 becomes larger for smaller @xmath211 .",
    "finally , we investigate time integration errors of our implicit schemes for the turing - like pattern formation . for the immidtau scheme , we increase @xmath0 up to the stability limit arising from reactions @xmath288",
    ". the right panel of fig .",
    "[ fig_bpm_comp ] shows the mean values @xmath282 of the steady spatial average density @xmath280 over 16 samples versus @xmath0 for @xmath266 cells .",
    "while both schemes give similar values to the rdme results for small @xmath0 , they show different behavior for large @xmath0 , which also depends on @xmath211 .",
    "as expected , in the immidtau scheme , the value of @xmath282 rapidly deviates from the rdme result as @xmath0 approaches @xmath289 , especially if there are few molecules per cell , @xmath290 or @xmath267 . on the other hand , in the immidssa scheme",
    ", @xmath0 can be increased beyond @xmath289 , and deviations from the rdme results remain small even for the smallest value of @xmath211 .",
    "hence , handling reactions by ssa not only removes the reaction stability constraint but also improves the accuracy for a small number of molecules per cell .",
    "however , it should be noted that this improvement comes at a significant computational cost , since the ssa scheme is much more expensive than tau leaping especially as the number of molecules per cell increases .",
    "therefore , the ssa - based schemes are impractical in the regime of weak fluctuations due to poor scaling .",
    "we discuss some alternatives to ssa that may significantly improve the computational cost for weaker fluctuations in the conclusions .",
    "@ @ plus 1fil minus @skipthree - dimensional fhd simulation of front propagation in a two - species stochastic reaction - diffusion model   using the immidtau scheme .",
    "the number density of species @xmath291 is shown at four different times @xmath272 for the stochastic reaction - diffusion system ( in the top row ) and the corresponding deterministic case ( in the bottom row ) .",
    "the same initial conditions with poisson fluctuations are used in both simulations.,title=\"fig : \" ]    as a final example , we simulate three - dimensional front propagation in a two - species stochastic reaction - diffusion system having the following reaction network : @xmath292 this model has been proposed to reproduce axial segmentation in ref .",
    "@xcite , where issa simulations have been performed for the one - dimensional case .",
    "following ref .",
    "@xcite , we set @xmath293 , @xmath294 , @xmath295 , @xmath296 and @xmath297 , @xmath298 . for a physical domain with side lengths @xmath299",
    ", we use @xmath300 cells . to initiate front propagation ,",
    "we generate initial number densities as follows .",
    "we first assign to each cell @xmath301 and species @xmath16 a mean number density @xmath302 where @xmath303 is the distance from the cell center to the center of the domain .",
    "this initializes a spherical region of radius @xmath304 in the first uniform equilibrium state of the model , @xmath305 , while the rest of the domain is initialized in the second uniform equilibrium state , @xmath306 , with a smooth transition region between the two states of width @xmath307 . then , as in section  [ subsec_bpm ] , we generate the initial number of molecules of each species in each cell from a poisson distribution with mean @xmath308 .",
    "we simulate the system for parameters @xmath276 , @xmath309 , and @xmath310 using the immidtau scheme with @xmath311 . for comparison",
    ", we also simulate the corresponding deterministic system using a deterministic version of the immidtau scheme with the same time step size and ( random ) initial conditions .",
    "simulations are performed using a parallel implementation of the algorithm using the boxlib software framework  @xcite .",
    "we emphasize that a corresponding rdme system is too large to simulate with conventional rdme - based methods ; while the total number of molecules in the system varies as the front propagates , it is of the order of @xmath312 for @xmath276 .",
    "figure  [ fig_ab_bubble_3d ] shows the growth of the spherical region as the more stable phase propagates into the less stable phase via a spherical traveling wave .",
    "while the phase boundary having a peak population of species @xmath291 propagates , a turing - like pattern develops behind the wave front ; in one dimension this pattern is periodic and more pronounced in the presence of fluctuations  @xcite . in two and three dimensions , fluctuations not only enhance the pattern but they also make it disordered , as seen in the figure by comparing the stochastic and deterministic cases . in addition , the phase boundary becomes more irregular under fluctuations .",
    "note that the numerical results for the deterministic case are not perfectly radially symmetric not only due to the noisy initial conditions but also due to grid artifacts introduced by the standard discrete laplacian , which is not perfectly isotropic  @xcite on length scales compared to the front width ( i.e. , the penetration depth ) ; one would require an even finer grid to correct for this spatial discretization artifact .",
    "in this work , we have formulated a fluctuating hydrodynamics ( fhd ) model for reaction - diffusion systems and developed numerical schemes to solve the resulting stochastic ordinary differential equations ( sodes )   for the number densities @xmath79 of chemical species in each cell .",
    "we obtained the diffusion part of the sodes from an fhd description of a microscopic system consisting of molecules undergoing independent brownian motions , and added reactions in an equivalent manner to the reaction - diffusion master equation ( rdme ) .",
    "we presented two implicit predictor - corrector schemes , the immidtau   and immidssa   schemes , that treat reactions using tau leaping and ssa , respectively . in these schemes ,",
    "diffusion is treated implicitly so that the stability limit imposed by fast diffusion can be bypassed and the time step size can be chosen to be significantly larger than the hopping time scale of diffusing molecules .",
    "in addition , two - stage runge  kutta temporal integrators are employed to improve the accuracy . to confirm the validity of our fhd formulation and demonstrate the performance of our numerical schemes , we numerically investigated not only a system at steady state ( schlgl reaction - diffusion model ) , but also time - dependent two - dimensional turing - like pattern formation and three - dimensional front propagation .    based on our analytical and numerical investigation , we conclude that the immidtau scheme is an efficient and robust alternative numerical method for reaction - diffusion simulations .",
    "the reason is threefold .",
    "first , the cost of the scheme does not increase for increasing number of molecules per cell ( weaker fluctuations ) .",
    "for small numbers of molecules per cell ( large fluctuations ) , the integer - valued rdme description is more appropriate than the continuous - range fhd description .",
    "however , by using the approach proposed in section  [ subsec_treatments ] , we ensured that the fhd description remains robust and gives accurate results even for a small number of molecules per cell , as shown in section  [ subsec_schlogl_res ] .",
    "hence , as shown in section  [ subsec_bpm ] , our numerical methods can efficiently simulate reaction - diffusion systems over a broad range of relative magnitude of the fluctuations .",
    "second , the scheme allows a significantly larger time step size without degrading accuracy compared to existing rdme - based numerical methods  @xcite , which use a fixed time step size for diffusion that is comparable to the hopping time scale .",
    "in particular , we found that the time step size could be chosen an order of magnitude larger for the implicit schemes than for explicit methods , independent of the spatial dimension .",
    "lastly , fhd can take advantage of development of efficient parallel algorithms developed for computational fluid dynamics ( cfd ) that enable effective use of high - performance parallel architectures while providing the framework for treating more complex problems with additional physical phenomena .",
    "this enabled us to perform three - dimensional simulations of chemical front propagation involving as many as @xmath312 molecules using the boxlib cfd software framework  @xcite .",
    "the explicit tau leaping methods used here are quite simple to implement but are subject to a stability limit for fast reactions , and can lead to negative densities when fluctuations are large . while some implicit tau leaping methods have been developed , as an alternative we developed methods that use ssa for reactions .",
    "the exmidssa and immidssa methods , however , do not scale as the fluctuations become weaker . this deficiency can be corrected by replacing ssa by a recently - developed hybrid algorithm termed asynchronous tau leaping  @xcite that combines ssa and tau leaping in a dynamic manner by simulating multiple events with asynchronous time steps . a nontrivial question that requires",
    "further study is how to control the accuracy of such methods .",
    "in fact , the standard notion of temporal order of accuracy does not apply to asynchronous algorithms since there is no notion of a fixed time step size .",
    "future work should develop fhd - based numerical schemes that are accurate and robust even for a small number of molecules per cell and also scale to the deterministic limit efficiently .",
    "one of the advantages of the fhd approach for reaction - diffusion systems is its natural generalization to more complicated and realistic applications .",
    "chemical reactions of interest usually occur in liquid solution , and often in a dense crowded environment such as the cytoplasm  @xcite .",
    "it is well - known that brownian motion of liquid molecules or suspended macromolecules in liquids is dominated by hydrodynamic effects related to viscous dissipation  @xcite .",
    "this means that the diffusion model commonly used in reaction - diffusion models , including this work , which assumes that reactants are independent non - interacting brownian walkers diffusing with a constant diffusion coefficient , does not apply in the majority of practical problems of interest .",
    "notably , crowding or steric interactions affect the local hydrodynamic mobility of individual reactants , and hydrodynamic interactions ( hi ) among the diffusing reactants introduce strong correlations among the diffusive motions of the reacting particles ( and also among reactants and passive crowding agents )  @xcite .",
    "excluded volume due to steric repulsion introduces cross - diffusion effects , i.e. , coupling between the diffusive fluxes for different species  @xcite , as well as concentration - dependent diffusion coefficients .",
    "furthermore , it has been observed that cross - diffusion may lead to qualitatively different turing instabilities  @xcite .",
    "long - ranged contributions of hydrodynamic interactions can be captured by accounting for the advection of concentration fluctuations by the thermal velocity fluctuations , which follow a fluctuating stokes equation  @xcite .",
    "additional thermodynamic contributions to the diffusive fluxes such as cross - diffusion , barodiffusion and thermodiffusion do not seem straightforward in the rdme but are easily included in our fhd formulation  @xcite . in future work",
    ", we will investigate these hydrodynamic effects on stochastic reaction - diffusion phenomena .",
    "we would like to thank jonathan goodman for numerous informative discussions .",
    "this work was supported by the u.s .",
    "department of energy , office of science , office of advanced scientific computing research , applied mathematics program under contract de - ac02 - 05ch11231 and award number de - sc0008271 .",
    "this research used resources of the national energy research scientific computing center , a doe office of science user facility supported by the office of science of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "as a reference algorithm for stochastic reaction - diffusion simulation , we construct a numerical scheme for the rdme through a standard operator splitting technique , as done in a number of prior works  @xcite .",
    "this technique allows one to obtain a numerical scheme for the reaction - diffusion system by combining numerical methods for the diffusion - only and reaction - only systems .",
    "here we combine multinomial diffusion sampling  @xcite for diffusion and ssa for reaction via strang splitting  @xcite .",
    "one distinguishing feature of the resulting scheme , compared to exact sampling methods such as issa , is the use of a fixed time step size @xmath0 for diffusion , which facilitates an efficient numerical simulation if diffusion is fast . as shown below ,",
    "while there are several advantages of this scheme over issa , the choice of @xmath0 is constrained as it is for explicit fhd schemes .    in section  [ subsec_rdme_based_schemes ] , after reviewing the multinomial diffusion sampling method , we present an rdme - based split scheme and discuss its advantages and disadvantages . in section  [ subsec_struct_factor_analysis_rdme ] , we present a stochastic accuracy analysis for this scheme .      in the multinomial diffusion ( mn ) sampling method ,",
    "the numbers of molecules in each cell after time @xmath0 are calculated by sampling how many molecules have moved from a cell to a neighboring cell . here",
    "we follow the simple algorithm described by balter and tartakovsky  @xcite and only allow particles to move to nearest - neighbor cells .",
    "more complicated but also more accurate algorithms that allow particles to jump to further than nearest - neighbor cells are described by lampoudi et al .",
    "we use the notation introduced in the body of the paper .    by denoting the number of molecules of species",
    "@xmath16 diffusing from cell @xmath86 to cell @xmath313 over the time interval @xmath0 as @xmath314 , the change in the number density @xmath315 can be expressed in terms of the sum of the inward and outward fluxes ,    [ mn ] @xmath316    where @xmath317 .",
    "for each cell @xmath86 , the outward fluxes @xmath318 @xmath319 are random variables sampled from the multinomial distribution with @xmath320 total trials and probabilities @xmath321 where @xmath322 , where we have assumed @xmath142 .    for fast diffusion ,",
    "this method becomes more efficient than treating hoping events one by one ( as in issa ) .",
    "however , it is an approximate method since the actual distribution of the outward fluxes deviates from the multinomial distribution as @xmath0 increases .",
    "in fact , @xmath0 can not be arbitrarily large and is limited by condition   because of the requirement @xmath323 .",
    "we also note that the number of molecules in a cell never becomes negative due to the constraint @xmath320 .",
    "hence , the fluxes on disjoint faces are correlated , which is different from the fhd description  . in the deterministic limit",
    "this scheme converges to a standard forward euler scheme for the diffusion equation , and is therefore only first - order accurate in time . in the stochastic",
    "setting , this scheme adds correlations between the fluxes through different faces of a given cell in such a way as to ensure discrete fluctuation - dissipation balance for _ any _ allowable time step size .",
    "in fact , for a system with diffusion only , this method ensures that the equilibrium fluctuations are strictly poisson , as desired for independent brownian walkers .    in order to handle chemical reactions ,",
    "we use the ssa algorithm locally and independently in each cell , without any diffusive events . let @xmath155 denote the ( random ) change in the number density of species @xmath16 when a cell with initial state @xmath135 is simulated using ssa over a time interval @xmath156 . in the absence of diffusion , the ssa - based reaction scheme can be written as @xmath324    if we combine the diffusion - only   and reaction - only   schemes using a strang splitting approach  @xcite , we obtain the ssa/2+mn+ssa/2 scheme    [ ssa2mnssa2 ] @xmath325    where superscripts denote time step or intermediate stage .",
    "( we note that a number of different splitting variants are possible ; the version presented here gave the most accurate structure factor . )",
    "this split scheme has a number of advantages .",
    "it becomes an exact sampler ( solver ) for the rdme in the limit @xmath326 , just like issa .",
    "it is notably more efficient than issa if there are many events per time interval @xmath0 , and it can be parallelized in a straightforward manner using domain decomposition . since the number of molecules is always a nonnegative integer both in multinomial diffusion sampling and in ssa , this property",
    "is also preserved for this scheme .",
    "moreover , since both sampling methods preserve the thermodynamic equilibrium distribution ( i.e. , the poisson statistics ) , the split scheme also preserves it for any allowable time step size .    however , this scheme has some disadvantages .",
    "first , the time step size restriction   for diffusion becomes severe for fast diffusion .",
    "second , ssa exhibits poor scalability with respect to the number of molecules in a cell",
    ". this can be resolved by replacing ssa with the tau leaping method , but the nonnegativity is no longer guaranteed .",
    "third , since the multinomial diffusion method used here is only first - order accurate , the accuracy of the scheme is first order even though strang splitting is used .",
    "constructing rdme - based diffusion methods that are more accurate is possible  @xcite but nontrivial and is not the focus of our work .",
    "structure factors @xmath184 obtained from the ssa/2+mn+ssa/2 scheme   for the one - dimensional linearized fhd equation   with @xmath185 ( e.g. , an out - of - equilibrium monostable schlgl model ) .",
    "different values of @xmath141 are compared , with @xmath188 , see eq .  .",
    "the exact result   is depicted by the dotted line .",
    "note that the modified wavenumber @xmath182 is used , see eq .  .",
    "]    in this section , we investigate the stochastic accuracy of the ssa/2+mn+ssa/2 scheme  . to this end",
    ", we consider the structure factor @xmath177 of an out - of - equilibrium monostable schlgl model in one dimension ( see sections  [ subsec_struct_factor ] and [ subsec_schlogl_bg ] ) . in the limit of many molecules per cell , an asymptotic expression of @xmath177 can be obtained for the scheme as a function of @xmath3 and @xmath0 .",
    "the multinomial fluxes can be approximated by correlated gaussian ones and the type of analysis summarized in appendix  [ appendix_linearized_eqn_analysis ] can be applied ; we do not give the details here for brevity .",
    "note that we present a similar structure factor analysis for our fhd - based schemes with some background and details in section  [ subsec_struct_factor_analysis ] .",
    "figure  [ fig_sk_analysis_rdme ] illustrates how @xmath177 deviates from the exact result   as @xmath0 is increased to @xmath193 ( equivalently , to @xmath327 ) , for @xmath188 , see eq .  .",
    "while @xmath177 is accurately reproduced at the reaction - dominated scales @xmath56 for all values of @xmath141 , it becomes inaccurate for smaller scales as @xmath0 approaches @xmath193 .",
    "we recall that for a system at thermodynamic equilibrium , the split scheme _",
    "exactly _ preserves the correct equilibrium distribution for any @xmath328 .",
    "this property ensures that , for @xmath145 , good structure factors are obtained even for systems outside of thermodynamic equilibrium , which exhibit a nonzero correlation length .",
    "for example , for @xmath186 , the ssa/2+mn+ssa/2 scheme in fig .",
    "[ fig_sk_analysis_rdme ] gives a notably more accurate @xmath177 than the fhd - based _ explicit _ schemes in fig .",
    "[ fig_sk_analysis_fhd ] . hence ,",
    "even though this split scheme is found to give only first - order accurate @xmath177 , the resulting structure factor is relatively insusceptible to increasing @xmath0 until the stability limit is approached .",
    "in this appendix we show that the arithmetic mean should be chosen as the averaging function @xmath102 . here",
    "we consider the diffusion - only case for a single species and investigate the equilibrium distribution of the spatially discretized fhd equation  . since the @xmath329 equilibrium distribution for a bulk ( infinite ) system",
    "is known to be a product poisson distribution from the corresponding microscopic system consisting of molecules undergoing independent brownian motions , we choose @xmath115 so that the resulting equilibrium distribution is as close as possible to the true distribution .",
    "in addition , since the prevention of negative cell number densities is one of the essential issues for the development of a robust fhd numerical scheme , special care is taken to modify the form of @xmath102 for small values of @xmath330 and @xmath331 . here",
    "we focus on the continuous - time case and do not assume any specific temporal integrator .",
    "the corresponding microscopic system has @xmath332 molecules , where @xmath61 is the mean number density and @xmath333 is the number of cells . the equilibrium distribution of the numbers of molecules in each cell follows the multinomial distribution with equal probabilities @xmath334 .",
    "hence , it is straightforward to obtain the following second - order statistics of cell number density @xmath335 : @xmath336}}=\\frac{n_\\mathrm{c}-1}{n_\\mathrm{c}}\\frac{\\bar{n}}{\\d{v}},\\\\ \\label{micro_sys_res_cov } & { { \\mathrm{cov}\\left[n_{\\v{{i}}_1},n_{\\v{{i}}_2}\\right]}}=-\\frac{1}{n_\\mathrm{c}}\\frac{\\bar{n}}{\\d{v}}\\quad\\mbox{for $ \\v{{i}}_1\\ne\\v{{i}}_2$}.\\end{aligned}\\ ] ] equivalently , from eqs .   and , the structure factor is also obtained as @xmath337    if the fhd system   attains an equilibrium state , it can be shown that its second - order statistics are completely characterized by @xmath338 , which is the equilibrium average of @xmath115 over all faces : @xmath339}}=\\frac{n_\\mathrm{c}-1}{n_\\mathrm{c}}\\frac{\\av{\\tilde{n}}}{\\d{v}},\\\\ \\label{analytic_res_cov } & { { \\mathrm{cov}\\left[n_{\\v{{i}}_1},n_{\\v{{i}}_2}\\right]}}=-\\frac{1}{n_\\mathrm{c}}\\frac{\\av{\\tilde{n}}}{\\d{v}}\\quad\\mbox{for $ \\v{{i}}_1\\ne\\v{{i}}_2$},\\\\ \\label{analytic_res_sk } & s(\\v{k})=\\av{\\tilde{n}}\\quad\\mbox{for nonzero $ \\v{k}$}.\\end{aligned}\\ ] ]    comparing eqs .   to the correct result eqs .",
    " suggests that one needs to choose @xmath115 so that @xmath338 is as close as possible to @xmath61 .",
    "it is easy to see that the arithmetic mean ( am ) _ would _ give the right answer : @xmath340 .",
    "on the other hand , to calculate @xmath338 for the geometric mean @xmath341 or the harmonic mean @xmath342 , one needs to know the equilibrium distribution @xmath343 of two neighboring cells .",
    "however , under the reasonable assumption that all three averaging functions give similar distributions @xmath343 allowing only nonnegative number densities , it can be easily shown that @xmath344 from the well - known inequalities among the pythagorean means .",
    "in fact , in fig .  [ fig_schlogl_sk_rho ] , this ordering is observed from the structure factor of the diffusion - only system , see eq .  .",
    "hence , we conclude that the arithmetic mean is the right choice for @xmath115 .",
    "the equilibrium cell number density distributions @xmath231 near @xmath125 obtained from the arithmetic mean averaging function   ( depicted by the red solid line ) , which uses the discontinuous heaviside function @xmath345 , and eq .",
    "( depicted by the blue dotted line ) , which uses the smoothed heaviside functions @xmath119 .",
    "the results are obtained from the one - dimensional diffusion - only fhd system   having @xmath346 , @xmath347 , and @xmath228 by using the emtau scheme   with @xmath227 . ]    however , if the arithmetic mean is employed without modification , eq .   does not attain an equilibrium state .",
    "this is because almost surely at some point on some grid face we will have @xmath348 so that the stochastic diffusive flux becomes undefined .",
    "the nonnegativity of cell number densities is guaranteed if the stochastic diffusive flux through a face is turned off when the number density of either cell sharing the face becomes zero .",
    "specifically , under some technical assumptions , it can be proven that if @xmath102 is a nonnegative function that satisfies @xmath349 then the number density of each cell never becomes negative .",
    "the nonnegative arithmetic mean averaging function @xmath350 does not allow negative density ( i.e. , @xmath351 for @xmath352 ) .",
    "however , due to the discontinuity of @xmath115 at @xmath120 or @xmath121 , @xmath231 does not decrease to zero as @xmath353 becomes zero ( i.e. , @xmath354 ) and a delta function is formed at @xmath125 , see fig .",
    "[ fig_hist_near_zero ] .    to understand this behavior ,",
    "we consider numerically integrating eq .   with a small time step size @xmath355 .",
    "even if the density in a given cell @xmath356 has a small positive value , @xmath115 can be large if the density in the neighboring cell @xmath357 is large . in this case",
    ", @xmath358 can become negative due to the stochastic diffusive flux .",
    "but , once @xmath330 has become negative , the stochastic diffusive flux is turned off , and due to the deterministic diffusion , @xmath330 increases and becomes positive again .",
    "hence , as shown in fig .",
    "[ fig_hist_near_zero ] , @xmath231 attains a peak in the negative density region near @xmath125 .",
    "the width and height of the peak are proportional to @xmath359 and @xmath360 , respectively , and the peak becomes a delta function in the limit @xmath210 .",
    "we note that the averaging in eq .   can be expressed as @xmath361 where @xmath345 is the heaviside function . to avoid a discontinuity in @xmath115 we can use a smoothed heaviside function to arrive at eq .  .",
    "note that the smoothing is based on the number of molecules in a cell ( @xmath362 ) and the smoothing region @xmath363 is chosen so that the stochastic diffusive flux is modified only when there is less than one molecule in a cell . in fig .",
    "[ fig_hist_near_zero ] , we show the distribution @xmath231 near @xmath125 obtained by the averaging function  , for a rather small mean number of molecules per cell , @xmath364 . with the use of a smoothed heaviside function , the spurious delta function at @xmath125 as @xmath210 is removed , and the probability of negative density is greatly reduced for small @xmath0 .",
    "in this appendix we summarize how the discrete structure factor is obtained as a function of @xmath3 and @xmath0 when a given spatiotemporal discretization is applied to the linearized fhd equation  , following the fourier - space analysis developed in ref .  @xcite . for simplicity , we consider here the one - dimensional case .    applying the spatial discretization given in section  [ sec_spatial_discretization ] to eq .   and",
    "taking a discrete fourier transform , we obtain an ornstein  uhlenbeck equation for the fourier coefficient @xmath365 , @xmath366 where the modified wavenumber @xmath182 is defined in eq .  , and @xmath367 and @xmath368 are independent standard gwn processes .",
    "compared to the continuous - space case ( see eq .  ) , @xmath153 is replaced by @xmath182 due to the discrete laplacian and divergence operators .",
    "note that in this linearized analysis poisson processes have been replaced by gaussian ones with the mean evaluated at the ensemble average ( i.e. , macroscopic ) values of the density . for convenience",
    ", we have replaced complex - valued gwn noise processes by real - valued ones having the same noise intensities .    when the emtau scheme   is used to solve eq .",
    ", we have the recursion @xmath369\\d{\\hat{n}_k}(t)+\\sqrt{\\frac{2d\\bar{n}\\tilde{k}^2\\d{t}}{v}}w_1+\\sqrt{\\frac{2\\bar{\\gamma}\\d{t}}{v}}w_2,\\ ] ] where @xmath370 and @xmath371 are independent standard normal random variables .",
    "we write this as @xmath372 where @xmath373 denotes being equal in distribution . for",
    "any given temporal integrator we can straightforwardly obtain analytic expressions for @xmath374 and @xmath375 .",
    "for example , for the emtau scheme ,      the covariance of the noise @xmath375 for multinomial diffusion   can most easily be obtained from eq .   from the observation that , in the absence of reactions , the exact structure factor @xmath377 is obtained for any stable time step .",
    "a similar procedure is applicable to numerical schemes having ssa for reactions . since ssa is an exact integrator , the linearized reaction part in eq .",
    "is exactly solved .",
    "for example , for the em - ssa scheme  , we have ( cf .  eq .  )",
    "@xmath378\\d{\\hat{n}_k}(t)+\\sqrt{\\frac{2d\\bar{n}\\tilde{k}^2\\d{t}}{v}}w_1+\\sqrt{\\frac{\\bar{\\gamma}(1-e^{-2r\\d{t}})}{r v}}w_2.\\ ] ] while the expressions of @xmath374 and @xmath375 become complicated for the predictor - corrector midpoint schemes , a theoretical analysis is still tractable with the help of symbolic algebra tools .    by calculating @xmath374 and @xmath375 for a given numerical scheme",
    ", the stability condition and the structure factor can be obtained as follows . from the condition that the amplification factor @xmath374 should satisfy @xmath379",
    "the stability condition is obtained . for the emtau scheme ,",
    "we obtain @xmath380 the analytic expression for @xmath381 can be calculated from @xmath382 which is obtained from the time invariance relation @xmath383 and eq .",
    "@xcite . from the analytical expressions of @xmath177 and @xmath204 , @xmath384/s_0(k_\\mathrm{max})$ ]",
    "is easily obtained , the series expansion of which for small @xmath140 ( and fixed @xmath141 ) gives eq .",
    "for the immidtau scheme . similarly , series expansions for small @xmath0 ( i.e. , fixed ratio @xmath385 ) reveals the temporal order of accuracy of @xmath177 .",
    "k.  burrage , p.m. burrage , a.  leier , t.  marquez - lago , and d.v .",
    "nicolau , jr .",
    "stochastic simulation for spatial modelling of dynamic processes in a living cell . in h.",
    "koeppl , g.  setti , m.  di  bernardo , and d.  densmore , editors , _ design and analysis of biomolecular circuits _ , pages 4362 .",
    "springer , new york , 2011 .                                                      j.v",
    ". rodr ' iguez , j.a .",
    "kaandorp , m.  dobrzy ' nski , and j.g .",
    "spatial stochastic modelling of the phosphoenolpyruvate - dependent phosphotransferase ( pts ) pathway in _",
    "e__scherichia coli_. , 22:18951901 , 2006 .",
    "rendleman , v.e .",
    "beckner , m.  lijewski , w.  crutchfield , and j.b .",
    "parallelization of structured , hierarchical adaptive mesh refinement algorithms .",
    ", 3:147157 , 2000 .",
    "software available at https://ccse.lbl.gov/boxlib ."
  ],
  "abstract_text": [
    "<S> we develop numerical methods for reaction - diffusion systems based on the equations of fluctuating hydrodynamics ( fhd ) . </S>",
    "<S> while the fhd formulation is formally described by stochastic partial differential equations ( spdes ) , it becomes similar to the reaction - diffusion master equation ( rdme ) description when those spdes are spatially discretized and reactions are modeled as a source term having poisson fluctuations . </S>",
    "<S> however , unlike the rdme , the fhd description naturally extends from the regime where fluctuations are strong , i.e. , each hydrodynamic cell has few ( reactive ) molecules , to regimes with moderate or weak fluctuations , and ultimately to the deterministic limit . by treating diffusion implicitly , we avoid the severe restriction on time step size that limits all methods based on explicit treatments of diffusion , and construct numerical methods that are more efficient than rdme methods , without compromising accuracy . </S>",
    "<S> guided by an analysis of the accuracy of the distribution of steady - state fluctuations for the linearized reaction - diffusion model , we construct several two - stage ( predictor - corrector ) schemes , where diffusion is treated using a stochastic crank  nicolson method , and reactions are handled by the stochastic simulation algorithm of gillespie or a weakly second - order tau leaping method . </S>",
    "<S> we find that an implicit midpoint tau leaping scheme attains second - order weak accuracy for the linearized fhd , and gives an accurate and stable structure factor for a time step size an order of magnitude larger than the hopping time scale of diffusing molecules . </S>",
    "<S> we study the numerical accuracy of our methods for the schlgl reaction - diffusion model both in and out of thermodynamic equilibrium . </S>",
    "<S> we demonstrate and quantify the importance of thermodynamic fluctuations to the formation of a two - dimensional turing - like pattern , and examine the effect of fluctuations on three - dimensional chemical front propagation . by comparing fhd simulations to deterministic reaction - diffusion simulations , </S>",
    "<S> we show that fluctuations accelerate pattern formation in spatially homogeneous systems , and lead to a qualitatively - different disordered pattern behind a traveling wave . </S>"
  ]
}